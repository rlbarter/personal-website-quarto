<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rebecca Barter">
<meta name="dcterms.date" content="2017-02-20">
<meta name="description" content="A bunch of statisticians met to learn about ANOVA, a method that they’re supposed to already know about. Here is my summary.">

<title>Rebecca Barter - ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-90929425-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta name="twitter:title" content="Rebecca Barter - ANOVA">
<meta name="twitter:description" content="A bunch of statisticians met to learn about ANOVA, a method that they’re supposed to already know about. Here is my summary.">
<meta name="twitter:card" content="summary">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Rebecca Barter</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html"> 
<span class="menu-text">Blog archive</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../consulting.html"> 
<span class="menu-text">Workshops and consulting</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.vdsbook.com"> 
<span class="menu-text">Veridical Data Science</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About Rebecca</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rlbarter"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rlbarter"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ANOVA</h1>
                  <div>
        <div class="description">
          A bunch of statisticians met to learn about ANOVA, a method that they’re supposed to already know about. Here is my summary.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">statistics</div>
                <div class="quarto-category">anova</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Rebecca Barter </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 20, 2017</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#when-anova-is-used-and-who-uses-it" id="toc-when-anova-is-used-and-who-uses-it" class="nav-link active" data-scroll-target="#when-anova-is-used-and-who-uses-it">When ANOVA is used and who uses it?</a></li>
  <li><a href="#anova-in-a-nutshell" id="toc-anova-in-a-nutshell" class="nav-link" data-scroll-target="#anova-in-a-nutshell">ANOVA in a nutshell</a>
  <ul class="collapse">
  <li><a href="#a-simple-toy-example-hospital-waiting-times" id="toc-a-simple-toy-example-hospital-waiting-times" class="nav-link" data-scroll-target="#a-simple-toy-example-hospital-waiting-times">A simple toy example: hospital waiting times</a></li>
  <li><a href="#why-is-anova-called-analysis-of-variance" id="toc-why-is-anova-called-analysis-of-variance" class="nav-link" data-scroll-target="#why-is-anova-called-analysis-of-variance">Why is ANOVA called “Analysis of Variance”?</a></li>
  </ul></li>
  <li><a href="#what-assumptions-are-required" id="toc-what-assumptions-are-required" class="nav-link" data-scroll-target="#what-assumptions-are-required">What assumptions are required?</a>
  <ul class="collapse">
  <li><a href="#assumption-1-the-samples-are-independent." id="toc-assumption-1-the-samples-are-independent." class="nav-link" data-scroll-target="#assumption-1-the-samples-are-independent.">Assumption 1: The samples are <strong>independent</strong>.</a></li>
  <li><a href="#assumption-2-the-data-are-normally-distributed." id="toc-assumption-2-the-data-are-normally-distributed." class="nav-link" data-scroll-target="#assumption-2-the-data-are-normally-distributed.">Assumption 2: The data are <strong>normally distributed</strong>.</a></li>
  <li><a href="#assumption-3-each-group-has-the-same-variance." id="toc-assumption-3-each-group-has-the-same-variance." class="nav-link" data-scroll-target="#assumption-3-each-group-has-the-same-variance.">Assumption 3: Each group has the <strong>same variance</strong>.</a></li>
  </ul></li>
  <li><a href="#working-through-our-waiting-times-example" id="toc-working-through-our-waiting-times-example" class="nav-link" data-scroll-target="#working-through-our-waiting-times-example">Working through our waiting times example</a>
  <ul class="collapse">
  <li><a href="#anova-as-a-linear-model" id="toc-anova-as-a-linear-model" class="nav-link" data-scroll-target="#anova-as-a-linear-model">ANOVA as a linear model</a></li>
  </ul></li>
  <li><a href="#common-pitfalls-of-anova-and-alternative-approaches" id="toc-common-pitfalls-of-anova-and-alternative-approaches" class="nav-link" data-scroll-target="#common-pitfalls-of-anova-and-alternative-approaches">Common pitfalls of ANOVA and alternative approaches</a>
  <ul class="collapse">
  <li><a href="#using-one-way-anova-when-there-is-more-than-one-grouping-variable" id="toc-using-one-way-anova-when-there-is-more-than-one-grouping-variable" class="nav-link" data-scroll-target="#using-one-way-anova-when-there-is-more-than-one-grouping-variable">Using one-way ANOVA when there is more than one grouping variable</a></li>
  <li><a href="#conducting-anova-multiple-times-for-multiple-outcomes" id="toc-conducting-anova-multiple-times-for-multiple-outcomes" class="nav-link" data-scroll-target="#conducting-anova-multiple-times-for-multiple-outcomes">Conducting ANOVA multiple times for multiple outcomes</a></li>
  <li><a href="#incorrectly-conducting-multiple-pair-wise-comparisons-following-anova" id="toc-incorrectly-conducting-multiple-pair-wise-comparisons-following-anova" class="nav-link" data-scroll-target="#incorrectly-conducting-multiple-pair-wise-comparisons-following-anova">Incorrectly conducting multiple pair-wise comparisons following ANOVA</a></li>
  <li><a href="#using-anova-to-analyse-repeated-measures-data" id="toc-using-anova-to-analyse-repeated-measures-data" class="nav-link" data-scroll-target="#using-anova-to-analyse-repeated-measures-data">Using ANOVA to analyse repeated-measures data</a></li>
  </ul></li>
  <li><a href="#freqently-asked-questions" id="toc-freqently-asked-questions" class="nav-link" data-scroll-target="#freqently-asked-questions">Freqently asked questions</a>
  <ul class="collapse">
  <li><a href="#can-i-use-anova-if-my-data-violates-the-assumption-of-common-variances" id="toc-can-i-use-anova-if-my-data-violates-the-assumption-of-common-variances" class="nav-link" data-scroll-target="#can-i-use-anova-if-my-data-violates-the-assumption-of-common-variances">Can I use ANOVA if my data violates the assumption of common variances?</a></li>
  <li><a href="#if-my-data-are-not-normal-can-i-simply-transform-it-and-draw-the-conclusions-as-normal" id="toc-if-my-data-are-not-normal-can-i-simply-transform-it-and-draw-the-conclusions-as-normal" class="nav-link" data-scroll-target="#if-my-data-are-not-normal-can-i-simply-transform-it-and-draw-the-conclusions-as-normal">If my data are not normal, can I simply transform it and draw the conclusions as normal?</a></li>
  <li><a href="#how-does-the-anova-for-model-comparison-work" id="toc-how-does-the-anova-for-model-comparison-work" class="nav-link" data-scroll-target="#how-does-the-anova-for-model-comparison-work">How does the ANOVA for model comparison work?</a></li>
  </ul></li>
  <li><a href="#the-end" id="toc-the-end" class="nav-link" data-scroll-target="#the-end">The end…</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Last week, <a href="https://rlbarter.github.io/Practical-Statistics/">practical statistics</a> met to discuss all things ANOVA. Below you will find the slides from my talk, but read on if you would like to learn all about ANOVA.</p>
<center>
<iframe src="https://docs.google.com/presentation/d/1mjaZs2ynGK7-qHFFr0nzjHmwqT3BhLDf0h-R5h6RsfU/embed?start=false&amp;loop=false&amp;delayms=3000" frameborder="0" width="720" height="449" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true">
</iframe>
</center>
<section id="when-anova-is-used-and-who-uses-it" class="level2">
<h2 class="anchored" data-anchor-id="when-anova-is-used-and-who-uses-it">When ANOVA is used and who uses it?</h2>
<p>ANOVA is used far and wide by the scientific community and beyond. Unfortunately, scientists also frequently misuse ANOVA. A study by <a href="https://www.hindawi.com/journals/tswj/2011/139494/">Wu et al.&nbsp;(2011)</a> showed that from a survey of 10 leading Chinese medical journals in 2008, 446 articles used ANOVA, and of those articles, <a href="https://www.hindawi.com/journals/tswj/2011/139494/tab1/"><strong>59% of them used ANOVA incorrectly</strong></a>.</p>
<p>In this post, I will describe the general framework for ANOVA, the assumptions it requires, and many common pitfalls. While I will introduce a few equations, I will not provide extensive details or derivations. Instead, I will focus on developing intuition for <em>why</em> these equations make sense for the type of problem at hand.</p>
<p>Let’s start by getting an idea of what kind of questions one can answer using ANOVA. Three examples are presented below.</p>
<ul>
<li><p><em>Is there a difference between the average number of times articles are shared on social media based on day of the week?</em></p></li>
<li><p><em>Is there a difference in average waiting room times for a set of 3 different hospitals?</em></p></li>
<li><p><em>Does the presence of other people have an influence on the amount of time taken for a person to help someone in distress?</em></p></li>
</ul>
<p>The third question is not like the others; can you see why? The first two questions are asking about a difference between mean values of some outcome (article shares or waiting room time) across multiple groups (day of week or hospital). The last question, however, does not seem to satisfy this criteria: while it has a clear outcome (amount of time taken for a person to help someone in distress), it has no obvious groupings.</p>
<p><a href="http://www.wadsworth.com/psychology_d/templates/student_resources/0155060678_rathus/ps/ps19.html">Darley and Latané (1969)</a> used ANOVA to answer the question of whether the presence of other people had an influence on the amount of time taken for a person to help someone in distress by setting up an appropriate experiment. In doing so, they were the first to demonstrate the “<a href="https://en.wikipedia.org/wiki/Bystander_effect">bystander effect</a>”.</p>
<p>In their experiment, the experimenter had the subject wait in a room with either 0, 2, or 4 other individuals. The experimenter announces that the study will begin shortly and walks into an adjacent room. In a few moments the people in the waiting room hear her fall and cry out. The outcome variable is the number of seconds it takes the subject to help the experimenter, and the grouping variable is the number of other people in the room (0, 2, or 4).</p>
<p>Given these examples, the definition of ANOVA provided in the following paragraph shouldn’t come as much of a surprise.</p>
</section>
<section id="anova-in-a-nutshell" class="level2">
<h2 class="anchored" data-anchor-id="anova-in-a-nutshell">ANOVA in a nutshell</h2>
<p><strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance (<strong>ANOVA</strong>), is a widely used method designed for <em>comparing differences in means among three or more groups.</em></p>
<p>For example, we might be interested in comparing the average waiting times in the emergency rooms of three different hospitals. Or perhaps we have conducted a clinical trial comparing the effectiveness of five different drugs for reducing blood pressure.</p>
<p>The key is that each individual falls into a group described by a <em>(categorical) grouping variable</em> (e.g.&nbsp;hospital or drug group) and for each individual we measure some <em>continuous outcome</em> (e.g.&nbsp;waiting time or blood pressure).</p>
<p>Although there are multiple types of ANOVA, the simplest (“one-way” ANOVA) can be thought of as a generalization of a two-sample t-test. One-way ANOVA involves testing the <em>omnibus hypothesis</em> that <em>k</em> population means are identical:</p>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 = ... = \mu_k.\]</span></p>
<p>Note that the two-sample t-test tested the hypothesis that <em>two</em> population means are equal (i.e.&nbsp;<em>k = 2</em>).</p>
<p>The alternative hypothesis for ANOVA states that <em>any one</em> of the population mean equalities does not hold:</p>
<p><span class="math display">\[H_1: \mu_i \neq \mu_j~~ \text{ for some } ~~i \neq j.\]</span></p>
<p>It is important to note that a rejection of the null hypothesis <strong>does not tell you which of the population means differ</strong>. It only tells you that there is <em>some</em> population whose mean is different from at least one other population (it could be that all of the means are different from one another!)</p>
<section id="a-simple-toy-example-hospital-waiting-times" class="level3">
<h3 class="anchored" data-anchor-id="a-simple-toy-example-hospital-waiting-times">A simple toy example: hospital waiting times</h3>
<p>Suppose that we have three hospitals, let’s call them A, B and C (creative names, I know). We are interested in whether all three hospitals have the same the average waiting time for the emergency room.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/hospitals.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
<figcaption>Three hospitals: A, B and C.</figcaption>
</figure>
</div>
</div>
</div>
<p>We measured the waiting time for 20 unique individuals at each of these three hospitals (so there are 60 individuals in total). These waiting times (in hours) are recorded below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Hospital A</th>
<th style="text-align: right;">Hospital B</th>
<th style="text-align: right;">Hospital C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">2.1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">1.4</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">1.7</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">1.2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.2</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">1.1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">1.3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">0.3</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">1.7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">0.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2.4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">2.2</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As pictures tend to be more informative than tables, we present a plot of these waiting times below. To aid the visualization, the x-position of each point is jittered to gently increase the space between the points.</p>
<p>Most people seem to wait over an hour, with some unlucky individuals waiting for almost 3 hours. The mean waiting time for each hospital is highlighted by a red bar.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2017-02-17-anova_files/figure-html/wait2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
<p>The question of interest is whether or not the average waiting time for each of the three hospitals is the same. This question might be naively interpreted as: “are the red bars at the same height?”, i.e.&nbsp;is there a difference between the waiting times for the <em>sample</em> of 20 patients from each hospital. The intended question is actually asking about equality between the average waiting times from the population of all patients who have ever, and will ever, wait in these waiting rooms, regardless of whether they fall in our sample.</p>
<p>Although the sample means clearly aren’t identical (the red bars are all at different heights), <strong>do we have enough evidence to show that the <em>underlying population</em> waiting time means are different</strong>, or are the differences that we observe are simply reflection of the inherent noise in the data?</p>
<p>This is the question that lies at the heart of hypothesis testing.</p>
</section>
<section id="why-is-anova-called-analysis-of-variance" class="level3">
<h3 class="anchored" data-anchor-id="why-is-anova-called-analysis-of-variance">Why is ANOVA called “Analysis of Variance”?</h3>
<p>What does comparing means have to do with variability?</p>
<p>Quite a lot it turns out… simply by asking “are the means different”, we are essentially asking a question about whether the variance of the means is large. However, the variability that we observe between the means themselves only makes sense relative to the overall variance in the data. For example, if the individual observations themselves are extremely variable, then it might be reasonable to expect that the observed group-specific averages might exhibit some variance (even if the underlying true averages are identical).</p>
<p>There are two types of variance at play here:</p>
<ul>
<li><p><strong>within-group variability</strong>: the variance of the individual observations within a group, and</p></li>
<li><p><strong>between-group variability</strong>: the variance between the averages of the groups.</p></li>
</ul>
<p>In the figure below, the red bars in the left panel highlight the <em>within-group variance</em>, while the red bars in the right panel highlight the <em>between-group variance</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2017-02-17-anova_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The basic idea is that <strong>if the variability between the groups is greater than the variability within the groups</strong>, then we have evidence that the differences between the groups is not simply reflecting random noise.</p>
<p>Quantifying the within and between group variability is typically done by calculating a mean sum of squares: add up the squared vertical distances and divide by the <em>degrees of freedom</em>.</p>
<p>This means that we are comparing the</p>
<ul>
<li>between sum of squares (BSS): the squared distances from the group means (average over all individuals separately <em>for each hospital</em>) to the global mean (average over all individuals),</li>
</ul>
<p>to the</p>
<ul>
<li>within sum of squares (WSS): the squared distances from each individual to their group mean (average over all individuals within the same hospital).</li>
</ul>
<p>Using this idea we can formulate a test statistic:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/F-stat.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To spell it out mathematically, we can write these expressions as follows:</p>
<p><span class="math display">\[WSS =\sum_{i = 1}^K \sum_{j = 1}^{n_i} (y_{ij} - \overline{y}_{i\cdot})^2 ~~~~~ \text{ and } ~~~~~ BSS = \sum_{i=1}^K (\overline{y}_{\cdot \cdot} - \overline{y}_{i\cdot})^2\]</span></p>
<p>where <span class="math inline">\(y_{ij}\)</span>, defines the waiting room time (outcome) for patient <span class="math inline">\(j\)</span> from hospital <span class="math inline">\(i\)</span>, <span class="math inline">\(\overline{y}_{\cdot \cdot}\)</span> defines the global average waiting time and <span class="math inline">\(\overline{y}_{i \cdot}\)</span> defines the average waiting time for hospital <span class="math inline">\(i\)</span>. <span class="math inline">\(K\)</span> is the number of hospitals, and <span class="math inline">\(n_i\)</span> is the number of patients sampled from hospital <span class="math inline">\(i\)</span>.</p>
<p>Note that in the test statistic above, each quantity is scaled by its <strong>degrees of freedom</strong>, which when comparing the groups is the number of groups minus 1 (<span class="math inline">\(K-1\)</span>), and when comparing individuals is the number of individuals minus the number of groups (<span class="math inline">\(N-K\)</span>).</p>
</section>
</section>
<section id="what-assumptions-are-required" class="level2">
<h2 class="anchored" data-anchor-id="what-assumptions-are-required">What assumptions are required?</h2>
<p>If our data satisfies a few parametric assumptions, then we can show that this test statistic follows an <span class="math inline">\(F\)</span> distribution and we can do a straightforward parametric hypothesis test:</p>
<p><span class="math display">\[\text{p-value} = P\left(F_{K-1, N-k} \geq \frac{BSS/(K-1)}{WSS/(N-K)}\right).\]</span></p>
<p>These assumptions are as follows</p>
<section id="assumption-1-the-samples-are-independent." class="level3">
<h3 class="anchored" data-anchor-id="assumption-1-the-samples-are-independent.">Assumption 1: The samples are <strong>independent</strong>.</h3>
<p>Independence is an extremely common assumption that is hard to test in general.</p>
</section>
<section id="assumption-2-the-data-are-normally-distributed." class="level3">
<h3 class="anchored" data-anchor-id="assumption-2-the-data-are-normally-distributed.">Assumption 2: The data are <strong>normally distributed</strong>.</h3>
<p>Not being a fan of such distributional assumptions myself, I am inclined to point the reader in the direction of non-parametric versions of ANOVA, including the <a href="https://en.wikipedia.org/wiki/Kruskal%E2%80%93Wallis_one-way_analysis_of_variance">Kruskal-Wallis test</a>, however since this is a blog post about ANOVA, we will leave non-parametric readings to the interested parties. Those wishing to test the normality of their data can do so using a variety of methods such as plotting a QQ-plot, or using a normality test (see the <a href="https://en.wikipedia.org/wiki/Normality_test">Wikipedia page on normality tests</a>).</p>
</section>
<section id="assumption-3-each-group-has-the-same-variance." class="level3">
<h3 class="anchored" data-anchor-id="assumption-3-each-group-has-the-same-variance.">Assumption 3: Each group has the <strong>same variance</strong>.</h3>
<p>The common variance assumption can be tested using common tests, such as the <a href="https://en.wikipedia.org/wiki/Bartlett%27s_test">Bartlett test</a> and the <a href="http://www.statsref.com/HTML/index.html?fligner-killeen_test.html">Fligner-Killeen test</a>, which are easily implemented in R.</p>
</section>
</section>
<section id="working-through-our-waiting-times-example" class="level2">
<h2 class="anchored" data-anchor-id="working-through-our-waiting-times-example">Working through our waiting times example</h2>
<p>Let’s examine these assumptions for our Hospital waiting times example.</p>
<p>Unfortunately, independence is hard to judge statistically, but if, for example, each person was randomly selected from a splattering of visitors to the waiting room at different times (rather than, e.g.&nbsp;selecting 5 members of the same family all of whom came to the hospital together in some freak accident), then the assumption of independence is probably ok.</p>
<p>The figure below plots the density estimation for the waiting times from each hospital. We know that if our data is normally distributed, it should look vaguely like a bell-curve.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2017-02-17-anova_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>One might argue that these are some pretty funky-looking bell-curves…</p>
<p>However, as I was the one who simulated this data in the first place, I can assure you that they are in fact normally distributed, and you can use this as a lesson on the difficult of drawing conclusions on normality from small samples (in this case, we have 20 observations in each group).</p>
<p>A <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/shapiro.test.html">Shapiro-Wilk test for normality</a> provides p-values of 0.39, 0.087, 0.52 for hospitals A, B and C, respectively. Although none of these values are “significant” (even unadjusted for multiple testing), we have stumbled upon another lesson: small p-values (<span class="math inline">\(p = 0.087\)</span> for hospital B) can certainly occur when the null hypothesis is true (in this case, the null hypothesis is that the data are normally distributed)! Remember that when the null hypothesis is true, p-values are uniformly distributed.</p>
<p>Finally, based on a visual assessment, the common variance assumption is probably fairly reasonable (and, again, since I simulated this data, I can confirm that the variance is the same for each hospital).</p>
<p>To test this formally, <a href="https://en.wikipedia.org/wiki/Bartlett's_test">Bartlett’s test for homogeneity of variances</a> yields a p-value of 0.68, indicating that we do not have evidence that the variances are different.</p>
<p>We have now concluded that the assumptions for ANOVA are satisfied, and can proceed to do our calculations.</p>
<p>Calculating the between-sum-of-squares (BSS) and scaling by the degrees of freedom (the number of groups minus 1), and the within-sum-of-squares (WSS) and scaling by the degrees of freedom (the number of observations minus the number of groups), we get that</p>
<p><span class="math display">\[\frac{BSS}{K - 1} = \frac{5.94}{3 - 1} = 2.97 ~~~~~~ \text{and} ~~~~~ \frac{WSS}{N - K} = \frac{16.96}{60 - 3} = 0.30.\]</span></p>
<p>Our test statistic turns out to be quite large indeed:</p>
<p><span class="math display">\[F = \frac{BSS/(K-1)}{WSS/(N-k)} = \frac{2.97}{0.3} = 9.98.\]</span></p>
<p>Since we are confident that the ANOVA assumptions are satisfied, this F-statistic must follow an F distribution with suitable degrees of freedom. Our p-value can thus be calculated as follows:</p>
<p><span class="math display">\[P(F_{2, 53} \geq 9.98) = 0.000192\]</span></p>
<p>And we can claim to have evidence that the three group means are not all identical. Note that we can interpret this as the distances between the group means and the global mean is quite large relative to the distances between the individual observations and the group means. Recall that these distances are scaled by their respective degrees of freedom.</p>
<p>Rather than conducting these calculations by hand, in R, one could simply use the <code>aov()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(time <span class="sc">~</span> hospital, <span class="at">data =</span> data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
variable     2  5.938  2.9688   9.981 0.000192 ***
Residuals   57 16.955  0.2975                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>obtaining the same p-value.</p>
<section id="anova-as-a-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="anova-as-a-linear-model">ANOVA as a linear model</h3>
<p>So far we have discussed ANOVA purely as a hypothesis test comparing two different types of variability. It is, however, more common to talk about ANOVA as a <strong>linear model</strong>.</p>
<p>The anova linear model can be written as follows:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/model.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\mu\)</span> represents the overall average wait time across all hospitals, and <span class="math inline">\(\tau_i\)</span> represents the amount of time that is either added or subtracted from the overall average as a result of being at hospital <span class="math inline">\(i\)</span>. To get the average wait time for hospital <span class="math inline">\(i\)</span> we can calculate <span class="math inline">\(\mu_i := \mu + \tau_i\)</span>.</p>
<p>Finally, <span class="math inline">\(\epsilon_{ij}\)</span> represents the “noise” term; the quantity that defines how the waiting time for individual <span class="math inline">\(j\)</span> differs from the mean (within their group).</p>
<p>We typically assume that the expected value (the average over the population) for <span class="math inline">\(\epsilon_{ij}\)</span> is equal to zero, and that the <span class="math inline">\(\tau_i\)</span>s add up to zero. Note that if we do not assume that <span class="math inline">\(\tau_i\)</span>s sum to zero, then the model is “over-parametrized” in that there would be an infinite number of ways to define the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau_i\)</span>s such that they add up to the group mean <span class="math inline">\(\mu_i\)</span>.</p>
<p>The question that is sure to be on the edge of your tongue is <strong>“how is this possibly equivalent to the hypothesis test discussed above?”</strong></p>
<p>The answer is simple and can be summarized by the diagram below.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/equivalence.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Specifically, if the hospital-specific effects <span class="math inline">\(\tau_A, \tau_B,\)</span> and <span class="math inline">\(\tau_C\)</span> are all equal to zero, then the average effect across all groups is the same: <span class="math inline">\(\mu_A = \mu_B = \mu_C = \mu\)</span>.</p>
</section>
</section>
<section id="common-pitfalls-of-anova-and-alternative-approaches" class="level2">
<h2 class="anchored" data-anchor-id="common-pitfalls-of-anova-and-alternative-approaches">Common pitfalls of ANOVA and alternative approaches</h2>
<p>Despite its perceived simplicity, scientists frequently misuse ANOVA. A study by <a href="https://www.hindawi.com/journals/tswj/2011/139494/">Wu et al.&nbsp;(2011)</a> showed that from a survey of 10 leading Chinese medical journals in 2008, 446 articles used ANOVA, and of those articles, <a href="https://www.hindawi.com/journals/tswj/2011/139494/tab1/"><strong>59% of them used ANOVA incorrectly</strong></a>.</p>
<p>Below we will discuss many of the common pitfalls.</p>
<section id="using-one-way-anova-when-there-is-more-than-one-grouping-variable" class="level3">
<h3 class="anchored" data-anchor-id="using-one-way-anova-when-there-is-more-than-one-grouping-variable">Using one-way ANOVA when there is more than one grouping variable</h3>
<p>Suppose that instead of solely measuring waiting times from emergency waiting rooms at each hospital, we instead measured the waiting times from three medical departments from each hospital: <em>surgery</em>, <em>pediatrics</em>, and <em>dentistry</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/two-way.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In this scenario we should adapt the model to take the second grouping variable into account. This is called <strong>two-way ANOVA</strong>, and the model can be adapted as follows:</p>
<p><span class="math display">\[y_{ijk} = \mu + \tau_i + \gamma_j + \beta_{ij} + \epsilon_{ijk}\]</span></p>
<p>where <span class="math inline">\(\tau_i\)</span> represents the hospital-specific effect on waiting time and <span class="math inline">\(\gamma_j\)</span> represents the department-specific effect. <span class="math inline">\(\beta_{ij}\)</span> represents an interaction term between these two effects.</p>
<p>Another adaptation of ANOVA when the second grouping variable (medical department) is not the same across each hospital is called <strong>nested ANOVA</strong> (see fig below). For example, perhaps we are comparing both hospitals and medical departments, but we are not examining the same medical department in each hospital.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/nested.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conducting-anova-multiple-times-for-multiple-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="conducting-anova-multiple-times-for-multiple-outcomes">Conducting ANOVA multiple times for multiple outcomes</h3>
<p>Suppose that instead of simply being interested in whether there is a difference between waiting time for each hospital, we were also interested in differences in average <em>length of hospital stay</em> and <em>cost of visit</em>. Then the incorrect way to proceed would be to generate three separate ANOVA models and draw our conclusions separately for each model. This reeks of multiple testing issues and does not take into account any dependence between the different outcome variables.</p>
<p>Instead, one should use Multivariate Analysis of Variance (<strong>MANOVA</strong>), which can be written as follows:</p>
<p><span class="math display">\[ \left[\begin{array}a  y_{ij1} \\ y_{ij2} \\ y_{ij3} \end{array} \right]= \mu + \tau_i +  \epsilon_{ij}\]</span> where</p>
<ul>
<li><span class="math inline">\(y_{ij1}\)</span> is the waiting time for individual <span class="math inline">\(j\)</span> from hospital <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(y_{ij2}\)</span> is the length of hospital stay for individual <span class="math inline">\(j\)</span> from hospital <span class="math inline">\(i\)</span>, and</li>
<li><span class="math inline">\(y_{ij3}\)</span> is the cost of the visit for individual <span class="math inline">\(j\)</span> from hospital <span class="math inline">\(i\)</span>.</li>
</ul>
</section>
<section id="incorrectly-conducting-multiple-pair-wise-comparisons-following-anova" class="level3">
<h3 class="anchored" data-anchor-id="incorrectly-conducting-multiple-pair-wise-comparisons-following-anova">Incorrectly conducting multiple pair-wise comparisons following ANOVA</h3>
<p>Upon obtaining a “significant” ANOVA p-value, a common mistake is to then go and test all of the pairwise differences to identify <em>which</em> of the populations had different means. This is another example of multiple hypothesis testing, and corrections on these p-values must be made. See the <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem">Wikipedia page</a> for details on this common issue.</p>
</section>
<section id="using-anova-to-analyse-repeated-measures-data" class="level3">
<h3 class="anchored" data-anchor-id="using-anova-to-analyse-repeated-measures-data">Using ANOVA to analyse repeated-measures data</h3>
<p>What if, instead of having measured the waiting room times on a different set of 20 people at each hospital (left-panel in fig below), we instead measured the waiting room times on the same set of 20 people at each hospital (right-panel in fig below)?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/anova/repeated-normal-anova.png" class="quarto-figure quarto-figure-center figure-img" width="800" height="200"></p>
</figure>
</div>
</div>
</div>
<p>We have certainly violated the assumption that our observations are independent. Fortunately, <strong>repeated measures ANOVA (rANOVA)</strong> is a method for exactly this situation.</p>
<p>Basically, rANOVA simply splits the within sum of squares into the individual-level sum of squares and the random error sum of squares. An excellent article describing rANOVA can be found <a href="https://statistics.laerd.com/statistical-guides/repeated-measures-anova-statistical-guide.php">here</a>. A common repeated measures experimental design involves observations being made at different <em>time points</em> (as opposed to at different hospitals).</p>
<p>According to the Wikipedia article,</p>
<blockquote class="blockquote">
<p>rANOVA is not always the best statistical analysis for repeated measure designs. The rANOVA is vulnerable to effects from missing values, imputation, unequivalent time points between subjects and violations of sphericity. These issues can result in sampling bias and inflated rates of Type I error. In such cases it may be better to consider use of a linear mixed model.</p>
</blockquote>
</section>
</section>
<section id="freqently-asked-questions" class="level2">
<h2 class="anchored" data-anchor-id="freqently-asked-questions">Freqently asked questions</h2>
<section id="can-i-use-anova-if-my-data-violates-the-assumption-of-common-variances" class="level3">
<h3 class="anchored" data-anchor-id="can-i-use-anova-if-my-data-violates-the-assumption-of-common-variances">Can I use ANOVA if my data violates the assumption of common variances?</h3>
<p>According to this post on <a href="http://stats.stackexchange.com/questions/56971/alternative-to-one-way-anova-unequal-variance">Stats Stack Exchange</a>, if the sample size in each group is similar, and the difference between variance isn’t too bad, you should be ok.</p>
<p>According to user <em>gung</em>, with similar group sizes there is a rule of thumb that states that</p>
<blockquote class="blockquote">
<p>ANOVA is robust to heterogeneity of variance so long as the largest variance is not more than 4 times the smallest variance.</p>
</blockquote>
<p>I’ll admit that I haven’t checked this claim, but I’d be willing to believe it.</p>
<p>If, however, your data has wildly different group variances or varying group sizes, then I’m not entirely sure of what options exist (note that the non-parametric alternative also assumes that the population variances are similar).</p>
</section>
<section id="if-my-data-are-not-normal-can-i-simply-transform-it-and-draw-the-conclusions-as-normal" class="level3">
<h3 class="anchored" data-anchor-id="if-my-data-are-not-normal-can-i-simply-transform-it-and-draw-the-conclusions-as-normal">If my data are not normal, can I simply transform it and draw the conclusions as normal?</h3>
<p>Yes, probably.</p>
</section>
<section id="how-does-the-anova-for-model-comparison-work" class="level3">
<h3 class="anchored" data-anchor-id="how-does-the-anova-for-model-comparison-work">How does the ANOVA for model comparison work?</h3>
<p>It is common to use the <code>anova()</code> function in R to compare two different models. Specifically, it compares <em>nested</em> models wherein one model consists of a subset of the set of variables of the other model.</p>
<p>Note that the use of the word “nested” here has nothing to do with the nested anova discussed above in which the grouping variables themselves (rather than the models) were nested.</p>
<p>The comparison being made by ANOVA in this situation is whether the residual sum of squares (which is essentially the <em>within sum of squares</em> from one-way ANOVA) for model 1 (the larger model) is larger than the residual sum of squares for model 2 (the smaller model).</p>
<p>Specifically, it calculates the F-statistic</p>
<p><span class="math display">\[F = \frac{(RSS_{\text{model 2}} - RSS_{\text{model 1}})/(p_1 - p_2)}{RSS_{\text{model 1}}/(n - p_1)}\]</span></p>
<p>The idea is that since model 2 is a special case of model 1, model 1 is more complex so <span class="math inline">\(RSS_{\text{model 2}}\)</span> will always be as least as large as <span class="math inline">\(RSS_{\text{model 1}}\)</span>. The question is whether the difference is “statistically significant”.</p>
<p>Note that if you call the <code>anova()</code> function with a single model, it will compare the first variable in the model to a baseline model with no predictors. If there is a second variable, it compares the model with both variables against the model with just one variable, and so on and so forth.</p>
<p>See this <a href="http://www.statpower.net/Content/311/Lecture%20Notes/RegressionIntro.pdf">set of slides</a> by James Steiger if you’re interested in further details.</p>
</section>
</section>
<section id="the-end" class="level2">
<h2 class="anchored" data-anchor-id="the-end">The end…</h2>
<p>While this post has only scratched the surface of all things ANOVA, I hope that you have developed a general intuition for how ANOVA works, what assumptions are needed to make things go, and common pitfalls to avoid.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="rlbarter/blog_comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>