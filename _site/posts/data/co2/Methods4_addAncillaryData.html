<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Rebecca Barter – methods4_addancillarydata</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Rebecca Barter</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
 <span class="menu-text">About Rebecca</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rlbarter"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/rlbarter"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">



<section id="methods4_addancillarydata.ipynb" class="level1">
<h1>Methods4_addAncillaryData.ipynb</h1>
<p>Add ancillary data collected to match Scope-1 CO2 emissions for all datasets.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>stdout <span class="op">=</span> sys.stdout</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">reload</span>(sys)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>sys.setdefaultencoding(<span class="st">'utf-8'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>sys.stdout <span class="op">=</span> stdout</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_colwidth'</span>, <span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>var_city <span class="op">=</span> <span class="st">'city name'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="functions" class="level1">
<h1>Functions</h1>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tag_column_names_with_datasetname(df, tagname):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Add to column name dataset from which column was obtained"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    col_names <span class="op">=</span> <span class="bu">list</span>(df)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cname <span class="kw">in</span> col_names:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cname <span class="op">!=</span> var_city:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cname <span class="op">!=</span> <span class="st">'country'</span>:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                df.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' ('</span> <span class="op">+</span> tagname <span class="op">+</span> <span class="st">')'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fn_mergeDuplicates(df, attr):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""merges attr_x and attr_y into one single attr after checking for nan"""</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    attr_x <span class="op">=</span> attr <span class="op">+</span> <span class="st">'_x'</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    attr_y <span class="op">=</span> attr <span class="op">+</span> <span class="st">'_y'</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#make common col in df</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    df[attr] <span class="op">=</span> np.nan</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#_x exists, _y does not</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    condx <span class="op">=</span> (<span class="op">~</span>df[attr_x].isnull() <span class="op">&amp;</span> df[attr_y].isnull() )</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    df.loc[condx, attr] <span class="op">=</span> df[attr_x]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#_y exists, _x does not</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    condy <span class="op">=</span> (df[attr_x].isnull() <span class="op">&amp;</span> <span class="op">~</span>df[attr_y].isnull() )</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    df.loc[condy, attr] <span class="op">=</span> df[attr_y]</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#_x == _y</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    cond_both <span class="op">=</span> (df[attr_x] <span class="op">==</span> df[attr_y] )</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    df.loc[cond_both, attr] <span class="op">=</span> np.nan</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    df.drop(attr_x, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    df.drop(attr_y, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-data" class="level1">
<h1>Read data</h1>
<section id="merged-emissions-datasets" class="level2">
<h2 class="anchored" data-anchor-id="merged-emissions-datasets">Merged Emissions datasets</h2>
<p>343 cities x 59 columns</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Output file from Methods_mergeEmissionsDatasets.ipynb</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>femissions <span class="op">=</span> <span class="st">'DATA/INTERMEDIATE_FILES/merged_emissions_dataset.tsv'</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>df_emissions <span class="op">=</span> pd.read_csv(femissions, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_emissions.drop(<span class="st">'Unnamed: 0'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_emissions.shape</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>df_emissions.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 59)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Average altitude (m)</th>
      <th>Average annual temperature (in Celsius) (CDP)</th>
      <th>Boundary (CDP)</th>
      <th>Built-up Area (km2) (PKU)</th>
      <th>CDP2016 data edited (CDP)</th>
      <th>CH4_(waste+natgas)/person</th>
      <th>CH4_waste/person</th>
      <th>CO2 Emissions Per Capita (Ton) (PKU)</th>
      <th>City GDP (CDP)</th>
      <th>...</th>
      <th>GDP unit (carbonn)</th>
      <th>GDP (carbonn)</th>
      <th>GDP year (carbonn)</th>
      <th>lat (carbonn)</th>
      <th>lon (carbonn)</th>
      <th>nGDP (carbonn)</th>
      <th>pop (carbonn)</th>
      <th>pop_yr (carbonn)</th>
      <th>region</th>
      <th>scope fraction (CDP)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Administrative boundary of a local government</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.017031</td>
      <td>0.010683</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Europe</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>86.0</td>
      <td>13.6</td>
      <td>Other: Municipal boundary</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.036729</td>
      <td>0.017699</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>North America</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 59 columns</p>
</div>
</div>
</div>
</section>
<section id="ancillary-datatsets" class="level2">
<h2 class="anchored" data-anchor-id="ancillary-datatsets">Ancillary datatsets</h2>
<section id="read-datatset-from-creutzig-et-al." class="level3">
<h3 class="anchored" data-anchor-id="read-datatset-from-creutzig-et-al.">Read datatset from Creutzig et al.</h3>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#273 cities in GEA+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>f_creutzig <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/merge_gea_uitp_wb_pruned.tsv'</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>df_creutzig <span class="op">=</span> pd.read_csv(f_creutzig, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>df_creutzig.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_creutzig.shape</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>df_creutzig.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(273, 41)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>full city name (GEA)</th>
      <th>full city name (UITP)</th>
      <th>full city name (WB)</th>
      <th>definition  (WB)</th>
      <th>study_year (WB)</th>
      <th>country</th>
      <th>population (GEA)</th>
      <th>population (UITP)</th>
      <th>population (WB)</th>
      <th>...</th>
      <th>household_size (GEA+)</th>
      <th>year_household_size (GEA+)</th>
      <th>household_source (GEA+)</th>
      <th>comment_household_size (GEA+)</th>
      <th>urbanization_ratio (GEA+)</th>
      <th>water_bounded (GEA+)</th>
      <th>other_bounded (GEA+)</th>
      <th>GDP-PPP/cap (GEA)</th>
      <th>GDP-PPP/cap (UITP)</th>
      <th>GDP-PPP/cap (WB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ahmedabad</td>
      <td>Ahmadabad</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>India</td>
      <td>4900000.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>4.80</td>
      <td>2011.0</td>
      <td>Household: http://www.censusindia.gov.in/2011census/hlo/District_Tables/Distt_table/24/HH1604-2400CRCD.pdf -- Population: http://www.censusindia.gov.in/2011-prov-results/prov_data_products_gujarat.html</td>
      <td>Calculation: pop/household (7208200/1494656)</td>
      <td>29.235</td>
      <td>0.0</td>
      <td>River</td>
      <td>6247.853521</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Amsterdam</td>
      <td>Amsterdam</td>
      <td>Amsterdam</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Netherlands</td>
      <td>743000.0</td>
      <td>831499.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>1.82</td>
      <td>2004.0</td>
      <td>http://www.urbanaudit.org</td>
      <td>-999</td>
      <td>80.172</td>
      <td>1.0</td>
      <td>-999</td>
      <td>41069.368118</td>
      <td>28321.84</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 41 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df_creutzig.drop(<span class="st">'country'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-ancillary-data-retrieved-manually-from-external-sources" class="level3">
<h3 class="anchored" data-anchor-id="read-ancillary-data-retrieved-manually-from-external-sources">Read ancillary data retrieved manually from external sources</h3>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/merge_gea_uitp_wb_cdp2016_cdp_only_toFill.xlsx'</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#worksheet with manually-added columns.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>f_filled <span class="op">=</span> <span class="st">'with manual edits'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig <span class="op">=</span> pd.read_excel(<span class="bu">open</span>(fname,<span class="st">'rb'</span>), sheetname<span class="op">=</span>f_filled, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Keep only the new columns that need to be added to df_primary</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'Account Number (CDP)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'area_size (GEA)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'definition  (WB)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'diesel_price (GEA)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'gasoline_price (GEA)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Not consistently collected</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'pop (others) access date'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'area (others) access date'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">u'travel time access date'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Not used</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.drop(<span class="st">'pop density (computed)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace -999 with nan</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'household_size (updated)'</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_filledCreutzig.loc[df_filledCreutzig[attr] <span class="op">&lt;</span> <span class="dv">0</span>, attr].count()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.loc[df_filledCreutzig[attr] <span class="op">&lt;</span> <span class="dv">0</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace -999 with nan</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>attr<span class="op">=</span><span class="st">'year_household_size (updated)'</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_filledCreutzig.loc[df_filledCreutzig[attr] <span class="op">&lt;</span> <span class="dv">0</span>, attr].count()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.loc[df_filledCreutzig[attr] <span class="op">&lt;</span> <span class="dv">0</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Tag columns with ('others') tag</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'mean travel time [min]'</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'mean travel time ref year'</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'mean travel time ref'</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'diesel_price (2014)'</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'gasoline_price (2014)'</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'household_size (updated)'</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'year_household_size (updated)'</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'household_source (updated)'</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>cname <span class="op">=</span> <span class="st">u'comment_household_size (updated)'</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>df_filledCreutzig.rename(columns <span class="op">=</span> {cname:cname <span class="op">+</span> <span class="st">' (others)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-ancillary-fuel-data-for-carbonn-and-pku-cities" class="level3">
<h3 class="anchored" data-anchor-id="read-ancillary-fuel-data-for-carbonn-and-pku-cities">Read ancillary fuel data for carbonn and PKU cities</h3>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fname <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/missingFuel_AP.xlsx'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#worksheet</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>f_fuel <span class="op">=</span> <span class="st">'missingFuel'</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>df_fuel <span class="op">=</span> pd.read_excel(<span class="bu">open</span>(fname,<span class="st">'rb'</span>), sheetname<span class="op">=</span>f_fuel, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_fuel.shape</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>df_fuel.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(156, 5)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>country</th>
      <th>Scope-1 source dataset</th>
      <th>diesel_price (2014) (others)</th>
      <th>gasoline_price (2014) (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Aguascalientes</td>
      <td>Mexico</td>
      <td>carbonn</td>
      <td>102</td>
      <td>103</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>India</td>
      <td>carbonn</td>
      <td>91</td>
      <td>110</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Anshan</td>
      <td>China</td>
      <td>PKU</td>
      <td>109</td>
      <td>117</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Anyang</td>
      <td>China</td>
      <td>PKU</td>
      <td>109</td>
      <td>117</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Balikpapan</td>
      <td>Indonesia</td>
      <td>carbonn</td>
      <td>80</td>
      <td>93</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_fuel.drop(<span class="st">'country'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df_fuel.drop(<span class="st">'Scope-1 source dataset'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert cents to USD</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df_fuel[<span class="st">'diesel_price (2014) (others)'</span>] <span class="op">=</span> df_fuel[<span class="st">'diesel_price (2014) (others)'</span>]<span class="op">/</span><span class="dv">100</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df_fuel[<span class="st">'gasoline_price (2014) (others)'</span>] <span class="op">=</span> df_fuel[<span class="st">'gasoline_price (2014) (others)'</span>]<span class="op">/</span><span class="dv">100</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>df_fuel.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>diesel_price (2014) (others)</th>
      <th>gasoline_price (2014) (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Aguascalientes</td>
      <td>1.02</td>
      <td>1.03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>0.91</td>
      <td>1.10</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Anshan</td>
      <td>1.09</td>
      <td>1.17</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Anyang</td>
      <td>1.09</td>
      <td>1.17</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Balikpapan</td>
      <td>0.80</td>
      <td>0.93</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="read-gdp-ancillary-data-for-cdp-retrieved-manually-from-external-sources" class="level3">
<h3 class="anchored" data-anchor-id="read-gdp-ancillary-data-for-cdp-retrieved-manually-from-external-sources">Read GDP ancillary data for CDP retrieved manually from external sources</h3>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#External GDP for CDP cities</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>f_gdp_cdp <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/GDP_all available_24-11-2017_processed.tsv'</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>df_gdp_cdp <span class="op">=</span> pd.read_csv(f_gdp_cdp, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>df_gdp_cdp.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_gdp_cdp.shape</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>df_gdp_cdp.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(187, 9)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>GDP-PPP [$BN] (others)</th>
      <th>GDP-PPP/cap [$USD] (others)</th>
      <th>GDP-PPP [$BN] (others) source</th>
      <th>GDP-PPP year (others)</th>
      <th>nGDP [$BN] (others)</th>
      <th>nGDP/cap [$USD] (others)</th>
      <th>nGDP [$BN] (others) source</th>
      <th>nGDP [$BN] (others) source year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aarhus</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2008</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Abington</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2008</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[20] Economic growth widespread across metropolitan areas in 2014. GDP by metropolitan area statistics. Available at https://bea.gov/newsreleases/regional/gdp_metro/2015/pdf/gdp_metro0915.pdf</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="read-ancillary-data-for-carbonn-subset" class="level3">
<h3 class="anchored" data-anchor-id="read-ancillary-data-for-carbonn-subset">Read ancillary data for carbonn subset</h3>
<p>Ancillary data to merge: GDP, population, city area, household size.<br>
File is a merge of ancillary data for the 48 hand-selected carbonn + 25 carbonn cities in Creutzig et al.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#49 new carbonn cities + 25 carbonn cities in Creutzig et al.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>f_carbonn <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/carbonn_ancillary.tsv'</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>df_carbonn <span class="op">=</span> pd.read_csv(f_carbonn, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>df_carbonn.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_carbonn.shape</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>df_carbonn.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(73, 18)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>population (others)</th>
      <th>population (others) source year</th>
      <th>population (others) source</th>
      <th>area [km2] (others)</th>
      <th>area [km2] (others) source year</th>
      <th>area [km2] (others) source</th>
      <th>GDP-PPP [$BN] (others)</th>
      <th>GDP-PPP/cap [$USD] (others)</th>
      <th>GDP-PPP [$BN] (others) source</th>
      <th>GDP-PPP year (others)</th>
      <th>nGDP [$BN] (others)</th>
      <th>nGDP/cap [$USD] (others)</th>
      <th>nGDP [$BN] (others) source year</th>
      <th>nGDP [$BN] (others) source</th>
      <th>Household_size</th>
      <th>Household_source</th>
      <th>Year_Household size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aguascalientes</td>
      <td>934424</td>
      <td>2012</td>
      <td>Wikipedia</td>
      <td>385.0</td>
      <td>2012</td>
      <td>Wikipedia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Balikpapan</td>
      <td>736806</td>
      <td>2015</td>
      <td>Wikipedia</td>
      <td>503.3</td>
      <td>2015</td>
      <td>Wikipedia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>1.254480e+07</td>
      <td>NaN</td>
      <td>[3], [19]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="read-ancillary-data-collected-manually-for-chinese-cities" class="level3">
<h3 class="anchored" data-anchor-id="read-ancillary-data-collected-manually-for-chinese-cities">Read ancillary data collected manually for chinese cities</h3>
<p>Ancillary data to merge: lat, lon, population + refs, area + refs</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#25 carbonn cities that overlap with Creutzig et al.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>f_china_ancillary <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/china_ancillary.tsv'</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>df_china_ancillary <span class="op">=</span> pd.read_csv(f_china_ancillary, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>df_china_ancillary.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_china_ancillary.shape</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>df_china_ancillary.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(83, 16)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>lat</th>
      <th>lon</th>
      <th>population (others)</th>
      <th>population (others) source year</th>
      <th>population (others) source</th>
      <th>area [km2] (others)</th>
      <th>area [km2] (others) source year</th>
      <th>area [km2] (others) source</th>
      <th>GDP-PPP [$BN] (others)</th>
      <th>GDP-PPP year (others)</th>
      <th>GDP-PPP/cap [$USD] (others)</th>
      <th>GDP-PPP [$BN] (others) source</th>
      <th>nGDP [$BN] (others)</th>
      <th>nGDP/cap [$USD] (others)</th>
      <th>nGDP [$BN] (others) source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Beijing</td>
      <td>39.916667</td>
      <td>116.383333</td>
      <td>18766000</td>
      <td>NaN</td>
      <td>wikipedia, urban values</td>
      <td>1368.0</td>
      <td>NaN</td>
      <td>(urban), from wikipedia</td>
      <td>0.00000</td>
      <td>2015</td>
      <td>NaN</td>
      <td>[21] Redefining Global Cities Report and online dataset 2015. GDP (Millions PPP$). Brookings Institution. Retrieved 26/09/2017 at https://www.brookings.edu/research/redefining-global-cities/#cancel</td>
      <td>206.2</td>
      <td>10952.355659</td>
      <td>[3] The Most Dynamic Cities of 2025. Foreign Policy. Retrieved 24/08/2012. http://foreignpolicy.com/2012/08/07/the-most-dynamic-cities-of-2025/, [19]\n[19] Global Cities of the Future. Dynamic map. McKinsey&amp;CompacKinsey Global Institute City Scope v2.0 Last updated June 2012. Retrieved 27/09/2017. Available at: http://www.mckinsey.com/tools/Wrappers/Redesign/InteractiveWrapper.aspx?sc_itemid={C84CB74F-A3B1-47B1-8265-6252F6D85B68}</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tianjin</td>
      <td>39.133333</td>
      <td>117.183333</td>
      <td>12784000</td>
      <td>NaN</td>
      <td>wikipedia, urban values</td>
      <td>174.9</td>
      <td>NaN</td>
      <td>(urban), from wikipedia</td>
      <td>0.00364</td>
      <td>2014</td>
      <td>NaN</td>
      <td>[1] Berube A., J. L. Trujillo, T. Ran, J. Parilla (Thursday, January 22, 2015), Brookings/Global Metro Monitor Report. Available online at https://www.brookings.edu/wp-content/uploads/2015/01/bmpp_gmm_final.pdf and the 2014 Global Metro Monitor Map, available at https://www.brookings.edu/research/global-metro-monitor/. The data retrieved 27/09/2017.</td>
      <td>128.8</td>
      <td>11614.066727</td>
      <td>[3], [19]</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_china_ancillary.rename(columns <span class="op">=</span> {<span class="st">'lat'</span>: <span class="st">'lat (PKU)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df_china_ancillary.rename(columns <span class="op">=</span> {<span class="st">'lon'</span>: <span class="st">'lon (PKU)'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-ancillary-data-for-japanese-cities" class="level3">
<h3 class="anchored" data-anchor-id="read-ancillary-data-for-japanese-cities">Read ancillary data for Japanese cities</h3>
<p>Ancillary data to merge: area, population, GDP (unit million USD), diesel &amp; gasoline price, % population growth rate as measured between 2010-2015, altitude (m), avg household size, mean travel time to work (min), HDD 25C/CDD 0C for 2017.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>f_japan <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/japan_prepared.tsv'</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df_japan <span class="op">=</span> pd.read_csv(f_japan, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>df_japan.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_japan.shape</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>df_japan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(7, 18)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>area [km2] (others)</th>
      <th>population (others)</th>
      <th>Average altitude (m)</th>
      <th>household_size (updated) (others)</th>
      <th>mean travel time [min] (others)</th>
      <th>GDP [$BN]</th>
      <th>Scope 1 [tCO2]</th>
      <th>area [km2] (others) source year</th>
      <th>area [km2] (others) source</th>
      <th>population (others) source year</th>
      <th>population (others) source</th>
      <th>year_household_size (updated) (others)</th>
      <th>household_source (updated) (others)</th>
      <th>mean travel time ref year (others)</th>
      <th>mean travel time ref (others)</th>
      <th>GDP source</th>
      <th>GDP source year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Hiroshima</td>
      <td>906.53</td>
      <td>1154391</td>
      <td>165.6</td>
      <td>2.25</td>
      <td>27.9</td>
      <td>46.47573</td>
      <td>5866540.52</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kyoto</td>
      <td>827.83</td>
      <td>1474811</td>
      <td>179.7</td>
      <td>2.09</td>
      <td>28.6</td>
      <td>56.49646</td>
      <td>6465840.87</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nagoya</td>
      <td>326.45</td>
      <td>2215062</td>
      <td>18.3</td>
      <td>2.17</td>
      <td>30.7</td>
      <td>115.81709</td>
      <td>13844208.98</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sapporo</td>
      <td>1121.26</td>
      <td>1880863</td>
      <td>70.2</td>
      <td>2.12</td>
      <td>28.0</td>
      <td>60.01644</td>
      <td>9892811.22</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tokyo</td>
      <td>2190.93</td>
      <td>12576611</td>
      <td>43.0</td>
      <td>2.02</td>
      <td>43.8</td>
      <td>938.04581</td>
      <td>71096920.30</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Yokohama</td>
      <td>437.49</td>
      <td>3579628</td>
      <td>37.1</td>
      <td>2.26</td>
      <td>51.5</td>
      <td>113.12382</td>
      <td>17869514.08</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sendai</td>
      <td>786.30</td>
      <td>1025126</td>
      <td>105.5</td>
      <td>2.18</td>
      <td>28.5</td>
      <td>45.30468</td>
      <td>7082098.37</td>
      <td>2016</td>
      <td>Planimetric reports on the land area of Japan, http://www.gsi.go.jp/kokusaikoryu/kokusaikoryu-e31006.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2015</td>
      <td>National Population Census, http://www.stat.go.jp/english/data/kokusei/index.html</td>
      <td>2013</td>
      <td>Housing and Land Survey, http://www.stat.go.jp/english/data/jyutaku/index.html</td>
      <td>National Accounts of Japan, http://www.esri.cao.go.jp/en/sna/menu.html</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="merge-ancillary-attributes-into-merged-emissions-dataset" class="level1">
<h1>Merge ancillary attributes into merged emissions dataset</h1>
<section id="merge-ancillary-attributes-from-creutzig-et-al." class="level2">
<h2 class="anchored" data-anchor-id="merge-ancillary-attributes-from-creutzig-et-al.">Merge ancillary attributes from Creutzig et al.</h2>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_creutzig.shape</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_emissions.shape</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_creutzig.shape[<span class="dv">1</span>] <span class="op">+</span> df_emissions.shape[<span class="dv">1</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_creutzig.shape[<span class="dv">0</span>] <span class="op">+</span> df_emissions.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(273, 40)
(343, 59)
99
616</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find columns in common</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>colList1 <span class="op">=</span> <span class="bu">list</span>(df_emissions)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>colList2 <span class="op">=</span> <span class="bu">list</span>(df_creutzig)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(colList1) <span class="op">&amp;</span> <span class="bu">set</span>(colList2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>{u'city name'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_merge1 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Add a flag to indicate that city has ancillary data from D_GEA+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>df_creutzig[<span class="st">'Ancillary from GEA+'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>df_merge1 <span class="op">=</span> pd.merge(df_emissions, df_creutzig, how<span class="op">=</span><span class="st">'left'</span>, on<span class="op">=</span>var_city)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>df_merge1.shape  <span class="co">#(343, 99)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>(343, 99)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge1.loc[(df_merge1[<span class="st">'Scope-1 source dataset'</span>]<span class="op">==</span><span class="st">'CDP'</span>) <span class="op">&amp;</span> (df_merge1[<span class="st">'Ancillary from GEA+'</span>]<span class="op">==</span><span class="dv">1</span>), var_city].count()</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_merge1.loc[(df_merge1[<span class="st">'Scope-1 source dataset'</span>]<span class="op">==</span><span class="st">'CDP'</span>) <span class="op">&amp;</span> (df_merge1[<span class="st">'Ancillary from GEA+'</span>]<span class="op">==</span><span class="dv">1</span>), var_city])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>57</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>[u'Amsterdam',
 u'Athens',
 u'Atlanta',
 u'Austin',
 u'Birmingham',
 u'Bogot\xe1',
 u'Bologna',
 u'Boulder',
 u'Bournemouth',
 u'Bras\xedlia',
 u'Calgary',
 u'Cape Town',
 u'Cardiff',
 u'Chicago',
 u'Copenhagen',
 u'Curitiba',
 u'Denver',
 u'Dublin',
 u'Greater London',
 u'Hamburg',
 u'Helsinki',
 u'Hong Kong',
 u'Houston',
 u'Jakarta',
 u'Johannesburg',
 u'Leicester',
 u'Lisbon',
 u'Ljubljana',
 u'Los Angeles',
 u'Madrid',
 u'Manchester',
 u'Melbourne',
 u'Mexico City',
 u'Milano',
 u'Minneapolis',
 u'Montreal',
 u'New York City',
 u'Oslo',
 u'Paris',
 u'Portland, OR',
 u'Pretoria Tshwane',
 u'Rio de Janeiro',
 u'Roma',
 u'San Diego',
 u'San Francisco',
 u'Seattle',
 u'Seoul',
 u'Stockholm',
 u'Sydney',
 u'Taipei City',
 u'Tokyo',
 u'Torino',
 u'Toronto',
 u'Vancouver',
 u'Vilnius',
 u'Wellington',
 u'Z\xfcrich']</code></pre>
</div>
</div>
</section>
<section id="merge-updated-ancillary-attributes-of-creutzig-dataset-for-cdp-cities" class="level2">
<h2 class="anchored" data-anchor-id="merge-updated-ancillary-attributes-of-creutzig-dataset-for-cdp-cities">Merge updated ancillary attributes of Creutzig dataset for CDP cities</h2>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge1.shape</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_filledCreutzig.shape</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge1.shape[<span class="dv">1</span>] <span class="op">+</span> df_filledCreutzig.shape[<span class="dv">1</span>] <span class="op">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 99)
(187, 16)
114</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find columns in common</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>colList1 <span class="op">=</span> <span class="bu">list</span>(df_merge1)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>colList2 <span class="op">=</span> <span class="bu">list</span>(df_filledCreutzig)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(colList1) <span class="op">&amp;</span> <span class="bu">set</span>(colList2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>{u'city name'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df_merge2 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>df_merge2 <span class="op">=</span> pd.merge(df_merge1, df_filledCreutzig, how<span class="op">=</span><span class="st">'outer'</span>, on<span class="op">=</span>var_city)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>df_merge2.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>(343, 114)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df_merge2.loc[<span class="op">~</span>df_merge2[<span class="st">'mean travel time [min] (others)'</span>].isnull(), var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>147</code></pre>
</div>
</div>
</section>
<section id="merge-fuel-prices-for-carbonn-and-pku-cities" class="level2">
<h2 class="anchored" data-anchor-id="merge-fuel-prices-for-carbonn-and-pku-cities">Merge fuel prices for carbonn and PKU cities</h2>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge2.shape</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_fuel.shape</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Number of cities missing fuel price: '</span> <span class="op">+</span>  <span class="bu">repr</span>(df_merge2.loc[df_merge2[<span class="st">'diesel_price (2014) (others)'</span>].isnull(), var_city].count())</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Number of columns after merge should be: '</span> <span class="op">+</span>  <span class="bu">repr</span>(df_merge2.shape[<span class="dv">1</span>] <span class="op">+</span> df_fuel.shape[<span class="dv">1</span>] <span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 114)
(156, 3)
Number of cities missing fuel price: 156
Number of columns after merge should be: 116</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df_merge2fuel <span class="op">=</span> pd.DataFrame()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>df_merge2fuel <span class="op">=</span> pd.merge(df_merge2, df_fuel, how<span class="op">=</span><span class="st">'outer'</span>, on<span class="op">=</span>var_city)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>df_merge2fuel.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>(343, 116)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>commonCols <span class="op">=</span> [<span class="st">'diesel_price (2014) (others)'</span>, <span class="st">'gasoline_price (2014) (others)'</span>]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>commonCols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>['diesel_price (2014) (others)', 'gasoline_price (2014) (others)']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(commonCols)): </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    attr <span class="op">=</span> commonCols[idx]</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    fn_mergeDuplicates(df_merge2fuel, attr)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'**'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="47">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge2fuel.loc[df_merge2fuel[<span class="st">'diesel_price (2014) (others)'</span>].isnull(), var_city].count()</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; check OK.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="48">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge2fuel.loc[df_merge2fuel[<span class="st">'gasoline_price (2014) (others)'</span>].isnull(), var_city]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; check OK.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series([], Name: city name, dtype: object)</code></pre>
</div>
</div>
</section>
<section id="merge-ancillary-attributes-from-external-sources-for-chinese-cities" class="level2">
<h2 class="anchored" data-anchor-id="merge-ancillary-attributes-from-external-sources-for-chinese-cities">Merge ancillary attributes from external sources for Chinese cities</h2>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge2fuel.shape</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_china_ancillary.shape</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Number of columns after merge should be: '</span> <span class="op">+</span>  <span class="bu">repr</span>(df_merge2fuel.shape[<span class="dv">1</span>] <span class="op">+</span> df_china_ancillary.shape[<span class="dv">1</span>] <span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 114)
(83, 16)
Number of columns after merge should be: 129</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_china_ancillary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>[u'city name',
 'lat (PKU)',
 'lon (PKU)',
 u'population (others)',
 u'population (others) source year',
 u'population (others) source',
 u'area [km2] (others)',
 u'area [km2] (others) source year',
 u'area [km2] (others) source',
 u'GDP-PPP [$BN] (others)',
 u'GDP-PPP year (others)',
 u'GDP-PPP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others) source',
 u'nGDP [$BN] (others)',
 u'nGDP/cap [$USD] (others)',
 u'nGDP [$BN] (others) source']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find columns in common</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>colList1 <span class="op">=</span> <span class="bu">list</span>(df_merge2)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>colList2 <span class="op">=</span> <span class="bu">list</span>(df_china_ancillary)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>commonCols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(colList1) <span class="op">&amp;</span> <span class="bu">set</span>(colList2)) <span class="co">#=&gt; 7 common column1 therefore merged df should have 116 -7 = 109 columns, 343 cities</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>commonCols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>[u'population (others) source year',
 u'area [km2] (others)',
 u'population (others)',
 u'area [km2] (others) source year',
 u'area [km2] (others) source',
 u'city name',
 u'population (others) source']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df_merge3 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>df_merge3 <span class="op">=</span> pd.merge(df_merge2fuel, df_china_ancillary, how<span class="op">=</span><span class="st">'left'</span>, on<span class="op">=</span>var_city)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>df_merge3.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>(343, 129)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(commonCols)): </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    attr <span class="op">=</span> commonCols[idx]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> attr <span class="op">!=</span> var_city:</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>        fn_mergeDuplicates(df_merge3, attr)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'**'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**</code></pre>
</div>
</div>
</section>
<section id="merge-external-gdp-data" class="level2">
<h2 class="anchored" data-anchor-id="merge-external-gdp-data">Merge external GDP data</h2>
<section id="gdp-data-for-cdp" class="level3">
<h3 class="anchored" data-anchor-id="gdp-data-for-cdp">GDP data for CDP</h3>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge3.shape</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_gdp_cdp.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 123)
(187, 9)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_gdp_cdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>[u'city name',
 u'GDP-PPP [$BN] (others)',
 u'GDP-PPP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others) source',
 u'GDP-PPP year (others)',
 u'nGDP [$BN] (others)',
 u'nGDP/cap [$USD] (others)',
 u'nGDP [$BN] (others) source',
 u'nGDP [$BN] (others) source year']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find columns in common</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>colList1 <span class="op">=</span> <span class="bu">list</span>(df_merge3)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>colList2 <span class="op">=</span> <span class="bu">list</span>(df_gdp_cdp)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>commonCols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(colList1) <span class="op">&amp;</span> <span class="bu">set</span>(colList2)) <span class="co">#=&gt; 1 common column1 therefore merged df should have 117 -1 = 116 columns, 343 cities</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>commonCols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>[u'nGDP [$BN] (others)',
 u'GDP-PPP year (others)',
 u'GDP-PPP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others)',
 u'city name',
 u'nGDP [$BN] (others) source',
 u'nGDP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others) source']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find columns in common</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>colList1 <span class="op">=</span> <span class="bu">list</span>(df_merge3)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>colList2 <span class="op">=</span> <span class="bu">list</span>(df_gdp_cdp)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>commonCols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(colList1) <span class="op">&amp;</span> <span class="bu">set</span>(colList2)) <span class="co">#=&gt; 1 common column1 therefore merged df should have 117 -1 = 116 columns, 343 cities</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>commonCols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>[u'nGDP [$BN] (others)',
 u'GDP-PPP year (others)',
 u'GDP-PPP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others)',
 u'city name',
 u'nGDP [$BN] (others) source',
 u'nGDP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others) source']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'Number of columns after merge should be: '</span> <span class="op">+</span>  <span class="bu">repr</span>(df_merge3.shape[<span class="dv">1</span>] <span class="op">+</span> df_gdp_cdp.shape[<span class="dv">1</span>] <span class="op">-</span><span class="bu">len</span>(commonCols))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of columns after merge should be: 124</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>df_merge4 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>df_merge4 <span class="op">=</span> pd.merge(df_merge3, df_gdp_cdp, how<span class="op">=</span><span class="st">'left'</span>, on<span class="op">=</span>var_city)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>df_merge4.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>(343, 131)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(commonCols)): </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    attr <span class="op">=</span> commonCols[idx]</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> attr <span class="op">!=</span> var_city:</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>        fn_mergeDuplicates(df_merge4, attr)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'**'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge4.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 124)</code></pre>
</div>
</div>
</section>
<section id="gdp-ancillary-data-for-carbonn-subset" class="level3">
<h3 class="anchored" data-anchor-id="gdp-ancillary-data-for-carbonn-subset">GDP + ancillary data for carbonn subset</h3>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge4.shape</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_carbonn.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 124)
(73, 18)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find columns in common</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>colList1 <span class="op">=</span> <span class="bu">list</span>(df_merge4)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>colList2 <span class="op">=</span> <span class="bu">list</span>(df_carbonn)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>commonCols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(colList1) <span class="op">&amp;</span> <span class="bu">set</span>(colList2) )</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>commonCols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>[u'population (others) source year',
 u'area [km2] (others)',
 u'population (others)',
 u'nGDP [$BN] (others)',
 u'GDP-PPP year (others)',
 u'GDP-PPP/cap [$USD] (others)',
 u'GDP-PPP [$BN] (others)',
 u'area [km2] (others) source year',
 u'area [km2] (others) source',
 u'city name',
 u'nGDP [$BN] (others) source',
 u'GDP-PPP [$BN] (others) source',
 u'population (others) source',
 u'nGDP/cap [$USD] (others)',
 u'nGDP [$BN] (others) source year']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#new columns to be added to merge</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>newCols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(colList2)<span class="op">-</span><span class="bu">set</span>(colList1))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> newCols</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[u'Year_Household size', u'Household_source', u'Household_size']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>df_merge5 <span class="op">=</span> pd.DataFrame()</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>df_merge5 <span class="op">=</span> pd.merge(df_merge4, df_carbonn, on<span class="op">=</span>var_city, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge5.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 141)</code></pre>
</div>
</div>
<section id="consolidate-duplicate-columns-keep-non-nan-value" class="level4">
<h4 class="anchored" data-anchor-id="consolidate-duplicate-columns-keep-non-nan-value">Consolidate duplicate columns (keep non-nan value)</h4>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(commonCols)): </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    attr <span class="op">=</span> commonCols[idx]</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> attr <span class="op">!=</span> var_city:</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>        fn_mergeDuplicates(df_merge5, attr)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">'**'</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge5.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>**
(343, 127)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reorder first instances of GDP ref</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#nGDP</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[df_merge5[var_city]<span class="op">==</span><span class="st">'Ahmedabad'</span>,<span class="st">'nGDP [$BN] (others) source'</span>] <span class="op">=</span> <span class="st">'[3] The Most Dynamic Cities of 2025. Foreign Policy. Retrieved 24/08/2012. http://foreignpolicy.com/2012/08/07/the-most-dynamic-cities-of-2025/,</span><span class="ch">\n</span><span class="st">[19] Global Cities of the Future. Dynamic map. McKinsey&amp;CompacKinsey Global Institute City Scope v2.0 Last updated June 2012. Retrieved 27/09/2017. Available at: http://www.mckinsey.com/tools/Wrappers/Redesign/InteractiveWrapper.aspx?sc_itemid={C84CB74F-A3B1-47B1-8265-6252F6D85B68}'</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[df_merge5[var_city]<span class="op">==</span><span class="st">'Beijing'</span>,<span class="st">'nGDP [$BN] (others) source'</span>] <span class="op">=</span> <span class="st">'[3], [19]'</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[df_merge5[var_city]<span class="op">==</span><span class="st">'Boston'</span>,<span class="st">'nGDP [$BN] (others) source'</span>] <span class="op">=</span> <span class="st">'[19]'</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[df_merge5[var_city]<span class="op">==</span><span class="st">'Hong Kong'</span>,<span class="st">'nGDP [$BN] (others) source'</span>] <span class="op">=</span> <span class="st">'[3]'</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co">#GDP-PPP</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[df_merge5[var_city]<span class="op">==</span><span class="st">'Ahmedabad'</span>,<span class="st">'GDP-PPP [$BN] (others) source'</span>] <span class="op">=</span> <span class="st">'[2]'</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[df_merge5[var_city]<span class="op">==</span><span class="st">'Tianjin'</span>,<span class="st">'GDP-PPP [$BN] (others) source'</span>] <span class="op">=</span> <span class="st">'[1]'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compare-household-size-data-from-creutzig-et.-al-with-external-source-manually-collected-for-carbonn-cities-in-creutzig-et-al." class="level4">
<h4 class="anchored" data-anchor-id="compare-household-size-data-from-creutzig-et.-al-with-external-source-manually-collected-for-carbonn-cities-in-creutzig-et-al.">compare household size data from Creutzig et. al with external source manually collected for carbonn cities in Creutzig et al.</h4>
<p>From Creutzig et al: * ‘household_size (GEA|UITP|WB)’, * ‘year_household_size (GEA|UITP|WB)’, * ‘household_source (GEA|UITP|WB)’, * ‘comment_household_size (GEA|UITP|WB)’</p>
<p>From external sources manually collected for carbonn cities in Creutzig et al.&nbsp;(but not in CDP):<br>
* ‘Household_size’, * ‘Year_Household size’, * ‘Household_source’,</p>
<p>From external sources manually collected for CDP cities in Creutzig et al.:<br>
* ‘household_size (updated) (external)’, * ‘year_household_size (updated) (external)’, * ‘household_source (updated) (external)’, * ‘comment_household_size (updated) (external)’,</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[<span class="op">~</span>df_merge5[<span class="st">'Year_Household size'</span>].isnull(), [var_city, <span class="st">'Year_Household size'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Year_Household size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Bangalore</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Bristol</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Brussels</td>
      <td>2014</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Buffalo City</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Ekurhuleni</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Fort Collins</td>
      <td>2012-2016</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Graz</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Gävle</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Istanbul</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Kyoto</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>180</th>
      <td>Lyon</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Msunduzi</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>201</th>
      <td>Nantes</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>203</th>
      <td>Nelson Mandela</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>262</th>
      <td>Sapporo</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>275</th>
      <td>Singapore</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>301</th>
      <td>Umeå</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>303</th>
      <td>Uppsala</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>308</th>
      <td>Växjö</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>339</th>
      <td>eThekwini</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>2017</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#household size data for carbonn_venn cities missing from Creutzig can be put into external columns</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> <span class="op">~</span>df_merge5[<span class="st">'Year_Household size'</span>].isnull() <span class="co">#external for carbonn_venn cities</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> df_merge5[<span class="st">'year_household_size (GEA+)'</span>].isnull()</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[cond1 <span class="op">&amp;</span> cond2, </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>[var_city,<span class="st">'Measurement year only (CDP)'</span>,<span class="st">'Scope 1 year'</span>, <span class="st">'Year_Household size'</span>, </span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'year_household_size (updated) (others)'</span>, <span class="st">'year_household_size (GEA+)'</span>]</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>var_hh <span class="op">=</span> <span class="st">'household_size (updated) (others)'</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>var_hh_yr <span class="op">=</span> <span class="st">'year_household_size (updated) (others)'</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>var_hh_source <span class="op">=</span> <span class="st">'household_source (updated) (others)'</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>cityList <span class="op">=</span> <span class="bu">list</span>(df_merge5.loc[cond1 <span class="op">&amp;</span> cond2,var_city])</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> cityList</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cityList)):</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> cityList[idx]</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    df_merge5.loc[df_merge5[var_city] <span class="op">==</span> cityList[idx], var_hh] <span class="op">=</span> df_merge5[<span class="st">'Household_size'</span>]</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>    df_merge5.loc[df_merge5[var_city] <span class="op">==</span> cityList[idx], var_hh_yr] <span class="op">=</span> df_merge5[<span class="st">'Year_Household size'</span>]</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>    df_merge5.loc[df_merge5[var_city] <span class="op">==</span> cityList[idx], var_hh_source] <span class="op">=</span> df_merge5[<span class="st">'Household_source'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[u'Fort Collins', u'Graz', u'Kyoto', u'Sapporo']
Fort Collins
Graz
Kyoto
Sapporo</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[cond1 <span class="op">&amp;</span> cond2, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>[var_city,<span class="st">'Measurement year only (CDP)'</span>,<span class="st">'Year of Emission'</span>, <span class="st">'Year_Household size'</span>, </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'year_household_size (updated) (others)'</span>, <span class="st">'year_household_size (GEA+)'</span>]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; OK</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Measurement year only (CDP)</th>
      <th>Year of Emission</th>
      <th>Year_Household size</th>
      <th>year_household_size (updated) (others)</th>
      <th>year_household_size (GEA+)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Fort Collins</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>2012-2016</td>
      <td>2012-2016</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>100</th>
      <td>Graz</td>
      <td>NaN</td>
      <td>1994.0</td>
      <td>2013</td>
      <td>2013</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Kyoto</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2018</td>
      <td>2018</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>262</th>
      <td>Sapporo</td>
      <td>NaN</td>
      <td>2014.0</td>
      <td>2018</td>
      <td>2018</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For the remaining, keep household size data whose year is closest to emissions year</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> <span class="op">~</span>df_merge5[<span class="st">'Year_Household size'</span>].isnull()</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> <span class="op">~</span>df_merge5[<span class="st">'year_household_size (GEA+)'</span>].isnull()</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>df_tmp <span class="op">=</span> df_merge5.loc[cond1 <span class="op">&amp;</span> cond2, </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    [var_city,<span class="st">'Measurement year only (CDP)'</span>,<span class="st">'Year of Emission'</span>, <span class="st">'Year_Household size'</span>, <span class="st">'year_household_size (GEA+)'</span>]</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>df_tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Measurement year only (CDP)</th>
      <th>Year of Emission</th>
      <th>Year_Household size</th>
      <th>year_household_size (GEA+)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>2011</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Bangalore</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>2011</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2014</td>
      <td>2004.0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Bristol</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2013</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Brussels</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2014</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Buffalo City</td>
      <td>NaN</td>
      <td>2007.0</td>
      <td>2007</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Ekurhuleni</td>
      <td>NaN</td>
      <td>2014.0</td>
      <td>2007</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Gävle</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2017</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Istanbul</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2016</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>180</th>
      <td>Lyon</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2012</td>
      <td>2009.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Msunduzi</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2007</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>201</th>
      <td>Nantes</td>
      <td>NaN</td>
      <td>2003.0</td>
      <td>2012</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>203</th>
      <td>Nelson Mandela</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2007</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>275</th>
      <td>Singapore</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2016</td>
      <td>2010</td>
    </tr>
    <tr>
      <th>301</th>
      <td>Umeå</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>2017</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>303</th>
      <td>Uppsala</td>
      <td>NaN</td>
      <td>2014.0</td>
      <td>2017</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>308</th>
      <td>Växjö</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>2017</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>339</th>
      <td>eThekwini</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2007</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>2011.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> <span class="bu">abs</span>(df_tmp[<span class="st">'Year_Household size'</span>].astype(<span class="bu">float</span>).values <span class="op">-</span> df_tmp[<span class="st">'Year of Emission'</span>].values)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> <span class="bu">abs</span>(df_tmp[<span class="st">'year_household_size (GEA+)'</span>].astype(<span class="bu">float</span>).values <span class="op">-</span> df_tmp[<span class="st">'Year of Emission'</span>].astype(<span class="bu">int</span>).values)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>df_tmp.loc[cond1 <span class="op">&lt;</span> cond2, </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>           [var_city,<span class="st">'Measurement year only (CDP)'</span>,<span class="st">'Year of Emission'</span>, <span class="st">'Year_Household size'</span>, </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'year_household_size (GEA+)'</span>]</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Measurement year only (CDP)</th>
      <th>Year of Emission</th>
      <th>Year_Household size</th>
      <th>year_household_size (GEA+)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2014</td>
      <td>2004.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Buffalo City</td>
      <td>NaN</td>
      <td>2007.0</td>
      <td>2007</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Istanbul</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2016</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>2011.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Conclusion: replace (GEA+) household size data for the four cities found above:</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>cityList <span class="op">=</span> <span class="bu">list</span>(df_tmp.loc[cond1 <span class="op">&lt;</span> cond2, var_city] )</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> cityList</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>var_hh <span class="op">=</span> <span class="st">'household_size (updated) (others)'</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>var_hh_yr <span class="op">=</span> <span class="st">'year_household_size (updated) (others)'</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>var_hh_source <span class="op">=</span> <span class="st">'household_source (updated) (others)'</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(cityList)):</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    df_merge5.loc[df_merge5[var_city] <span class="op">==</span> cityList[idx], var_hh] <span class="op">=</span> df_merge5[<span class="st">'Household_size'</span>]</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    df_merge5.loc[df_merge5[var_city] <span class="op">==</span> cityList[idx], var_hh_yr] <span class="op">=</span> df_merge5[<span class="st">'Year_Household size'</span>]</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    df_merge5.loc[df_merge5[var_city] <span class="op">==</span> cityList[idx], var_hh_source] <span class="op">=</span> df_merge5[<span class="st">'Household_source'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[u'Barcelona', u'Buffalo City', u'Istanbul', u'\xd6rebro']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>cond1 <span class="op">=</span> <span class="op">~</span>df_merge5[<span class="st">'Year_Household size'</span>].isnull()</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>cond2 <span class="op">=</span> <span class="op">~</span>df_merge5[<span class="st">'year_household_size (GEA+)'</span>].isnull()</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[cond1 <span class="op">&amp;</span> cond2, </span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>[var_city,<span class="st">'Measurement year only (CDP)'</span>,<span class="st">'Year of Emission'</span>, <span class="st">'Year_Household size'</span>, </span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'year_household_size (updated) (others)'</span>, <span class="st">'year_household_size (GEA+)'</span>]</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; OK</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Measurement year only (CDP)</th>
      <th>Year of Emission</th>
      <th>Year_Household size</th>
      <th>year_household_size (updated) (others)</th>
      <th>year_household_size (GEA+)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Ahmedabad</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>2011</td>
      <td>NaN</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Bangalore</td>
      <td>NaN</td>
      <td>2008.0</td>
      <td>2011</td>
      <td>NaN</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Barcelona</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2014</td>
      <td>2014</td>
      <td>2004.0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Bristol</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2013</td>
      <td>NaN</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Brussels</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2014</td>
      <td>NaN</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Buffalo City</td>
      <td>NaN</td>
      <td>2007.0</td>
      <td>2007</td>
      <td>2007</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Ekurhuleni</td>
      <td>NaN</td>
      <td>2014.0</td>
      <td>2007</td>
      <td>NaN</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>106</th>
      <td>Gävle</td>
      <td>NaN</td>
      <td>2011.0</td>
      <td>2017</td>
      <td>NaN</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>Istanbul</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2016</td>
      <td>2016</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>180</th>
      <td>Lyon</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2012</td>
      <td>NaN</td>
      <td>2009.0</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Msunduzi</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2007</td>
      <td>NaN</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>201</th>
      <td>Nantes</td>
      <td>NaN</td>
      <td>2003.0</td>
      <td>2012</td>
      <td>NaN</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>203</th>
      <td>Nelson Mandela</td>
      <td>NaN</td>
      <td>2012.0</td>
      <td>2007</td>
      <td>NaN</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>275</th>
      <td>Singapore</td>
      <td>NaN</td>
      <td>2010.0</td>
      <td>2016</td>
      <td>NaN</td>
      <td>2010</td>
    </tr>
    <tr>
      <th>301</th>
      <td>Umeå</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>2017</td>
      <td>NaN</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>303</th>
      <td>Uppsala</td>
      <td>NaN</td>
      <td>2014.0</td>
      <td>2017</td>
      <td>NaN</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>308</th>
      <td>Växjö</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>2017</td>
      <td>NaN</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>339</th>
      <td>eThekwini</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2007</td>
      <td>NaN</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>341</th>
      <td>Örebro</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>2017</td>
      <td>2017</td>
      <td>2011.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop household size columns from df_carbonn_venn that are now no longer needed</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>df_merge5.drop(<span class="st">'Household_size'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>df_merge5.drop(<span class="st">'Year_Household size'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>df_merge5.drop(<span class="st">'Household_source'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge5.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 124)</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="merge-ancillary-attributes-from-neis-dataset" class="level1">
<h1>Merge ancillary attributes from NEIS dataset</h1>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compare_colValues(df_master, df_new, city_names, col_names):</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Compare values for same attribute"""</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> city <span class="kw">in</span> city_names:</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> col_names:</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>            m <span class="op">=</span> df_master.loc[df_master[var_city]<span class="op">==</span>city, col].tolist()[<span class="dv">0</span>]</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>            new <span class="op">=</span> df_new.loc[df_new[var_city]<span class="op">==</span>city, col].tolist()[<span class="dv">0</span>]</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span> city <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> <span class="bu">repr</span>(col) <span class="op">+</span> <span class="st">': '</span> <span class="op">+</span> <span class="bu">repr</span>(m) <span class="op">+</span> <span class="st">' (master)'</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span> city <span class="op">+</span> <span class="st">' '</span> <span class="op">+</span> <span class="bu">repr</span>(col) <span class="op">+</span> <span class="st">': '</span> <span class="op">+</span> <span class="bu">repr</span>(new) <span class="op">+</span> <span class="st">' (new)'</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span> <span class="st">''</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span> <span class="st">'----------------------------------------------------------'</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     return df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_colValues(df_master, df_new, city_names, col_names):</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">""" Fill values of df_master with values from df_new for given attribute"""</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> city <span class="kw">in</span> city_names:</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> col_names:           </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>            new <span class="op">=</span> df_new.loc[df_new[var_city]<span class="op">==</span>city, col].tolist()[<span class="dv">0</span>]</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>            df_master.loc[df_master[var_city]<span class="op">==</span>city, col] <span class="op">=</span> new</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df_master</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>df_japan.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>(7, 18)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Compare external values with those values already obtained</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>cdp_cityList <span class="op">=</span> <span class="bu">list</span>(df_emissions.loc[df_emissions[<span class="st">'country'</span>].<span class="bu">str</span>.contains(<span class="st">'Japan'</span>), var_city])</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>cdppattern <span class="op">=</span> <span class="st">'|'</span>.join(cdp_cityList)</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>cdppattern</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>u'Hiroshima|Kyoto|Nagoya|Okayama|Osaka|Sapporo|Sendai|Tokyo|Yokohama'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cities in common with CDP</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_japan.loc[df_japan[var_city].<span class="bu">str</span>.contains(cdppattern), var_city].count()</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>venn_japan <span class="op">=</span> df_japan.loc[df_japan[var_city].<span class="bu">str</span>.contains(cdppattern), var_city].tolist()</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> venn_japan</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; All 7 cities in df_japan are in CDP.</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; Osaka in CDP is not in df_japan; Okayama was removed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7
[u'Hiroshima', u'Kyoto', u'Nagoya', u'Sapporo', u'Tokyo', u'Yokohama', u'Sendai']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> [<span class="st">'Average altitude (m)'</span>,<span class="st">'area [km2] (others)'</span>, <span class="st">'population (others)'</span>, <span class="st">'household_size (updated) (others)'</span>, <span class="st">'mean travel time [min] (others)'</span>]</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>compare_colValues(df_merge5, df_japan, venn_japan, col_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hiroshima 'Average altitude (m)': nan (master)
Hiroshima 'Average altitude (m)': 165.6 (new)

Hiroshima 'area [km2] (others)': 906.53 (master)
Hiroshima 'area [km2] (others)': 906.53 (new)

Hiroshima 'population (others)': 1196274.0 (master)
Hiroshima 'population (others)': 1154391 (new)

Hiroshima 'household_size (updated) (others)': 2.21 (master)
Hiroshima 'household_size (updated) (others)': 2.25 (new)

Hiroshima 'mean travel time [min] (others)': 30.9 (master)
Hiroshima 'mean travel time [min] (others)': 27.9 (new)

----------------------------------------------------------
Kyoto 'Average altitude (m)': nan (master)
Kyoto 'Average altitude (m)': 179.7 (new)

Kyoto 'area [km2] (others)': 827.83 (master)
Kyoto 'area [km2] (others)': 827.83 (new)

Kyoto 'population (others)': 1475183.0 (master)
Kyoto 'population (others)': 1474811 (new)

Kyoto 'household_size (updated) (others)': 2.05 (master)
Kyoto 'household_size (updated) (others)': 2.09 (new)

Kyoto 'mean travel time [min] (others)': nan (master)
Kyoto 'mean travel time [min] (others)': 28.6 (new)

----------------------------------------------------------
Nagoya 'Average altitude (m)': nan (master)
Nagoya 'Average altitude (m)': 18.3 (new)

Nagoya 'area [km2] (others)': 326.43 (master)
Nagoya 'area [km2] (others)': 326.45 (new)

Nagoya 'population (others)': 2283289.0 (master)
Nagoya 'population (others)': 2215062 (new)

Nagoya 'household_size (updated) (others)': 2.13 (master)
Nagoya 'household_size (updated) (others)': 2.17 (new)

Nagoya 'mean travel time [min] (others)': nan (master)
Nagoya 'mean travel time [min] (others)': 30.7 (new)

----------------------------------------------------------
Sapporo 'Average altitude (m)': nan (master)
Sapporo 'Average altitude (m)': 70.2 (new)

Sapporo 'area [km2] (others)': 1121.12 (master)
Sapporo 'area [km2] (others)': 1121.26 (new)

Sapporo 'population (others)': 1947097.0 (master)
Sapporo 'population (others)': 1880863 (new)

Sapporo 'household_size (updated) (others)': 2.08 (master)
Sapporo 'household_size (updated) (others)': 2.12 (new)

Sapporo 'mean travel time [min] (others)': nan (master)
Sapporo 'mean travel time [min] (others)': 28.0 (new)

----------------------------------------------------------
Tokyo 'Average altitude (m)': nan (master)
Tokyo 'Average altitude (m)': 43.0 (new)

Tokyo 'area [km2] (others)': 2191.0 (master)
Tokyo 'area [km2] (others)': 2190.93 (new)

Tokyo 'population (others)': 13513734.0 (master)
Tokyo 'population (others)': 12576611 (new)

Tokyo 'household_size (updated) (others)': 1.99 (master)
Tokyo 'household_size (updated) (others)': 2.02 (new)

Tokyo 'mean travel time [min] (others)': 34.8 (master)
Tokyo 'mean travel time [min] (others)': 43.8 (new)

----------------------------------------------------------
Yokohama 'Average altitude (m)': 39.0 (master)
Yokohama 'Average altitude (m)': 37.1 (new)

Yokohama 'area [km2] (others)': 437.0 (master)
Yokohama 'area [km2] (others)': 437.49 (new)

Yokohama 'population (others)': 3720000.0 (master)
Yokohama 'population (others)': 3579628 (new)

Yokohama 'household_size (updated) (others)': 2.23 (master)
Yokohama 'household_size (updated) (others)': 2.26 (new)

Yokohama 'mean travel time [min] (others)': nan (master)
Yokohama 'mean travel time [min] (others)': 51.5 (new)

----------------------------------------------------------
Sendai 'Average altitude (m)': nan (master)
Sendai 'Average altitude (m)': 105.5 (new)

Sendai 'area [km2] (others)': 786.3 (master)
Sendai 'area [km2] (others)': 786.3 (new)

Sendai 'population (others)': 1086012.0 (master)
Sendai 'population (others)': 1025126 (new)

Sendai 'household_size (updated) (others)': nan (master)
Sendai 'household_size (updated) (others)': 2.18 (new)

Sendai 'mean travel time [min] (others)': nan (master)
Sendai 'mean travel time [min] (others)': 28.5 (new)

----------------------------------------------------------</code></pre>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>df_merge5.loc[(df_merge5[<span class="st">'country'</span>]<span class="op">==</span><span class="st">'Japan'</span>), [var_city, <span class="st">'mean travel time [min] (others)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>mean travel time [min] (others)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>122</th>
      <td>Hiroshima</td>
      <td>30.9</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Kyoto</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>195</th>
      <td>Nagoya</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Okayama</td>
      <td>28.6</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Osaka</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>262</th>
      <td>Sapporo</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>267</th>
      <td>Sendai</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>291</th>
      <td>Tokyo</td>
      <td>34.8</td>
    </tr>
    <tr>
      <th>329</th>
      <td>Yokohama</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="manually-fill-in-values-with-values-from-dnies" class="level2">
<h2 class="anchored" data-anchor-id="manually-fill-in-values-with-values-from-dnies">Manually fill in values with values from D<sup>NIES</sup></h2>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> [<span class="st">'Average altitude (m)'</span>,<span class="st">'area [km2] (others)'</span>, <span class="st">'population (others)'</span>, <span class="st">'household_size (updated) (others)'</span>, <span class="st">'mean travel time [min] (others)'</span>]</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>fill_colValues(df_merge5, df_japan, venn_japan, col_names)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Check:</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>compare_colValues(df_merge5, df_japan, venn_japan, col_names)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Hiroshima 'Average altitude (m)': 165.6 (master)
Hiroshima 'Average altitude (m)': 165.6 (new)

Hiroshima 'area [km2] (others)': 906.53 (master)
Hiroshima 'area [km2] (others)': 906.53 (new)

Hiroshima 'population (others)': 1154391.0 (master)
Hiroshima 'population (others)': 1154391 (new)

Hiroshima 'household_size (updated) (others)': 2.25 (master)
Hiroshima 'household_size (updated) (others)': 2.25 (new)

Hiroshima 'mean travel time [min] (others)': 27.9 (master)
Hiroshima 'mean travel time [min] (others)': 27.9 (new)

----------------------------------------------------------
Kyoto 'Average altitude (m)': 179.7 (master)
Kyoto 'Average altitude (m)': 179.7 (new)

Kyoto 'area [km2] (others)': 827.83 (master)
Kyoto 'area [km2] (others)': 827.83 (new)

Kyoto 'population (others)': 1474811.0 (master)
Kyoto 'population (others)': 1474811 (new)

Kyoto 'household_size (updated) (others)': 2.09 (master)
Kyoto 'household_size (updated) (others)': 2.09 (new)

Kyoto 'mean travel time [min] (others)': 28.6 (master)
Kyoto 'mean travel time [min] (others)': 28.6 (new)

----------------------------------------------------------
Nagoya 'Average altitude (m)': 18.3 (master)
Nagoya 'Average altitude (m)': 18.3 (new)

Nagoya 'area [km2] (others)': 326.45 (master)
Nagoya 'area [km2] (others)': 326.45 (new)

Nagoya 'population (others)': 2215062.0 (master)
Nagoya 'population (others)': 2215062 (new)

Nagoya 'household_size (updated) (others)': 2.17 (master)
Nagoya 'household_size (updated) (others)': 2.17 (new)

Nagoya 'mean travel time [min] (others)': 30.7 (master)
Nagoya 'mean travel time [min] (others)': 30.7 (new)

----------------------------------------------------------
Sapporo 'Average altitude (m)': 70.2 (master)
Sapporo 'Average altitude (m)': 70.2 (new)

Sapporo 'area [km2] (others)': 1121.26 (master)
Sapporo 'area [km2] (others)': 1121.26 (new)

Sapporo 'population (others)': 1880863.0 (master)
Sapporo 'population (others)': 1880863 (new)

Sapporo 'household_size (updated) (others)': 2.12 (master)
Sapporo 'household_size (updated) (others)': 2.12 (new)

Sapporo 'mean travel time [min] (others)': 28.0 (master)
Sapporo 'mean travel time [min] (others)': 28.0 (new)

----------------------------------------------------------
Tokyo 'Average altitude (m)': 43.0 (master)
Tokyo 'Average altitude (m)': 43.0 (new)

Tokyo 'area [km2] (others)': 2190.93 (master)
Tokyo 'area [km2] (others)': 2190.93 (new)

Tokyo 'population (others)': 12576611.0 (master)
Tokyo 'population (others)': 12576611 (new)

Tokyo 'household_size (updated) (others)': 2.02 (master)
Tokyo 'household_size (updated) (others)': 2.02 (new)

Tokyo 'mean travel time [min] (others)': 43.8 (master)
Tokyo 'mean travel time [min] (others)': 43.8 (new)

----------------------------------------------------------
Yokohama 'Average altitude (m)': 37.1 (master)
Yokohama 'Average altitude (m)': 37.1 (new)

Yokohama 'area [km2] (others)': 437.49 (master)
Yokohama 'area [km2] (others)': 437.49 (new)

Yokohama 'population (others)': 3579628.0 (master)
Yokohama 'population (others)': 3579628 (new)

Yokohama 'household_size (updated) (others)': 2.26 (master)
Yokohama 'household_size (updated) (others)': 2.26 (new)

Yokohama 'mean travel time [min] (others)': 51.5 (master)
Yokohama 'mean travel time [min] (others)': 51.5 (new)

----------------------------------------------------------
Sendai 'Average altitude (m)': 105.5 (master)
Sendai 'Average altitude (m)': 105.5 (new)

Sendai 'area [km2] (others)': 786.3 (master)
Sendai 'area [km2] (others)': 786.3 (new)

Sendai 'population (others)': 1025126.0 (master)
Sendai 'population (others)': 1025126 (new)

Sendai 'household_size (updated) (others)': 2.18 (master)
Sendai 'household_size (updated) (others)': 2.18 (new)

Sendai 'mean travel time [min] (others)': 28.5 (master)
Sendai 'mean travel time [min] (others)': 28.5 (new)

----------------------------------------------------------</code></pre>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge5.loc[<span class="op">~</span>df_merge5[<span class="st">'mean travel time [min] (others)'</span>].isnull(), var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>152</code></pre>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>cname<span class="op">=</span><span class="st">'Nagoya'</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>s1_cdp <span class="op">=</span> df_emissions.loc[df_emissions[var_city]<span class="op">==</span>cname, <span class="st">'Scope-1 GHG emissions'</span>]</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>s1_japan <span class="op">=</span> df_japan.loc[df_japan[var_city]<span class="op">==</span>cname, <span class="st">'Scope 1 [tCO2]'</span>]</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_cdp</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_japan</span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">float</span>(s1_cdp)<span class="op">/</span><span class="bu">float</span>(s1_japan ) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>195    7690000.0
Name: Scope-1 GHG emissions, dtype: float64
2    13844208.98
Name: Scope 1 [tCO2], dtype: float64

55.5466911191</code></pre>
</div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>cname<span class="op">=</span><span class="st">'Kyoto'</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>s1_cdp <span class="op">=</span> df_emissions.loc[df_emissions[var_city]<span class="op">==</span>cname, <span class="st">'Scope-1 GHG emissions'</span>]</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>s1_japan <span class="op">=</span> df_japan.loc[df_japan[var_city]<span class="op">==</span>cname, <span class="st">'Scope 1 [tCO2]'</span>]</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_cdp</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_japan</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">float</span>(s1_cdp)<span class="op">/</span><span class="bu">float</span>(s1_japan ) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>157    7684000.0
Name: Scope-1 GHG emissions, dtype: float64
1    6465840.87
Name: Scope 1 [tCO2], dtype: float64

118.839918187</code></pre>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#CDP does not have Scope 1 for Hiroshima</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>cname<span class="op">=</span><span class="st">'Hiroshima'</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>df_emissions.loc[df_emissions[var_city]<span class="op">==</span>cname, [<span class="st">'Scope-1 GHG emissions'</span>, <span class="st">'Scope 2 [metric ton CO2e] (CDP)'</span>, <span class="st">'Total Emissions [metric ton CO2e] (CDP)'</span>] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Scope-1 GHG emissions</th>
      <th>Scope 2 [metric ton CO2e] (CDP)</th>
      <th>Total Emissions [metric ton CO2e] (CDP)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>122</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8675437.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>cname<span class="op">=</span><span class="st">'Yokohama'</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>s1_cdp <span class="op">=</span> df_emissions.loc[df_emissions[var_city]<span class="op">==</span>cname, <span class="st">'Scope-1 GHG emissions'</span>]</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>s1_japan <span class="op">=</span> df_japan.loc[df_japan[var_city]<span class="op">==</span>cname, <span class="st">'Scope 1 [tCO2]'</span>]</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_cdp</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_japan</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">float</span>(s1_cdp)<span class="op">/</span><span class="bu">float</span>(s1_japan ) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>329    12572000.0
Name: Scope-1 GHG emissions, dtype: float64
5    17869514.08
Name: Scope 1 [tCO2], dtype: float64

70.3544592411</code></pre>
</div>
</div>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>cname<span class="op">=</span><span class="st">'Tokyo'</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>s1_cdp <span class="op">=</span> df_emissions.loc[df_emissions[var_city]<span class="op">==</span>cname, <span class="st">'Scope-1 GHG emissions'</span>]</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>s1_japan <span class="op">=</span> df_japan.loc[df_japan[var_city]<span class="op">==</span>cname, <span class="st">'Scope 1 [tCO2]'</span>]</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_cdp</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_japan</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">float</span>(s1_cdp)<span class="op">/</span><span class="bu">float</span>(s1_japan ) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>291    27611000.0
Name: Scope-1 GHG emissions, dtype: float64
4    71096920.3
Name: Scope 1 [tCO2], dtype: float64

38.8357187393</code></pre>
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>cname<span class="op">=</span><span class="st">'Sapporo'</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>s1_cdp <span class="op">=</span> df_emissions.loc[df_emissions[var_city]<span class="op">==</span>cname, <span class="st">'Scope-1 GHG emissions'</span>]</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>s1_japan <span class="op">=</span> df_japan.loc[df_japan[var_city]<span class="op">==</span>cname, <span class="st">'Scope 1 [tCO2]'</span>]</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_cdp</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> s1_japan</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="st">''</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">float</span>(s1_cdp)<span class="op">/</span><span class="bu">float</span>(s1_japan ) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>262    13024847.61
Name: Scope-1 GHG emissions, dtype: float64
3    9892811.22
Name: Scope 1 [tCO2], dtype: float64

131.659720582</code></pre>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>df_japan <span class="op">=</span> df_japan.drop(<span class="st">'Scope 1 [tCO2]'</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="merge-ancillary-attributes-from-traffic-datasets" class="level1">
<h1>Merge ancillary attributes from Traffic datasets</h1>
<section id="inrix" class="level2">
<h2 class="anchored" data-anchor-id="inrix">INRIX</h2>
<p>Note: The following cities are NOT in INRIX: * North Vancouver * London, ON</p>
<p><strong>118 cities in INRIX overlap with D<sup>emissions</sup>.</strong></p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>f_inrix <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/INRIX_2016_Traffic_Scorecard_Appendix_EN_TableA2.xlsx'</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>df_inrix <span class="op">=</span> pd.read_excel(<span class="bu">open</span>(f_inrix,<span class="st">'rb'</span>), sheetname<span class="op">=</span><span class="st">'TableA2'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_inrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>[u'RANK',
 u'city name',
 u'CITY (ORIG)',
 u'COUNTRY',
 u'CONTINENT',
 u'PEAK HOURS SPENT IN CONGESTION',
 u'INRIX CONGESTION INDEX',
 u'AVERAGE CONGESTION RATE']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename columns</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>df_inrix.rename(columns <span class="op">=</span> {<span class="st">'PEAK HOURS SPENT IN CONGESTION'</span>:<span class="st">'Peak hours spent in congestion'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>df_inrix.rename(columns <span class="op">=</span> {<span class="st">'AVERAGE CONGESTION RATE'</span>:<span class="st">'Average Congestion Rate'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>df_inrix.rename(columns <span class="op">=</span> {<span class="st">'RANK'</span>:<span class="st">'Congestion Rank'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>df_inrix.rename(columns <span class="op">=</span> {<span class="st">'INRIX CONGESTION INDEX'</span>:<span class="st">'INRIX Congestion Index'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_inrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>['Congestion Rank',
 u'city name',
 u'CITY (ORIG)',
 u'COUNTRY',
 u'CONTINENT',
 'Peak hours spent in congestion',
 'INRIX Congestion Index',
 'Average Congestion Rate']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_inrix, <span class="st">'INRIX'</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_inrix.shape</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_inrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1064, 8)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>['Congestion Rank (INRIX)',
 u'city name',
 u'CITY (ORIG) (INRIX)',
 u'COUNTRY (INRIX)',
 u'CONTINENT (INRIX)',
 'Peak hours spent in congestion (INRIX)',
 'INRIX Congestion Index (INRIX)',
 'Average Congestion Rate (INRIX)']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>df_inrix.drop(<span class="st">'CITY (ORIG) (INRIX)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>df_inrix.drop(<span class="st">'COUNTRY (INRIX)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>df_inrix.drop(<span class="st">'CONTINENT (INRIX)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MERGE INRIX</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge5.shape</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>df_merge6 <span class="op">=</span> df_merge5 <span class="op">=</span> pd.merge(df_merge5, df_inrix, on<span class="op">=</span>var_city, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge6.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 124)
(343, 128)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>df_merge6.loc[<span class="op">~</span>df_merge6[<span class="st">'Congestion Rank (INRIX)'</span>].isnull(), var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>118</code></pre>
</div>
</div>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>mergedList <span class="op">=</span> <span class="bu">list</span>(df_merge6.loc[<span class="op">~</span>df_merge6[<span class="st">'Congestion Rank (INRIX)'</span>].isnull(), var_city].sort_values())</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">len</span>(mergedList)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>118</code></pre>
</div>
</div>
</section>
<section id="tomtom" class="level2">
<h2 class="anchored" data-anchor-id="tomtom">TomTom</h2>
<p>Note: The following cities are NOT in TomTom:<br>
* Brisbane, CA (Brisbane Australia is in TomTom)<br>
* Buffalo City (Buffalo, USA is in TomTom) * District of Columbia (Columbia, South Carolina is in TomTom) * North Vancouver (Vancouver is in TomTom)</p>
<p>Note: ‘Nashville’ in TomTom edited to ‘Nashville and Davidson’ to match emissions dataset</p>
<p><strong>123 cities in INRIX overlap with D<sup>emissions</sup>.</strong></p>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>f_tomtom <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/tomtom_congestion.xlsx'</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>df_tomtom <span class="op">=</span> pd.read_excel(<span class="bu">open</span>(f_tomtom,<span class="st">'rb'</span>), sheetname<span class="op">=</span><span class="st">'tomtom'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_tomtom.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(390, 10)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename columns</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>df_tomtom.rename(columns <span class="op">=</span> {<span class="st">'Congestion Level'</span>:<span class="st">'Congestion Level'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>df_tomtom.rename(columns <span class="op">=</span> {<span class="st">'Congestion change'</span>:<span class="st">'Congestion Change'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>df_tomtom.rename(columns <span class="op">=</span> {<span class="st">'Morning Peak'</span>:<span class="st">'Morning Peak'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>df_tomtom.rename(columns <span class="op">=</span> {<span class="st">'Evening Peak'</span>:<span class="st">'Evening Peak'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>df_tomtom.rename(columns <span class="op">=</span> {<span class="st">'World Rank'</span>:<span class="st">'Congestion Rank'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_tomtom, <span class="st">'TomTom'</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_tomtom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>[u'Rank by filter (TomTom)',
 'Congestion Rank (TomTom)',
 u'city name',
 u'City (orig) (TomTom)',
 u'Country (TomTom)',
 'Congestion Level (TomTom)',
 'Congestion Change (TomTom)',
 'Morning Peak (TomTom)',
 'Evening Peak (TomTom)',
 u'TomTom City (TomTom)']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>df_tomtom.drop(<span class="st">'Rank by filter (TomTom)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>df_tomtom.drop(<span class="st">'City (orig) (TomTom)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>df_tomtom.drop(<span class="st">'TomTom City (TomTom)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>df_tomtom.drop(<span class="st">'Country (TomTom)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MERGE IN TOMTOM</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge6.shape</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_tomtom.shape</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>df_merge7 <span class="op">=</span> pd.merge(df_merge6, df_tomtom, on<span class="op">=</span>var_city, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge7.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 128)
(390, 6)
(343, 133)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>df_merge7.loc[<span class="op">~</span>df_merge7[<span class="st">'Congestion Level (TomTom)'</span>].isnull(), var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>123</code></pre>
</div>
</div>
</section>
</section>
<section id="merge-ancillary-attributes-from-iese-dataset" class="level1">
<h1>Merge ancillary attributes from IESE dataset</h1>
<p>Note: The following cities are NOT in IESE: * London, ON (London UK is in IESE)<br>
* New Taipei (Taipei is in IESE and assume it refers to Taipei City and not New Taipei) * North Vancouver (Vancouver is in IESE)<br>
* Santiago de Guayaquil, Ecuador (Santiago, Chile is in IESE) * Santiago de Cali, Colombia</p>
<p><strong>85 cities in IESE overlap with D<sup>emissions</sup>.</strong></p>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>f_iese <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/IESE_Table12_11.xlsx'</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>df_iese <span class="op">=</span> pd.read_excel(<span class="bu">open</span>(f_iese,<span class="st">'rb'</span>), sheetname<span class="op">=</span><span class="st">'IESE Tables 11 and 12'</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>df_iese <span class="op">=</span> df_iese.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_iese.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(180, 15)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_iese, <span class="st">'IESE'</span>)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_iese)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>[u'city name',
 u'country',
 u'economy (IESE)',
 u'human capital (IESE)',
 u'social cohesion (IESE)',
 u'environment (IESE)',
 u'public management (IESE)',
 u'governance (IESE)',
 u'urban planning (IESE)',
 u'international impact (IESE)',
 u'technology (IESE)',
 u'mobility and transportation (IESE)',
 u'CIMI (IESE)',
 u'CIMI Ranking (IESE)',
 u'CIMI Performance (IESE)']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>df_iese.drop(<span class="st">'country'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MERGE IN IESE</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge7.shape</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_iese.shape</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>df_merge8 <span class="op">=</span> pd.merge(df_merge7, df_iese, on<span class="op">=</span>var_city, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge8.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 133)
(180, 14)
(343, 146)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>df_merge8.loc[<span class="op">~</span>df_merge8[<span class="st">'CIMI (IESE)'</span>].isnull(), var_city].count() <span class="co">#67 before</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; 85 IESE cities overlap with emissions datasets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>85</code></pre>
</div>
</div>
</section>
<section id="merge-ancillary-attributes-from-urban-expansion-dataset" class="level1">
<h1>Merge ancillary attributes from Urban Expansion dataset</h1>
<p>Note: ‘Taipei Urban Area Name’ includes three data point from the CDP (Taipei City, New Taipei City and Taoyuan City).<br>
(CDP has both Taipei City and New Taipei City. Taipei City is an enclave of the municipality of New Taipei City.)</p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>f_urban<span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/uex_prepared.tsv'</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>df_urban <span class="op">=</span> pd.read_csv(f_urban, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>df_urban <span class="op">=</span> df_urban.drop(<span class="st">'Unnamed: 0'</span>, <span class="dv">1</span>)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_urban.shape</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>df_urban.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(341, 20)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="113">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>Urban Area Name</th>
      <th>Low BUA - 1990</th>
      <th>Low BUA – 2000</th>
      <th>Low BUA – 2014</th>
      <th>High BUA - 1990</th>
      <th>High BUA – 2000</th>
      <th>High BUA – 2014</th>
      <th>Low BUA % - 1990</th>
      <th>Low BUA % – 2000</th>
      <th>Low BUA % – 2014</th>
      <th>High BUA % - 1990</th>
      <th>High BUA % – 2000</th>
      <th>High BUA % – 2014</th>
      <th>Low BUA pop density - 1990</th>
      <th>High BUA pop density – 1990</th>
      <th>Low BUA pop density – 2000</th>
      <th>High BUA pop density - 2000</th>
      <th>Low BUA pop density – 2014</th>
      <th>High BUA pop density - 2014</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Buenos Aires</td>
      <td>City of Buenos Aires Urban Area</td>
      <td>655.1875</td>
      <td>700.4375</td>
      <td>731.375</td>
      <td>1702.0625</td>
      <td>1887.5625</td>
      <td>2046.3125</td>
      <td>0.277946</td>
      <td>0.270648</td>
      <td>0.263304</td>
      <td>0.722054</td>
      <td>0.729352</td>
      <td>0.736696</td>
      <td>1990.000000</td>
      <td>1990.000000</td>
      <td>425.79253</td>
      <td>6429.729951</td>
      <td>497.821056</td>
      <td>7166.397159</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adelaide</td>
      <td>City of Adelaide Urban Area</td>
      <td>234.5625</td>
      <td>244.5000</td>
      <td>250.125</td>
      <td>595.0000</td>
      <td>617.6250</td>
      <td>639.2500</td>
      <td>0.282754</td>
      <td>0.283602</td>
      <td>0.281237</td>
      <td>0.717246</td>
      <td>0.716398</td>
      <td>0.718763</td>
      <td>401.928179</td>
      <td>6206.605592</td>
      <td>75.98208</td>
      <td>1470.030353</td>
      <td>74.792580</td>
      <td>1789.259778</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sydney</td>
      <td>City of Sydney Urban Area</td>
      <td>535.4375</td>
      <td>523.1875</td>
      <td>504.875</td>
      <td>1359.8750</td>
      <td>1440.6250</td>
      <td>1507.3125</td>
      <td>0.282506</td>
      <td>0.266414</td>
      <td>0.250909</td>
      <td>0.717494</td>
      <td>0.733586</td>
      <td>0.749091</td>
      <td>103.019859</td>
      <td>1352.728702</td>
      <td>118.21506</td>
      <td>2278.088318</td>
      <td>115.533774</td>
      <td>2743.988705</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_urban, <span class="st">'UEX'</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>[u'city name',
 u'Urban Area Name (UEX)',
 u'Low BUA - 1990 (UEX)',
 u'Low BUA \u2013 2000 (UEX)',
 u'Low BUA \u2013 2014 (UEX)',
 u'High BUA - 1990 (UEX)',
 u'High BUA \u2013 2000 (UEX)',
 u'High BUA \u2013 2014 (UEX)',
 u'Low BUA % - 1990 (UEX)',
 u'Low BUA % \u2013 2000 (UEX)',
 u'Low BUA % \u2013 2014 (UEX)',
 u'High BUA % - 1990 (UEX)',
 u'High BUA % \u2013 2000 (UEX)',
 u'High BUA % \u2013 2014 (UEX)',
 u'Low BUA pop density - 1990 (UEX)',
 u'High BUA pop density \u2013 1990 (UEX)',
 u'Low BUA pop density \u2013 2000 (UEX)',
 u'High BUA pop density - 2000 (UEX)',
 u'Low BUA pop density \u2013 2014 (UEX)',
 u'High BUA pop density - 2014 (UEX)']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MERGE IN UEX</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge8.shape</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_urban.shape</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>df_merge9 <span class="op">=</span> pd.merge(df_merge8, df_urban, on<span class="op">=</span>var_city, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge9.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 146)
(341, 20)
(343, 165)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge9.loc[<span class="op">~</span>df_merge9[<span class="st">'Urban Area Name (UEX)'</span>].isnull(), var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>341</code></pre>
</div>
</div>
</section>
<section id="merge-ancillary-attributes-from-climate-dataset" class="level1">
<h1>Merge ancillary attributes from climate dataset</h1>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>f_clim <span class="op">=</span> <span class="st">'DATA/ORIGINAL_ANCILLARY_SOURCEFILES/climAll_prepared.tsv'</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>df_clim <span class="op">=</span> pd.read_csv(f_clim, delimiter<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, encoding <span class="op">=</span> <span class="st">'utf-8'</span>)</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>df_clim.drop(<span class="st">'Unnamed: 0'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_clim.shape</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_clim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 6)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>[u'city name', u'lat', u'lon', u'CDD_23C', u'HDD_15.5C', u'coord source']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>tag_column_names_with_datasetname(df_clim, <span class="st">'clim'</span>)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(df_clim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>[u'city name',
 u'lat (clim)',
 u'lon (clim)',
 u'CDD_23C (clim)',
 u'HDD_15.5C (clim)',
 u'coord source (clim)']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#MERGE IN UEX</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge9.shape</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_clim.shape</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>df_merge10 <span class="op">=</span> pd.merge(df_merge9, df_clim, on<span class="op">=</span>var_city, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge10.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 165)
(343, 6)
(343, 170)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[<span class="op">~</span>df_merge10[<span class="st">'HDD_15.5C (clim)'</span>].isnull(), var_city].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>343</code></pre>
</div>
</div>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>df_merge10.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>(343, 170)</code></pre>
</div>
</div>
</section>
<section id="consolidate-remaining-columns" class="level1">
<h1>Consolidate remaining columns</h1>
<ul>
<li>‘lat (clim)’,</li>
<li>‘lat (china)’,</li>
<li>‘lon (carbonn)’,</li>
<li>‘lat (carbonn)’,</li>
<li>‘lon (clim)’,</li>
<li>‘lon (china)’,</li>
<li>‘coord source (clim)’</li>
</ul>
<div class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>df_merge10[<span class="st">'lat'</span>] <span class="op">=</span> np.nan</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>df_merge10[<span class="st">'lon'</span>] <span class="op">=</span> np.nan</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>df_merge10[<span class="st">'coord source'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make a general column</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>df_merge10[<span class="st">'lat'</span>] <span class="op">=</span> df_merge10[<span class="st">'lat (clim)'</span>]</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>df_merge10[<span class="st">'lon'</span>] <span class="op">=</span> df_merge10[<span class="st">'lon (clim)'</span>]</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>df_merge10[<span class="st">'coord source'</span>] <span class="op">=</span> df_merge10[<span class="st">'coord source (clim)'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add lat/lon for carbonn cities</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'Scope-1 source dataset'</span>].<span class="bu">str</span>.contains(<span class="st">'carbonn'</span>), <span class="st">'lat'</span>] <span class="op">=</span> df_merge10[<span class="st">'lat (carbonn)'</span>]</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'Scope-1 source dataset'</span>].<span class="bu">str</span>.contains(<span class="st">'carbonn'</span>), <span class="st">'lon'</span>] <span class="op">=</span> df_merge10[<span class="st">'lon (carbonn)'</span>]</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'Scope-1 source dataset'</span>].<span class="bu">str</span>.contains(<span class="st">'carbonn'</span>), <span class="st">'coord source'</span>] <span class="op">=</span> <span class="st">'carbonn'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Add lat/lon for chinese cities</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'Scope-1 source dataset'</span>].<span class="bu">str</span>.contains(<span class="st">'PKU'</span>), <span class="st">'lat'</span>] <span class="op">=</span> df_merge10[<span class="st">'lat (PKU)'</span>]</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'Scope-1 source dataset'</span>].<span class="bu">str</span>.contains(<span class="st">'PKU'</span>), <span class="st">'lon'</span>] <span class="op">=</span> df_merge10[<span class="st">'lon (PKU)'</span>]</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'Scope-1 source dataset'</span>].<span class="bu">str</span>.contains(<span class="st">'PKU'</span>), <span class="st">'coord source'</span>] <span class="op">=</span> <span class="st">'wikipedia'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[<span class="st">'lat'</span>].isnull(), [var_city, <span class="st">'lat'</span>, <span class="st">'Scope 1 source dataset'</span>]]</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co">#=&gt; ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city name</th>
      <th>lat</th>
      <th>Scope 1 source dataset</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co">#drop columns no longer used</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'lat (clim)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'lon (clim)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'coord source (clim)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'lat (carbonn)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'lon (carbonn)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'lat (PKU)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>df_merge10.drop(<span class="st">'lon (PKU)'</span>, <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge10.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 166)</code></pre>
</div>
</div>
</section>
<section id="column-order" class="level1">
<h1>Column order</h1>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>col_order <span class="op">=</span> [</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="st">u'city name'</span>,</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="st">u'City Name (CDP)'</span>,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="st">u'full city name (carbonn)'</span>,</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="st">u'full city name (PKU)'</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="st">'full city name (GEA)'</span>, <span class="st">'full city name (UITP)'</span>, <span class="st">'full city name (WB)'</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="st">u'Boundary (CDP)'</span>,</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="st">u'city_type (carbonn)'</span>,</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="st">u'definition  (WB)'</span>,</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="st">u'study_year (WB)'</span>,</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="st">u'Reporting Year (CDP)'</span>,</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="st">u'Scope-1 GHG emissions'</span>,</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="st">u'Scope-1 source dataset'</span>,</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="st">u'Scope-1 GHG emissions units'</span>,</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a><span class="st">u'Year of Emission'</span>,</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="st">u'Emissions Protocol'</span>,</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a><span class="st">u'Gases included (CDP)'</span>,</span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a><span class="st">u'Methodology Details (CDP)'</span>,</span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a><span class="st">u'Increase/Decrease from last year (CDP)'</span>,</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a><span class="st">u'Reason for increase/decrease in emissions (CDP)'</span>,</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a><span class="st">u'Scope 2 [metric ton CO2e] (CDP)'</span>,</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="st">u'Total Emissions [metric ton CO2e] (CDP)'</span>,</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a><span class="st">u'CDP2016 data edited (CDP)'</span>,</span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a><span class="st">u'Emissions Quality Flag (CDP)'</span>,</span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a><span class="st">u'S1 lower bound [tCO2] (CDP)'</span>,</span>
<span id="cb203-28"><a href="#cb203-28" aria-hidden="true" tabindex="-1"></a><span class="st">u'S1 upper bound [tCO2] (CDP)'</span>,</span>
<span id="cb203-29"><a href="#cb203-29" aria-hidden="true" tabindex="-1"></a><span class="st">u'S1 mean [tCO2] (CDP)'</span>,</span>
<span id="cb203-30"><a href="#cb203-30" aria-hidden="true" tabindex="-1"></a><span class="st">u'TOT lower bound [tCO2] (CDP)'</span>,</span>
<span id="cb203-31"><a href="#cb203-31" aria-hidden="true" tabindex="-1"></a><span class="st">u'TOT upper bound [tCO2] (CDP)'</span>,</span>
<span id="cb203-32"><a href="#cb203-32" aria-hidden="true" tabindex="-1"></a><span class="st">u'TOT mean [tCO2] (CDP)'</span>,</span>
<span id="cb203-33"><a href="#cb203-33" aria-hidden="true" tabindex="-1"></a><span class="st">u'scope fraction (CDP)'</span>,</span>
<span id="cb203-34"><a href="#cb203-34" aria-hidden="true" tabindex="-1"></a><span class="st">u'CO2 Emissions Per Capita (Ton) (PKU)'</span>,</span>
<span id="cb203-35"><a href="#cb203-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-36"><a href="#cb203-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-37"><a href="#cb203-37" aria-hidden="true" tabindex="-1"></a><span class="st">'City Location (CDP)'</span>,</span>
<span id="cb203-38"><a href="#cb203-38" aria-hidden="true" tabindex="-1"></a><span class="st">'lat'</span>,</span>
<span id="cb203-39"><a href="#cb203-39" aria-hidden="true" tabindex="-1"></a><span class="st">'lon'</span>,</span>
<span id="cb203-40"><a href="#cb203-40" aria-hidden="true" tabindex="-1"></a><span class="st">'coord source'</span>,</span>
<span id="cb203-41"><a href="#cb203-41" aria-hidden="true" tabindex="-1"></a><span class="st">u'country'</span>,</span>
<span id="cb203-42"><a href="#cb203-42" aria-hidden="true" tabindex="-1"></a><span class="st">u'region'</span>,</span>
<span id="cb203-43"><a href="#cb203-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-44"><a href="#cb203-44" aria-hidden="true" tabindex="-1"></a><span class="st">u'Current Population (CDP)'</span>,</span>
<span id="cb203-45"><a href="#cb203-45" aria-hidden="true" tabindex="-1"></a><span class="st">u'Current Population Year (CDP)'</span>,</span>
<span id="cb203-46"><a href="#cb203-46" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop (carbonn)'</span>,</span>
<span id="cb203-47"><a href="#cb203-47" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop_yr (carbonn)'</span>,</span>
<span id="cb203-48"><a href="#cb203-48" aria-hidden="true" tabindex="-1"></a><span class="st">u'Urban Population (PKU)'</span>,</span>
<span id="cb203-49"><a href="#cb203-49" aria-hidden="true" tabindex="-1"></a><span class="st">u'population (GEA)'</span>,</span>
<span id="cb203-50"><a href="#cb203-50" aria-hidden="true" tabindex="-1"></a><span class="st">u'population (UITP)'</span>,</span>
<span id="cb203-51"><a href="#cb203-51" aria-hidden="true" tabindex="-1"></a><span class="st">u'population (WB)'</span>,</span>
<span id="cb203-52"><a href="#cb203-52" aria-hidden="true" tabindex="-1"></a><span class="st">u'population_year (WB)'</span>,</span>
<span id="cb203-53"><a href="#cb203-53" aria-hidden="true" tabindex="-1"></a><span class="st">u'population (others)'</span>,</span>
<span id="cb203-54"><a href="#cb203-54" aria-hidden="true" tabindex="-1"></a><span class="st">u'population (others) source year'</span>,</span>
<span id="cb203-55"><a href="#cb203-55" aria-hidden="true" tabindex="-1"></a><span class="st">u'population (others) source'</span>,</span>
<span id="cb203-56"><a href="#cb203-56" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop_1950 (WB)'</span>,</span>
<span id="cb203-57"><a href="#cb203-57" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop_1990 (WB)'</span>,</span>
<span id="cb203-58"><a href="#cb203-58" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop_2010 (WB)'</span>,</span>
<span id="cb203-59"><a href="#cb203-59" aria-hidden="true" tabindex="-1"></a><span class="st">u'growth_rate_1950-2010 (WB)'</span>,</span>
<span id="cb203-60"><a href="#cb203-60" aria-hidden="true" tabindex="-1"></a><span class="st">u'growth_rate_1990-2010 (WB)'</span>,</span>
<span id="cb203-61"><a href="#cb203-61" aria-hidden="true" tabindex="-1"></a><span class="st">'Ancillary from GEA+'</span>,</span>
<span id="cb203-62"><a href="#cb203-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-63"><a href="#cb203-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-64"><a href="#cb203-64" aria-hidden="true" tabindex="-1"></a><span class="st">u'Land area (in square km) (CDP)'</span>,</span>
<span id="cb203-65"><a href="#cb203-65" aria-hidden="true" tabindex="-1"></a><span class="st">u'area_size (GEA)'</span>,</span>
<span id="cb203-66"><a href="#cb203-66" aria-hidden="true" tabindex="-1"></a><span class="st">u'area_size (WB)'</span>,</span>
<span id="cb203-67"><a href="#cb203-67" aria-hidden="true" tabindex="-1"></a><span class="st">u'Built-up Area (km2) (PKU)'</span>,</span>
<span id="cb203-68"><a href="#cb203-68" aria-hidden="true" tabindex="-1"></a><span class="st">u'area [km2] (others)'</span>,</span>
<span id="cb203-69"><a href="#cb203-69" aria-hidden="true" tabindex="-1"></a><span class="st">u'area [km2] (others) source year'</span>,</span>
<span id="cb203-70"><a href="#cb203-70" aria-hidden="true" tabindex="-1"></a><span class="st">u'area [km2] (others) source'</span>,</span>
<span id="cb203-71"><a href="#cb203-71" aria-hidden="true" tabindex="-1"></a><span class="st">u'population_density (GEA)'</span>,</span>
<span id="cb203-72"><a href="#cb203-72" aria-hidden="true" tabindex="-1"></a><span class="st">u'population_density (UITP)'</span>,</span>
<span id="cb203-73"><a href="#cb203-73" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop_density (WB)'</span>,</span>
<span id="cb203-74"><a href="#cb203-74" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop/sqrt(area_size) (GEA)'</span>,</span>
<span id="cb203-75"><a href="#cb203-75" aria-hidden="true" tabindex="-1"></a><span class="st">u'pop/sqrt(area) (WB)'</span>,</span>
<span id="cb203-76"><a href="#cb203-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-77"><a href="#cb203-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-78"><a href="#cb203-78" aria-hidden="true" tabindex="-1"></a><span class="st">u'Average altitude (m)'</span>,</span>
<span id="cb203-79"><a href="#cb203-79" aria-hidden="true" tabindex="-1"></a><span class="st">u'Average annual temperature (in Celsius) (CDP)'</span>,</span>
<span id="cb203-80"><a href="#cb203-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-81"><a href="#cb203-81" aria-hidden="true" tabindex="-1"></a><span class="st">u'weather_station_id (GEA+)'</span>,</span>
<span id="cb203-82"><a href="#cb203-82" aria-hidden="true" tabindex="-1"></a><span class="st">u'CDD_23C (GEA+)'</span>,</span>
<span id="cb203-83"><a href="#cb203-83" aria-hidden="true" tabindex="-1"></a><span class="st">u'HDD_15.5C (GEA+)'</span>,</span>
<span id="cb203-84"><a href="#cb203-84" aria-hidden="true" tabindex="-1"></a><span class="st">'HDD_15.5C (clim)'</span>,</span>
<span id="cb203-85"><a href="#cb203-85" aria-hidden="true" tabindex="-1"></a><span class="st">'CDD_23C (clim)'</span>,</span>
<span id="cb203-86"><a href="#cb203-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-87"><a href="#cb203-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-88"><a href="#cb203-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-89"><a href="#cb203-89" aria-hidden="true" tabindex="-1"></a><span class="st">u'City GDP (CDP)'</span>,</span>
<span id="cb203-90"><a href="#cb203-90" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP Currency (CDP)'</span>,</span>
<span id="cb203-91"><a href="#cb203-91" aria-hidden="true" tabindex="-1"></a><span class="st">u'Year of GDP (CDP)'</span>,</span>
<span id="cb203-92"><a href="#cb203-92" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP Source (CDP)'</span>,</span>
<span id="cb203-93"><a href="#cb203-93" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP (carbonn)'</span>,</span>
<span id="cb203-94"><a href="#cb203-94" aria-hidden="true" tabindex="-1"></a><span class="st">u'nGDP (carbonn)'</span>,</span>
<span id="cb203-95"><a href="#cb203-95" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP unit (carbonn)'</span>,</span>
<span id="cb203-96"><a href="#cb203-96" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP year (carbonn)'</span>,</span>
<span id="cb203-97"><a href="#cb203-97" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP (10000 RMB) (PKU)'</span>,</span>
<span id="cb203-98"><a href="#cb203-98" aria-hidden="true" tabindex="-1"></a><span class="st">u'Income Per Capita (RMB) (PKU)'</span>,</span>
<span id="cb203-99"><a href="#cb203-99" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP-PPP [$BN] (others)'</span>,</span>
<span id="cb203-100"><a href="#cb203-100" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP-PPP/cap [$USD] (others)'</span>,</span>
<span id="cb203-101"><a href="#cb203-101" aria-hidden="true" tabindex="-1"></a><span class="st">u'GDP-PPP [$BN] (others) source'</span>,</span>
<span id="cb203-102"><a href="#cb203-102" aria-hidden="true" tabindex="-1"></a><span class="st">'GDP-PPP year (others)'</span>,   </span>
<span id="cb203-103"><a href="#cb203-103" aria-hidden="true" tabindex="-1"></a><span class="st">u'nGDP [$BN] (others)'</span>,</span>
<span id="cb203-104"><a href="#cb203-104" aria-hidden="true" tabindex="-1"></a><span class="st">u'nGDP/cap [$USD] (others)'</span>,</span>
<span id="cb203-105"><a href="#cb203-105" aria-hidden="true" tabindex="-1"></a><span class="st">u'nGDP [$BN] (others) source'</span>,</span>
<span id="cb203-106"><a href="#cb203-106" aria-hidden="true" tabindex="-1"></a><span class="st">u'nGDP [$BN] (others) source year'</span>,</span>
<span id="cb203-107"><a href="#cb203-107" aria-hidden="true" tabindex="-1"></a><span class="st">'GDP-PPP/cap (GEA)'</span>,</span>
<span id="cb203-108"><a href="#cb203-108" aria-hidden="true" tabindex="-1"></a><span class="st">'GDP-PPP/cap (UITP)'</span>,</span>
<span id="cb203-109"><a href="#cb203-109" aria-hidden="true" tabindex="-1"></a><span class="st">'GDP-PPP/cap (WB)'</span>,</span>
<span id="cb203-110"><a href="#cb203-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-111"><a href="#cb203-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-112"><a href="#cb203-112" aria-hidden="true" tabindex="-1"></a><span class="st">u'total_final_consumption_per_capita (GEA)'</span>,</span>
<span id="cb203-113"><a href="#cb203-113" aria-hidden="true" tabindex="-1"></a><span class="st">u'energy_per_cap_CO2 (WB)'</span>,</span>
<span id="cb203-114"><a href="#cb203-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-115"><a href="#cb203-115" aria-hidden="true" tabindex="-1"></a><span class="st">u'diesel_price (GEA+)'</span>,</span>
<span id="cb203-116"><a href="#cb203-116" aria-hidden="true" tabindex="-1"></a><span class="st">u'gasoline_price (GEA+)'</span>,</span>
<span id="cb203-117"><a href="#cb203-117" aria-hidden="true" tabindex="-1"></a><span class="st">u'center_of_commerce_index (GEA+)'</span>,</span>
<span id="cb203-118"><a href="#cb203-118" aria-hidden="true" tabindex="-1"></a><span class="st">u'household_size (GEA+)'</span>,</span>
<span id="cb203-119"><a href="#cb203-119" aria-hidden="true" tabindex="-1"></a><span class="st">u'year_household_size (GEA+)'</span>,</span>
<span id="cb203-120"><a href="#cb203-120" aria-hidden="true" tabindex="-1"></a><span class="st">u'household_source (GEA+)'</span>,</span>
<span id="cb203-121"><a href="#cb203-121" aria-hidden="true" tabindex="-1"></a><span class="st">u'comment_household_size (GEA+)'</span>,</span>
<span id="cb203-122"><a href="#cb203-122" aria-hidden="true" tabindex="-1"></a><span class="st">u'urbanization_ratio (GEA+)'</span>,</span>
<span id="cb203-123"><a href="#cb203-123" aria-hidden="true" tabindex="-1"></a><span class="st">u'water_bounded (GEA+)'</span>,</span>
<span id="cb203-124"><a href="#cb203-124" aria-hidden="true" tabindex="-1"></a><span class="st">u'other_bounded (GEA+)'</span>,</span>
<span id="cb203-125"><a href="#cb203-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-126"><a href="#cb203-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-127"><a href="#cb203-127" aria-hidden="true" tabindex="-1"></a><span class="st">u'mean travel time [min] (others)'</span>,</span>
<span id="cb203-128"><a href="#cb203-128" aria-hidden="true" tabindex="-1"></a><span class="st">u'mean travel time ref year (others)'</span>,</span>
<span id="cb203-129"><a href="#cb203-129" aria-hidden="true" tabindex="-1"></a><span class="st">u'mean travel time ref (others)'</span>,</span>
<span id="cb203-130"><a href="#cb203-130" aria-hidden="true" tabindex="-1"></a><span class="st">u'diesel_price (2014) (others)'</span>,</span>
<span id="cb203-131"><a href="#cb203-131" aria-hidden="true" tabindex="-1"></a><span class="st">u'gasoline_price (2014) (others)'</span>,</span>
<span id="cb203-132"><a href="#cb203-132" aria-hidden="true" tabindex="-1"></a><span class="st">u'household_size (updated) (others)'</span>,</span>
<span id="cb203-133"><a href="#cb203-133" aria-hidden="true" tabindex="-1"></a><span class="st">u'year_household_size (updated) (others)'</span>,</span>
<span id="cb203-134"><a href="#cb203-134" aria-hidden="true" tabindex="-1"></a><span class="st">u'household_source (updated) (others)'</span>,</span>
<span id="cb203-135"><a href="#cb203-135" aria-hidden="true" tabindex="-1"></a><span class="st">u'comment_household_size (updated) (others)'</span>,</span>
<span id="cb203-136"><a href="#cb203-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-137"><a href="#cb203-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-138"><a href="#cb203-138" aria-hidden="true" tabindex="-1"></a><span class="st">'Congestion Rank (INRIX)'</span>,</span>
<span id="cb203-139"><a href="#cb203-139" aria-hidden="true" tabindex="-1"></a> <span class="st">'Peak hours spent in congestion (INRIX)'</span>,</span>
<span id="cb203-140"><a href="#cb203-140" aria-hidden="true" tabindex="-1"></a> <span class="st">'INRIX Congestion Index (INRIX)'</span>,</span>
<span id="cb203-141"><a href="#cb203-141" aria-hidden="true" tabindex="-1"></a> <span class="st">'Average Congestion Rate (INRIX)'</span>,</span>
<span id="cb203-142"><a href="#cb203-142" aria-hidden="true" tabindex="-1"></a> <span class="st">'Congestion Rank (TomTom)'</span>,</span>
<span id="cb203-143"><a href="#cb203-143" aria-hidden="true" tabindex="-1"></a> <span class="st">'Congestion Level (TomTom)'</span>,</span>
<span id="cb203-144"><a href="#cb203-144" aria-hidden="true" tabindex="-1"></a> <span class="st">u'Congestion Change (TomTom)'</span>,</span>
<span id="cb203-145"><a href="#cb203-145" aria-hidden="true" tabindex="-1"></a> <span class="st">'Morning Peak (TomTom)'</span>,</span>
<span id="cb203-146"><a href="#cb203-146" aria-hidden="true" tabindex="-1"></a> <span class="st">'Evening Peak (TomTom)'</span>,</span>
<span id="cb203-147"><a href="#cb203-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-148"><a href="#cb203-148" aria-hidden="true" tabindex="-1"></a><span class="st">u'economy (IESE)'</span>,</span>
<span id="cb203-149"><a href="#cb203-149" aria-hidden="true" tabindex="-1"></a><span class="st">u'environment (IESE)'</span>,</span>
<span id="cb203-150"><a href="#cb203-150" aria-hidden="true" tabindex="-1"></a><span class="st">u'governance (IESE)'</span>,</span>
<span id="cb203-151"><a href="#cb203-151" aria-hidden="true" tabindex="-1"></a><span class="st">u'human capital (IESE)'</span>,</span>
<span id="cb203-152"><a href="#cb203-152" aria-hidden="true" tabindex="-1"></a><span class="st">u'international impact (IESE)'</span>,</span>
<span id="cb203-153"><a href="#cb203-153" aria-hidden="true" tabindex="-1"></a><span class="st">u'mobility and transportation (IESE)'</span>,</span>
<span id="cb203-154"><a href="#cb203-154" aria-hidden="true" tabindex="-1"></a><span class="st">u'public management (IESE)'</span>,</span>
<span id="cb203-155"><a href="#cb203-155" aria-hidden="true" tabindex="-1"></a><span class="st">u'social cohesion (IESE)'</span>,</span>
<span id="cb203-156"><a href="#cb203-156" aria-hidden="true" tabindex="-1"></a><span class="st">u'technology (IESE)'</span>,</span>
<span id="cb203-157"><a href="#cb203-157" aria-hidden="true" tabindex="-1"></a><span class="st">u'urban planning (IESE)'</span>,</span>
<span id="cb203-158"><a href="#cb203-158" aria-hidden="true" tabindex="-1"></a><span class="st">u'CIMI (IESE)'</span>,</span>
<span id="cb203-159"><a href="#cb203-159" aria-hidden="true" tabindex="-1"></a><span class="st">u'CIMI Ranking (IESE)'</span>,</span>
<span id="cb203-160"><a href="#cb203-160" aria-hidden="true" tabindex="-1"></a><span class="st">u'CIMI Performance (IESE)'</span>,</span>
<span id="cb203-161"><a href="#cb203-161" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-162"><a href="#cb203-162" aria-hidden="true" tabindex="-1"></a><span class="st">u'Urban Area Name (UEX)'</span>,</span>
<span id="cb203-163"><a href="#cb203-163" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA - 1990 (UEX)'</span>,</span>
<span id="cb203-164"><a href="#cb203-164" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA </span><span class="ch">\u2013</span><span class="st"> 2000 (UEX)'</span>,</span>
<span id="cb203-165"><a href="#cb203-165" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA </span><span class="ch">\u2013</span><span class="st"> 2014 (UEX)'</span>,</span>
<span id="cb203-166"><a href="#cb203-166" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA - 1990 (UEX)'</span>,</span>
<span id="cb203-167"><a href="#cb203-167" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA </span><span class="ch">\u2013</span><span class="st"> 2000 (UEX)'</span>,</span>
<span id="cb203-168"><a href="#cb203-168" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA </span><span class="ch">\u2013</span><span class="st"> 2014 (UEX)'</span>,</span>
<span id="cb203-169"><a href="#cb203-169" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA % - 1990 (UEX)'</span>,</span>
<span id="cb203-170"><a href="#cb203-170" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA % </span><span class="ch">\u2013</span><span class="st"> 2000 (UEX)'</span>,</span>
<span id="cb203-171"><a href="#cb203-171" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA % </span><span class="ch">\u2013</span><span class="st"> 2014 (UEX)'</span>,</span>
<span id="cb203-172"><a href="#cb203-172" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA % - 1990 (UEX)'</span>,</span>
<span id="cb203-173"><a href="#cb203-173" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA % </span><span class="ch">\u2013</span><span class="st"> 2000 (UEX)'</span>,</span>
<span id="cb203-174"><a href="#cb203-174" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA % </span><span class="ch">\u2013</span><span class="st"> 2014 (UEX)'</span>,</span>
<span id="cb203-175"><a href="#cb203-175" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA pop density - 1990 (UEX)'</span>,</span>
<span id="cb203-176"><a href="#cb203-176" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA pop density </span><span class="ch">\u2013</span><span class="st"> 1990 (UEX)'</span>,</span>
<span id="cb203-177"><a href="#cb203-177" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA pop density </span><span class="ch">\u2013</span><span class="st"> 2000 (UEX)'</span>,</span>
<span id="cb203-178"><a href="#cb203-178" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA pop density - 2000 (UEX)'</span>,</span>
<span id="cb203-179"><a href="#cb203-179" aria-hidden="true" tabindex="-1"></a><span class="st">u'Low BUA pop density </span><span class="ch">\u2013</span><span class="st"> 2014 (UEX)'</span>,</span>
<span id="cb203-180"><a href="#cb203-180" aria-hidden="true" tabindex="-1"></a><span class="st">u'High BUA pop density - 2014 (UEX)'</span>,</span>
<span id="cb203-181"><a href="#cb203-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-182"><a href="#cb203-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-183"><a href="#cb203-183" aria-hidden="true" tabindex="-1"></a><span class="st">u'Exports (m3)'</span>,</span>
<span id="cb203-184"><a href="#cb203-184" aria-hidden="true" tabindex="-1"></a><span class="st">u'Production (m3)'</span>,</span>
<span id="cb203-185"><a href="#cb203-185" aria-hidden="true" tabindex="-1"></a><span class="st">u'Export/Production'</span>,</span>
<span id="cb203-186"><a href="#cb203-186" aria-hidden="true" tabindex="-1"></a><span class="st">u'CH4_waste/person'</span>,</span>
<span id="cb203-187"><a href="#cb203-187" aria-hidden="true" tabindex="-1"></a><span class="st">u'CH4_(waste+natgas)/person'</span>,</span>
<span id="cb203-188"><a href="#cb203-188" aria-hidden="true" tabindex="-1"></a><span class="st">u'corrected CH4_(waste+natgas)/person'</span>,</span>
<span id="cb203-189"><a href="#cb203-189" aria-hidden="true" tabindex="-1"></a><span class="st">u'data from CIA World Fact Book for 2014'</span></span>
<span id="cb203-190"><a href="#cb203-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-191"><a href="#cb203-191" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb203-192"><a href="#cb203-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-193"><a href="#cb203-193" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> <span class="bu">len</span>(col_order)</span>
<span id="cb203-194"><a href="#cb203-194" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge10.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>166
(343, 166)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>df_merge10<span class="op">=</span>df_merge10[col_order]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove--999" class="level1">
<h1>Remove -999</h1>
<p>Replace with np.nan</p>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'center_of_commerce_index (GEA+)'</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==-</span><span class="dv">999</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'comment_household_size (GEA+)'</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==-</span><span class="dv">999</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'comment_household_size (GEA+)'</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==</span><span class="st">"-999"</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'other_bounded (GEA+)'</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==-</span><span class="dv">999</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'other_bounded (GEA+)'</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==</span><span class="st">"-999"</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'water_bounded (GEA+)'</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==-</span><span class="dv">999</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'household_source (updated) (others)'</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==</span><span class="st">"-999"</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'household_source (updated) (others)'</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==-</span><span class="dv">999</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'household_source (GEA+)'</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==</span><span class="st">"-999"</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>attr <span class="op">=</span> <span class="st">'weather_station_id (GEA+)'</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>df_merge10.loc[df_merge10[attr]<span class="op">==</span><span class="st">"-999"</span>, attr] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-data" class="level1">
<h1>Save data</h1>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span> df_merge10.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(343, 166)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>df_merge10.to_csv(<span class="st">'DATA/INTERMEDIATE_FILES/merged_emissions_and_ancillary_datasets.tsv'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span> , encoding<span class="op">=</span><span class="st">'utf-8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="continue-to-technicalvalidation_qualityflags.ipynb" class="level1">
<h1>Continue to TechnicalValidation_qualityFlags.ipynb</h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>