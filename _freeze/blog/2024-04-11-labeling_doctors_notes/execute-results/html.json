{
  "hash": "090523b4a55f70fbfcb422005f808bd2",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"AI Tutorial: Using Text Embeddings to Label Synthetic Doctor's Notes Generated with ChatGPT\"\nauthor: \"Rebecca Barter\"\nformat:\n  html:\n    toc: true\n    toc-location: left\ncategories: [data science, generative AI, ChatGPT, OpenAI, machine learning]\ndate: 2024-04-11\nimage: img/openai_ehr/doctors_notes_ai.png\ndescription: \"I've been playing around with OpenAI and ChatGPT in my research, and I thought I'd put together a short tutorial that demonstrates using ChatGPT API to generate synthetic doctor's notes, and then using OpenAI's text embedding models to label the notes according to whether they involve a chronic or acute condition. And yes, I'm fully aware that what I write here will probably be out of date in about 3 hours.\"\neditor_options: \n  chunk_output_type: console\n---\n\n<p align=\"center\">\n![](img/openai_ehr/doctors_notes_ai.png){fig-alt='An image created by dall-e-3 using the name of this blog post as the prompt. The image contains a brain in the center connected using circuitry to a code console, with various viruses and other things floating around, and a doctor conducting a medical exam of what seems to be another doctor' width=70% height=70%}\n</p>\n\n> **Warning:** If you're reading this post more than 3 hours after it was posted, some (maybe all) of the information it contains will probably be out of date.\n\n\nHello friends, welcome to the new rapidly evolving world of AI. Even the wacky image that you see at the top of this blog was created using AI (specifically, using dall-e-3), just for this blog post! \n\nLike me, I'm sure you're dwelling on the question of whether AI is going to take all of our jobs. I think, for now, I've settled on the opinion that for those of us who adapt and learn to work *with* AI, our jobs are pretty safe. However, there is no question that AI is going to fundamentally *change* our jobs, hopefully for the better. In my day-to-day I have already found that GitHub Copilot has boosted my coding efficiency, chatGPT has boosted my efficiency for mundane writing tasks, and the various other ways that AI has snuck into my workday are probably helping me out in other ways too. \n\nAnd, as you'll see in this blog post, using the tools provided by OpenAI, NLP tasks like generating synthetic text, and labeling mass amounts of text data are now fairly straightforward too.\n\nIn this blog post, I will walk through an example of generating a small collection of synthetic doctor's notes using chatGPT and then using text OpenAI's embedding models to automatically label these doctor's notes in terms of whether they correspond to a patient experiencing a chronic or an acute event. Fortunately, the [documentation provided on the OpenAI website](https://platform.openai.com/docs/overview) is very good, and that will certainly be the best point of reference. \n\n\n\nNote that, for now, if you want to use these tools effectively, you'll want to be fairly proficient in Python (if you're an R user who is interested in learning Python, check out my [\"An introduction to Python for R Users\"](https://rebeccabarter.com/blog/2023-09-11-from_r_to_python) blog post).\n\n## Getting set up\n\nAs usual, the first thing you'll want to do is to import the libraries you'll need.\n\n::: {#617a0085 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nfrom scipy.spatial.distance import cosine\nfrom openai import OpenAI\n\npd.set_option('display.max_colwidth', None)\n```\n:::\n\n\n\n\nThen you'll need to set up your OpenAI API key. An API key is literally a jumble of letters that OpenAI uses to identify you so that they can track your usage. After you create an OpenAI account, see the [OpenAI API keys website](https://platform.openai.com/api-keys) for information on creating an API key. \n\n\n\nOnce you have created an API key, and you have saved it somewhere on your computer, say in a file called \"api_key.txt\", you will need to use it to connect to the OpenAI client. \n\nTo do this, either create a local variable called `your_key` or read in your key from your text file using code like the following:\n\n::: {#f1308200 .cell execution_count=3}\n``` {.python .cell-code}\nwith open('api_key.txt', 'r') as file:\n  your_key = file.read().strip()\n```\n:::\n\n\nThen you can set up your OpenAI client which is how you will connect to the OpenAI API:\n\n::: {#964ce1d8 .cell execution_count=4}\n``` {.python .cell-code}\n# Define a local variable called `your_key` that contains your OpenAI key.\n# Try really hard to avoid writing your key in your notebook\n# And when you do, try even harder to avoid uploading it to GitHub\nclient = OpenAI(api_key=your_key)\n```\n:::\n\n\nNote that it is **really, really important** that you do not write your API key in plain text in your notebook file, especially if you are going to upload your notebook publicly to GitHub. This would allow someone else to pretend to be you and use your OpenAI account.\n\nInstead, you will want to only ever define your key in a local variable (that is not saved in your code) or load it in from a file that should *not* be uploaded to GitHub!\n\n\nOnce you're set up, let's generate some fake doctor's notes to analyze!\n\n\n## Creating synthetic doctor's notes with chatGPT\n\nThe first thing I did was use chatGPT-4 to create a collection of synthetic doctor's notes.\n\nNote that at the time of writing, you have to pay to access chatGPT-4 through the API. If you don't want to pay OpenAI, you can replace `model=\"gpt-4\"` with `model=\"gpt-3.5-turbo\"`, which is currently free (but is also less good). \n\nThe following code uses chatGPT-4 to generate 50 doctor's notes using the prompt: \n\n> \"Provide a collection of 50 doctors notes that resemble the kind that you would enter into an EHR for your patients on a day-to-day basis. Each note should have around 3 sentences. Each note should appear on a new line. Do not add any numbers or superfluous text.\"\n\n::: {#3acd968d .cell execution_count=5}\n``` {.python .cell-code}\ncompletion = client.chat.completions.create(\n  model=\"gpt-4\",\n  messages=[\n    {\"role\": \"system\", \n     \"content\": \"You are a doctor working in a large hospital.\"},\n    {\"role\": \"user\",\n     \"content\": \"\"\"Provide a collection of 50 doctors notes that \n                   resemble the kind that you would enter into an \n                   EHR for your patients on a day-to-day basis. \n                   Each note should have around 3 sentences. \n                   Each note should appear on a new line.\n                   Do not add any numbers or superfluous text.\"\"\"}\n  ]\n)\n```\n:::\n\n\nThe text created by ChatGPT can be extracted using `completion.choices[0].message.content`. But since this is just one big string value, I want to use the `.split` method to separate each note into a list element.\n\n::: {#a2324cee .cell execution_count=6}\n``` {.python .cell-code}\n# extract the notes and place them in a list, where each list element is detected by the presence of a line break ('\\n')\nnotes_list = completion.choices[0].message.content.split('\\n')\n```\n:::\n\n\nSince the output provided tended to add additional blank lines between the notes (even when I asked it not to), I used the following code to remove any entries in my `notes_list` that contain blank strings:\n\n::: {#e40c54e0 .cell execution_count=7}\n``` {.python .cell-code}\n# remove any empty notes\n# may or may not be required for you\nnotes_list = [note for note in notes_list if note != '']\n# place the notes in a DataFrame\nnotes_df = pd.DataFrame({'notes': notes_list}) \n```\n:::\n\n\n\n\nLet's take a look at the notes it created:\n\n\n\n::: {#4a30dead .cell execution_count=10}\n``` {.python .cell-code}\n# look at the first 5\nnotes_df.head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nHowever, since chatGPT returns a different collection of notes every time, you can load the notes I created above using the following code (if you prefer to follow along with my doctor's notes, that is):\n\n::: {#77c934b2 .cell execution_count=11}\n``` {.python .cell-code}\nnotes_df = pd.read_csv(\"https://raw.githubusercontent.com/rlbarter/personal-website-quarto/main/blog/data/doctors_notes.csv\", index_col=0)\n```\n:::\n\n\nIf you just loaded the notes using the URL above, take a look at the first 5 notes.\n\n::: {#4a76b0ab .cell execution_count=12}\n``` {.python .cell-code}\n# look at the first 5\nnotes_df.head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Computing text embeddings\n\nMy goal in the rest of this post will be to identify whether each note corresponds to a patient with a *chronic* condition (which I define as a condition that they have been experiencing for more than one month) or an *acute* condition (e.g., a new condition). \n\nTo do this, I will use something called **text embeddings**. The idea is that I will use OpenAI's pre-trained text embedding models to embed each note into a numeric 1,536-dimensional that somehow approximately respects semantic distance. \n\nThe equivalent of this in a two-dimensional world would be taking each individual doctor's note and placing it on a scatterplot so that notes that we might intuitively consider to be more \"similar\" to one another are closer together in the plot, and notes that we might consider to be more \"different\" from one another are further apart. Unfortunately, it is unlikely that we would be able to come up with any two quantifiable values that we could use to define the two axes of our scatterplot, such that when we place each note in the scatterplot we achieve our desired property that \"similar\" notes are closer together. But it turns out that once your space has, say, 1,536 dimensions, this task somehow becomes possible (although what each dimension/axis represents is not necessarily going to be meaningful to us). \n\n\nFortunately, OpenAI has already trained some general text embedding models that we can use to embed each of the doctor's notes in such a 1,536-dimensional space. In this post, I will be using the \"*text-embedding-3-small*\" OpenAI model to compute the text embeddings. \n\n\n\n\nAfter computing the embeddings, our task becomes determining how close each doctor's note is to the embedding of the following text: _**\"Patient presenting with ongoing chronic condition defined as ongoing for more than one month\"**_, which I will call the **target**. The closer a note's embedding is to the target's embedding, the more likely the note corresponds to a patient who is presenting with a chronic condition! \n\nI hear you. That sounds crazy, right? But it works... eerily well! Let me show you. \n\nFirst, I need to compute the embeddings for each of the chatGPT-generated doctor's notes. I can do that using this custom function `get_embedding()` function that I literally just copy-and-pasted from the OpenAI documentation:\n\n::: {#743d99c1 .cell execution_count=13}\n``` {.python .cell-code}\ndef get_embedding(text, model=\"text-embedding-3-small\"):\n   text = text.replace(\"\\n\", \" \")\n   return client.embeddings.create(input = [text], model=model).data[0].embedding\n```\n:::\n\n\nThis function basically takes a string `text`, and uses the \"text-embedding-3-small\" model to create a list of 1,536 numbers corresponding to the 1,536-dimensional embedding of the text entry.\n\nFor example, the following code creates an embedding of the text \"hello, how are you\":\n\n::: {#b2a63cff .cell execution_count=14}\n``` {.python .cell-code}\nget_embedding('hello, how are you')\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n[0.020681990310549736,\n -0.03974681720137596,\n -0.000452458014478907,\n 0.029285797849297523,\n -0.013973292894661427,\n -0.059632860124111176,\n 0.0007248803740367293,\n 0.02625361829996109,\n 0.0012578805908560753,\n -0.039999499917030334,\n 0.004143978469073772,\n -0.032242171466350555,\n -0.011370671913027763,\n -0.04505313187837601,\n -0.005956968758255243,\n 0.06473702937364578,\n -0.02131369337439537,\n 0.05190080404281616,\n -0.0056916531175374985,\n 0.02920999377965927,\n 0.058015696704387665,\n 0.01499665342271328,\n 0.009684022516012192,\n 0.04065646976232529,\n 0.0349964015185833,\n 0.025268161669373512,\n 0.023827875033020973,\n 0.01146542839705944,\n 0.02449748106300831,\n -0.017624542117118835,\n 0.05356850102543831,\n -0.03800331428647041,\n 0.012665665708482265,\n 0.013291052542626858,\n 0.002278872299939394,\n 0.013834318146109581,\n -0.0029911184683442116,\n 0.009267098270356655,\n -0.001953544793650508,\n -0.060896266251802444,\n -0.006733964662998915,\n -0.01929224096238613,\n 0.0412629060447216,\n 0.016411669552326202,\n 0.01106745470315218,\n 0.0036165055353194475,\n 0.003145886119455099,\n -0.018572097644209862,\n 0.04836326092481613,\n 0.020088188350200653,\n 0.02371416985988617,\n -0.01297520101070404,\n 0.014529192820191383,\n 0.13715557754039764,\n 0.04500259459018707,\n -0.04282953217625618,\n 0.036563027650117874,\n 0.00012782136036548764,\n 0.005268411710858345,\n 0.03388460353016853,\n 0.002237811451777816,\n -0.04341069981455803,\n 0.01293729804456234,\n 0.027264345437288284,\n -0.0006838195840828121,\n -0.030422866344451904,\n -0.013758513145148754,\n 0.012728836387395859,\n -0.016828594729304314,\n 3.400344212423079e-05,\n 0.02913418971002102,\n 0.04070700705051422,\n -0.008610125631093979,\n -0.018572097644209862,\n -0.03648722544312477,\n 0.016007380560040474,\n -0.0004595646751113236,\n -0.032823339104652405,\n 0.01567889377474785,\n 0.02673371322453022,\n -0.0628671869635582,\n -0.023524656891822815,\n -0.03421308845281601,\n -0.006399161648005247,\n -0.032444316893815994,\n 0.010827407240867615,\n -0.014794507995247841,\n 0.01747293397784233,\n 0.005975920241326094,\n 0.004292428959161043,\n -0.02663264237344265,\n 0.012634080834686756,\n -0.02045457623898983,\n 0.005565312225371599,\n 0.022488662973046303,\n -0.04763048142194748,\n 4.67115496576298e-05,\n 0.02693585865199566,\n 0.036360882222652435,\n -0.00024103456235025078,\n 0.05119329318404198,\n -0.02443431131541729,\n -0.0230319295078516,\n -0.002187275094911456,\n 0.05336635559797287,\n 0.03901404142379761,\n 0.021717984229326248,\n -0.020290333777666092,\n -0.014124901965260506,\n 0.011219063773751259,\n -0.10142640024423599,\n -0.002395737450569868,\n -0.012570910155773163,\n 0.006550770718604326,\n 0.04090915247797966,\n 0.03982262313365936,\n 0.05958232283592224,\n -0.04581117630004883,\n 0.025470305234193802,\n -0.02701166458427906,\n 0.007056133821606636,\n -0.015982111915946007,\n 0.03939306363463402,\n -0.04042905569076538,\n -0.061755385249853134,\n -0.010941113345324993,\n -0.014491289854049683,\n 0.02185695990920067,\n -0.03727053850889206,\n -0.006525502540171146,\n -0.008875441737473011,\n 0.023082464933395386,\n 0.009854583069682121,\n 0.0023704692721366882,\n -0.028376145288348198,\n 0.013152077794075012,\n -0.020745160058140755,\n 0.03964574262499809,\n -0.045659568160772324,\n 0.014327047392725945,\n 0.061654310673475266,\n -0.04992988705635071,\n -0.013632172718644142,\n 0.01441548578441143,\n 0.005697970278561115,\n -0.06215967610478401,\n -0.0039228820241987705,\n 0.04992988705635071,\n 0.010953747667372227,\n -0.014251242391765118,\n 0.03524908423423767,\n 0.012861493974924088,\n -0.0747937560081482,\n 0.023309879004955292,\n 0.002479438204318285,\n 0.008066860027611256,\n 0.030448133125901222,\n -0.021086279302835464,\n -0.023486755788326263,\n 0.03287387639284134,\n 0.013000468723475933,\n 0.0094060730189085,\n -0.03125671669840813,\n -0.04914657399058342,\n -0.029285797849297523,\n 0.00018635268497746438,\n -0.021490570157766342,\n 0.04257684946060181,\n 0.0014047517906874418,\n 0.017422396689653397,\n -0.03153466433286667,\n 0.03924145549535751,\n -0.04664502665400505,\n -0.02923526242375374,\n 0.0100061921402812,\n -0.02749175950884819,\n 0.028805702924728394,\n -0.01360690500587225,\n -0.05020783469080925,\n 0.003398567670956254,\n 0.023865777999162674,\n 0.02221071347594261,\n 0.019608093425631523,\n -0.015249335207045078,\n -0.013291052542626858,\n 0.016310598701238632,\n -0.025167088955640793,\n 0.010656846687197685,\n -0.028199266642332077,\n 0.017460299655795097,\n 0.010770553722977638,\n 0.0555899553000927,\n 0.004349282011389732,\n 0.018799511715769768,\n 0.025697719305753708,\n -0.04399186745285988,\n 0.07878612726926804,\n -0.0081489821895957,\n -0.04550795629620552,\n 0.023385683074593544,\n -0.008824905380606651,\n -0.008212151937186718,\n 0.00013364487676881254,\n -0.02683478593826294,\n 0.0020340869668871164,\n 0.007744691334664822,\n -0.02515445463359356,\n 0.06332200765609741,\n 0.008654344826936722,\n -0.0013494776794686913,\n 0.04816111549735069,\n -0.020568283274769783,\n 0.003951308783143759,\n 0.04667029157280922,\n -0.009046001359820366,\n -0.03171154111623764,\n 0.04404240474104881,\n 0.03380879759788513,\n 0.00862907711416483,\n 0.004924132954329252,\n -0.06377683579921722,\n 0.04295587167143822,\n 0.08070650696754456,\n -0.02221071347594261,\n 0.026278886944055557,\n 0.012071863748133183,\n 0.027087468653917313,\n 0.005540044046938419,\n 0.013316321186721325,\n -0.003521749982610345,\n 0.007605716586112976,\n 0.028780434280633926,\n 0.025621915236115456,\n -0.021440034732222557,\n -0.03997423127293587,\n 0.011484378948807716,\n 0.015779966488480568,\n -0.04282953217625618,\n 0.019140630960464478,\n -0.00490834005177021,\n -0.021819056943058968,\n -0.026657909154891968,\n -0.02341095171868801,\n 0.017510835081338882,\n 0.03393514081835747,\n -0.005634800065308809,\n 0.021149450913071632,\n -0.0350722074508667,\n -0.00835744384676218,\n 0.011901304125785828,\n -0.003910247702151537,\n 0.01939331367611885,\n 0.014781873673200607,\n -0.041338711977005005,\n -0.003625981044024229,\n -0.002013556659221649,\n -0.008231103420257568,\n 0.004658817313611507,\n 0.00835744384676218,\n -0.02357519418001175,\n -0.028881506994366646,\n -0.037523217499256134,\n -0.008104762993752956,\n -0.03054920583963394,\n -0.021149450913071632,\n -0.045836444944143295,\n -0.015552553348243237,\n 0.01571679674088955,\n 0.012002376839518547,\n 0.02059355191886425,\n 0.04214729368686676,\n -0.0374726839363575,\n 0.03459211066365242,\n 0.01058735977858305,\n -0.022981392219662666,\n 0.02759283222258091,\n 0.02728961408138275,\n 0.008679613471031189,\n 0.03075135126709938,\n -0.008603808470070362,\n -0.0325959287583828,\n -0.009791412390768528,\n 0.003357506822794676,\n -0.02835087664425373,\n -0.043056946247816086,\n 0.030877692624926567,\n -0.024901771917939186,\n -0.02213490940630436,\n 0.035678643733263016,\n 0.019191168248653412,\n 0.01446602214127779,\n -0.00023274344857782125,\n -0.002964271232485771,\n -0.028805702924728394,\n 0.0007979211513884366,\n 0.01111799106001854,\n 0.036739904433488846,\n -0.049980420619249344,\n 0.01627269573509693,\n -0.012949932366609573,\n 0.052456703037023544,\n 0.004175563808530569,\n 0.013240516185760498,\n -0.01747293397784233,\n -0.0157546978443861,\n 0.04368865117430687,\n 0.021402131766080856,\n -0.0054516056552529335,\n 0.0010115160839632154,\n 0.0004481150535866618,\n -0.03982262313365936,\n 0.03297495096921921,\n 0.05766194313764572,\n -0.02741595357656479,\n -0.014604996889829636,\n -0.010833724401891232,\n 0.02855302207171917,\n 0.0026926384307444096,\n 0.004750414285808802,\n -0.034263625741004944,\n 0.020201895385980606,\n -0.0313577875494957,\n -0.016866497695446014,\n -0.018812146037817,\n -0.032444316893815994,\n -0.014289145357906818,\n 0.024825967848300934,\n -0.003780748462304473,\n -0.04176827147603035,\n -0.021490570157766342,\n -0.0008843856048770249,\n -0.06908315420150757,\n 0.006279137916862965,\n -0.005394752137362957,\n 0.04414347559213638,\n 0.008717515505850315,\n -0.03236851468682289,\n 0.033303435891866684,\n 0.002240970032289624,\n 0.014920849353075027,\n -0.015186164528131485,\n -0.0399489626288414,\n -0.019936578348279,\n -0.051218561828136444,\n -0.003907089587301016,\n -0.019090095534920692,\n 0.01955755613744259,\n 0.002414688700810075,\n -0.031281981617212296,\n -0.021920129656791687,\n 0.018989022821187973,\n 0.01154754962772131,\n -0.0017545579466968775,\n -0.027643367648124695,\n -0.012659348547458649,\n -0.0206314530223608,\n 0.07332820445299149,\n -0.0028174000326544046,\n -0.013253150507807732,\n 0.025280794128775597,\n 0.0007900248165242374,\n -0.008420614525675774,\n 2.5046078008017503e-05,\n -0.024067923426628113,\n 0.04245050996541977,\n 0.022804515436291695,\n -0.06023929640650749,\n -0.008572223596274853,\n 0.018445758149027824,\n 0.049197107553482056,\n 0.025204990059137344,\n 0.0005176024860702455,\n 0.0021714826580137014,\n 0.03476898744702339,\n -0.06498970836400986,\n 0.02979116141796112,\n 0.037220001220703125,\n 0.004434562288224697,\n 0.0020909402519464493,\n 0.011724426411092281,\n 0.0931384414434433,\n 0.03727053850889206,\n -0.013948025181889534,\n -0.025722987949848175,\n 0.027062200009822845,\n 0.00029196569812484086,\n -0.009791412390768528,\n -0.006696062628179789,\n -0.03974681720137596,\n 0.033758264034986496,\n 0.08611389249563217,\n -0.012867811135947704,\n 0.015514650382101536,\n -0.037801168859004974,\n 0.0338340662419796,\n 0.007668886799365282,\n 0.028022389858961105,\n 0.0259756688028574,\n -0.04942452162504196,\n -0.04308221489191055,\n 0.03171154111623764,\n -0.055135127156972885,\n 0.009551364928483963,\n -0.004949401132762432,\n 0.014807142317295074,\n 0.035880789160728455,\n -0.03792750835418701,\n -0.011105356737971306,\n 0.04760521650314331,\n 0.012166619300842285,\n -0.0026942177210003138,\n -0.05745979771018028,\n 0.03643668815493584,\n 0.060694120824337006,\n -0.010220970958471298,\n -0.018281513825058937,\n -0.027820244431495667,\n -0.02971535734832287,\n -0.0034522623755037785,\n -0.0050504738464951515,\n 0.025167088955640793,\n 0.012318228371441364,\n 0.026607373729348183,\n 0.02683478593826294,\n -0.031004033982753754,\n 0.019026925787329674,\n 0.025760889053344727,\n -0.04502786323428154,\n 0.03600712865591049,\n -0.06888100504875183,\n -0.03355611860752106,\n 0.0016124245012179017,\n 0.009835631586611271,\n 0.014327047392725945,\n 0.009785095229744911,\n -0.017864590510725975,\n 0.02855302207171917,\n 0.015640990808606148,\n 0.013569002039730549,\n 0.003704944159835577,\n 0.029563747346401215,\n -0.027087468653917313,\n -0.037801168859004974,\n -0.048060040920972824,\n -0.009349219501018524,\n -0.01725815422832966,\n 0.004706195089966059,\n 0.020151358097791672,\n -0.01653801091015339,\n -0.012810957618057728,\n -0.039797354489564896,\n 0.03161047026515007,\n 0.013303686864674091,\n 0.018243612721562386,\n 0.00651918537914753,\n 0.01388485450297594,\n -0.027138004079461098,\n -0.006377052050083876,\n 0.017662445083260536,\n -0.005874847527593374,\n -0.0029579540714621544,\n -0.00447878148406744,\n -0.034920599311590195,\n 0.06140163168311119,\n 0.00862907711416483,\n -0.008003690280020237,\n -0.012539324350655079,\n -0.004687243606895208,\n -0.005878006108105183,\n -0.011730743572115898,\n 0.003411201760172844,\n 0.003979735542088747,\n 0.044320352375507355,\n 0.013960658572614193,\n -0.03719473257660866,\n -0.03140832483768463,\n -0.027466490864753723,\n 0.020543014630675316,\n 0.013240516185760498,\n -0.02327197603881359,\n -0.013695343397557735,\n 0.02025243081152439,\n 0.0024004753213375807,\n 0.04816111549735069,\n -0.01360690500587225,\n 0.019519655033946037,\n -0.002253604121506214,\n 0.014832410030066967,\n -0.06049197539687157,\n 0.03178734704852104,\n 0.018129905685782433,\n 0.045634299516677856,\n 0.04022691026329994,\n -0.013695343397557735,\n -0.03676517307758331,\n 0.05013203248381615,\n -0.03724526986479759,\n -0.00802895799279213,\n -0.007321449462324381,\n -0.019759701564908028,\n -0.00988616794347763,\n -0.024585921317338943,\n -0.000546818773727864,\n 0.002975326031446457,\n 0.07534965872764587,\n 0.019987115636467934,\n -0.007908934727311134,\n -0.02797185443341732,\n 0.004289270378649235,\n -0.04237470403313637,\n 0.005915908142924309,\n 0.006209650542587042,\n -0.02289295382797718,\n -0.016222158446907997,\n -0.007005597464740276,\n 0.02595040202140808,\n 0.01771298050880432,\n 0.03219163790345192,\n -0.010239922441542149,\n -0.050814270973205566,\n 0.025647183880209923,\n 0.010378897190093994,\n 0.018824780359864235,\n -0.013392125256359577,\n -0.02563454955816269,\n 0.006449698004871607,\n -0.05948125198483467,\n -0.027921317145228386,\n -0.01785195618867874,\n 0.018167806789278984,\n 0.014693435281515121,\n -0.03727053850889206,\n -0.02776970900595188,\n 0.012596177868545055,\n -0.00855958927422762,\n -0.013569002039730549,\n 0.055893171578645706,\n -0.02739068679511547,\n 0.006822403520345688,\n -0.06468649208545685,\n 0.014314413070678711,\n 0.04141451418399811,\n -0.003040075534954667,\n -0.014377583749592304,\n -0.007902617566287518,\n 0.01255827583372593,\n 0.01733395829796791,\n -0.013720611110329628,\n 0.014554460532963276,\n 0.014440753497183323,\n 0.018951119855046272,\n -0.0007438315078616142,\n -0.015097726136446,\n 0.004245051182806492,\n 0.004570378456264734,\n 0.006569721736013889,\n -0.02741595357656479,\n -0.03168627247214317,\n 0.023688901215791702,\n 0.03547649830579758,\n -0.03229270875453949,\n -0.014743971638381481,\n -0.005846420768648386,\n 0.0059853955172002316,\n 0.006525502540171146,\n 0.04712511971592903,\n -0.0026926384307444096,\n -0.0008496419177390635,\n -0.004990461748093367,\n -0.011692841537296772,\n -0.04543215408921242,\n 0.0009396597160957754,\n -0.013177345506846905,\n -0.08060543239116669,\n 0.03340451046824455,\n 0.007706788834184408,\n 0.00399868655949831,\n 0.021187352016568184,\n -0.02203383669257164,\n 0.016121085733175278,\n -0.012463520281016827,\n -0.03840760514140129,\n -0.022147543728351593,\n 0.0014797666808590293,\n -0.03643668815493584,\n 0.030448133125901222,\n 0.0022630796302109957,\n 0.014655533246695995,\n 0.028856240212917328,\n 0.05250723659992218,\n 0.0012602495262399316,\n -0.0028237169608473778,\n 0.029058385640382767,\n -0.02749175950884819,\n 0.015640990808606148,\n -0.04328436031937599,\n -0.032722268253564835,\n -0.02883097156882286,\n -0.006446539424359798,\n 0.011162210255861282,\n -0.023082464933395386,\n -0.0059032742865383625,\n -0.0058053601533174515,\n -0.0521029494702816,\n 0.02055564895272255,\n -0.003995527978986502,\n -0.019759701564908028,\n 0.009317634627223015,\n -0.024585921317338943,\n -0.049879349768161774,\n -0.021048378199338913,\n -0.003600712865591049,\n 0.01647484116256237,\n -0.04368865117430687,\n 0.0026452606543898582,\n 0.019671263173222542,\n -0.019683897495269775,\n 0.013227881863713264,\n -0.0014758185716345906,\n -0.0006309144082479179,\n -0.042399972677230835,\n 0.009159708395600319,\n 0.016424303874373436,\n 0.021528473123908043,\n 0.03423835709691048,\n 0.01139594055712223,\n -0.018685804679989815,\n -0.019279606640338898,\n -0.03843287378549576,\n 0.016904398798942566,\n 0.01715708151459694,\n 0.01257722731679678,\n 0.00628861365839839,\n -0.01911536417901516,\n -0.008332176133990288,\n -0.012387716211378574,\n 0.0033827750012278557,\n -0.02645576372742653,\n 0.04495205730199814,\n -0.03269699960947037,\n 0.024863870814442635,\n 0.0015310925664380193,\n 0.019443849101662636,\n -0.023448852822184563,\n 0.029816430062055588,\n 0.006396003067493439,\n -0.013922756537795067,\n 0.0100061921402812,\n -0.016386402770876884,\n -0.01237508188933134,\n 0.031105106696486473,\n -0.026379959657788277,\n -0.020025016739964485,\n -0.028502484783530235,\n 0.004845169838517904,\n 0.021098913624882698,\n -0.042197827249765396,\n 0.019848139956593513,\n -0.0049367668107151985,\n 0.0067402818240225315,\n 0.014743971638381481,\n 0.03734634071588516,\n 0.013126809149980545,\n 0.007195108570158482,\n -0.005631641484797001,\n 0.019709166139364243,\n 0.028325608000159264,\n -0.012962566688656807,\n -0.006165431346744299,\n -0.01204659603536129,\n -0.013758513145148754,\n -0.004668292589485645,\n 0.05265884846448898,\n -0.037017855793237686,\n 0.036259811371564865,\n -0.014301778748631477,\n -0.014390217140316963,\n -0.0026373642031103373,\n -0.0060296147130429745,\n -0.023549925535917282,\n -0.03661356493830681,\n 0.018205709755420685,\n -0.034162554889917374,\n -0.002649998292326927,\n 0.0009459767607040703,\n 0.038938235491514206,\n 0.06498970836400986,\n -0.016727522015571594,\n -0.02779497765004635,\n 0.0223370548337698,\n -0.018951119855046272,\n -0.0023657316341996193,\n 0.0200123842805624,\n 0.020429307594895363,\n 0.029487943276762962,\n 0.01567889377474785,\n 0.023284610360860825,\n 0.030827155336737633,\n 0.03724526986479759,\n -0.01245720311999321,\n -0.014339681714773178,\n -0.05020783469080925,\n 0.009159708395600319,\n -0.003430152777582407,\n 0.003888138337060809,\n -0.0002218860317952931,\n -0.028376145288348198,\n 0.017346592620015144,\n 0.023966850712895393,\n 0.05291152745485306,\n -0.017763517796993256,\n 0.015236700884997845,\n -0.0033038121182471514,\n -0.005919066723436117,\n -0.004374550189822912,\n 0.019001657143235207,\n -0.0017719297902658582,\n -0.016790693625807762,\n 0.005116802640259266,\n -0.007984738796949387,\n -0.011503330431878567,\n -0.0035185914020985365,\n -0.03388460353016853,\n -0.026986395940184593,\n 0.005028363782912493,\n -0.02523025870323181,\n -0.03229270875453949,\n -0.021124182268977165,\n 0.013430027291178703,\n -0.013164712116122246,\n 0.010707383044064045,\n -0.0272138100117445,\n 0.01049892045557499,\n 0.02409319207072258,\n 0.020163992419838905,\n 0.012640397064387798,\n -0.009551364928483963,\n -0.00644338084384799,\n -0.03633561357855797,\n -0.029260531067848206,\n -0.008142665028572083,\n 0.015742063522338867,\n 0.020366137847304344,\n 0.0010249398183077574,\n 0.010606310330331326,\n 0.011225380003452301,\n 0.007624667603522539,\n 0.009747193194925785,\n -0.03181261569261551,\n -0.012804640457034111,\n 0.004769365303218365,\n 0.00830690748989582,\n -0.020947305485606194,\n 0.022842416539788246,\n -0.011743377894163132,\n -0.04894442856311798,\n 0.01647484116256237,\n 0.009494511410593987,\n 0.011143258772790432,\n 0.014150169678032398,\n 0.01977233588695526,\n 0.018963754177093506,\n -0.0009965130593627691,\n 0.006702379789203405,\n -0.002929527312517166,\n 0.011452794075012207,\n -0.028856240212917328,\n 0.004219783004373312,\n -0.022867685183882713,\n 0.03294968232512474,\n 0.05508458986878395,\n -0.022349689155817032,\n -0.006557087879627943,\n -0.024901771917939186,\n 0.04502786323428154,\n -0.017447665333747864,\n -0.021819056943058968,\n 0.02011345513164997,\n -0.040681738406419754,\n -0.0010296775726601481,\n 0.022943489253520966,\n 0.019671263173222542,\n -0.0050346809439361095,\n 0.021263157948851585,\n -0.0057074460200965405,\n -0.012090815231204033,\n -0.0011962894350290298,\n -0.012292960658669472,\n 0.029159458354115486,\n -0.0006060410523787141,\n 0.02031560055911541,\n -0.01542621199041605,\n 0.015502016991376877,\n -0.044118206948041916,\n -0.007409888319671154,\n 0.022589735686779022,\n 0.007814179174602032,\n -0.009412390179932117,\n -0.0090586356818676,\n 0.02271607704460621,\n -0.028224535286426544,\n -0.004188197664916515,\n 0.002675266470760107,\n -0.015224066562950611,\n 0.019949212670326233,\n -0.01637376844882965,\n -0.0326717309653759,\n 0.011073771864175797,\n 0.012103448621928692,\n -0.02059355191886425,\n -0.00830690748989582,\n 0.014604996889829636,\n -0.015565186738967896,\n 0.024762798100709915,\n 0.014402851462364197,\n -0.03178734704852104,\n 0.020429307594895363,\n 0.004017637576907873,\n 0.037624292075634,\n 0.00696769542992115,\n 0.057813551276922226,\n 0.016310598701238632,\n -0.032722268253564835,\n 0.004052381496876478,\n 0.0035312254913151264,\n 0.006816086359322071,\n 0.00017786415992304683,\n -0.030726084485650063,\n -0.01891321875154972,\n -0.020126089453697205,\n 0.009715607389807701,\n -0.013948025181889534,\n -0.011332769878208637,\n -0.00497782789170742,\n 0.0064812833443284035,\n 0.03570391237735748,\n -0.013177345506846905,\n -0.002182537456974387,\n -0.015552553348243237,\n -0.013442661613225937,\n 0.002740016207098961,\n -0.017182350158691406,\n 0.0411112979054451,\n -0.008654344826936722,\n -0.01685386337339878,\n 0.041237637400627136,\n 0.006301247514784336,\n -0.036840979009866714,\n 0.003932357300072908,\n 0.009980923496186733,\n -0.005675860680639744,\n 0.02089676819741726,\n 0.06493917107582092,\n 0.01785195618867874,\n -0.009153391234576702,\n 0.007460424676537514,\n -0.029083652421832085,\n -0.014200706034898758,\n 0.035602837800979614,\n -0.018989022821187973,\n -0.017750883474946022,\n 0.022021202370524406,\n 0.03292441368103027,\n -0.005682177841663361,\n 0.017359226942062378,\n -0.01637376844882965,\n -0.00912812352180481,\n -0.016007380560040474,\n -0.016121085733175278,\n 0.027744440361857414,\n -0.02701166458427906,\n 0.0036607247311621904,\n -0.02069462463259697,\n -0.024990210309624672,\n 0.02817399986088276,\n 0.03666410222649574,\n -0.04495205730199814,\n 0.005634800065308809,\n -0.03342977538704872,\n -0.020568283274769783,\n 0.033859334886074066,\n -0.0026547361630946398,\n 0.010113581083714962,\n 0.014781873673200607,\n 0.007371985819190741,\n -0.004090283531695604,\n 0.038255997002124786,\n 0.03350558131933212,\n -0.0020656720735132694,\n 0.016209525987505913,\n 0.033859334886074066,\n -0.0010202019475400448,\n -0.010922162793576717,\n -0.001951965386979282,\n 0.013910122215747833,\n -0.00596328591927886,\n -0.05569102615118027,\n -0.0019803920295089483,\n -0.021010475233197212,\n 0.00425452645868063,\n -0.0124256182461977,\n 0.003106404561549425,\n -0.03075135126709938,\n -0.022905588150024414,\n 0.003079557092860341,\n 0.01771298050880432,\n 0.004879913758486509,\n 0.01921643689274788,\n 0.011762328445911407,\n -0.006784501019865274,\n -0.025520842522382736,\n -0.03901404142379761,\n 0.033202365040779114,\n 0.03651249408721924,\n -0.01949438638985157,\n 0.056853361427783966,\n -0.015363042242825031,\n 0.015312505885958672,\n 0.0073530348017811775,\n -0.015186164528131485,\n -0.004355599172413349,\n 0.008591175079345703,\n 0.00958926696330309,\n 0.011534915305674076,\n 0.020985208451747894,\n -0.01925433799624443,\n -0.02549557387828827,\n 0.026127278804779053,\n -0.0447499118745327,\n 0.01547674834728241,\n -0.0005452395416796207,\n 0.034920599311590195,\n -0.0223370548337698,\n 0.030245987698435783,\n 0.04232417047023773,\n 0.015742063522338867,\n -0.007100353017449379,\n 0.018850047141313553,\n -0.019418582320213318,\n -0.021528473123908043,\n -0.018925853073596954,\n 0.025242893025279045,\n 0.018951119855046272,\n 0.031105106696486473,\n 0.03782643750309944,\n 0.014213340356945992,\n -0.0230319295078516,\n 0.0040207961574196815,\n 0.0049367668107151985,\n -0.013733245432376862,\n -0.010170434601604939,\n 0.03380879759788513,\n 0.008660661987960339,\n 0.02573562227189541,\n -0.01134540420025587,\n -0.025861961767077446,\n 0.049980420619249344,\n -0.005249460227787495,\n 0.010890576988458633,\n 0.03858448192477226,\n -0.014743971638381481,\n -0.011263282969594002,\n -0.022589735686779022,\n -0.003392250509932637,\n -0.02824980393052101,\n 0.008869124576449394,\n -0.00402395473793149,\n 0.00573271419852972,\n 0.0229561235755682,\n 0.0387108214199543,\n -0.022084372118115425,\n 0.003357506822794676,\n 0.008534321561455727,\n -0.007409888319671154,\n 0.027163272723555565,\n -0.01154754962772131,\n 0.007270913105458021,\n 0.016045281663537025,\n 0.025647183880209923,\n -0.014263876713812351,\n 0.03254539147019386,\n 0.025242893025279045,\n 0.03461737930774689,\n 0.014478656463325024,\n -0.036461956799030304,\n 0.00034664757549762726,\n 0.0006245973636396229,\n 0.026102010160684586,\n -0.013316321186721325,\n -0.012261374853551388,\n 0.004469305742532015,\n -0.011768645606935024,\n 0.02317090332508087,\n 0.02327197603881359,\n -0.011206429451704025,\n -0.01527460291981697,\n -0.00888807512819767,\n -0.02693585865199566,\n 0.017308689653873444,\n 0.006279137916862965,\n ...]\n```\n:::\n:::\n\n\nNext, I can apply this function to each of the notes stored in the `notes` column of the `notes_df` DataFrame, and save it in a new column of the DataFrame called `embedding`:\n\n::: {#37e646e5 .cell execution_count=15}\n``` {.python .cell-code}\nnotes_df['embedding'] = notes_df['notes'].apply(lambda x: get_embedding(x))\n```\n:::\n\n\nBelow, I show the first 5 rows. You can see that there is a new column containing a collection of 1,536-length lists corresponding to the note's embedding.\n\n::: {#a766c6a6 .cell execution_count=16}\n``` {.python .cell-code}\nnotes_df.head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>embedding</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n      <td>[0.007875490933656693, -0.0006737920339219272, -0.048676371574401855, 0.016742711886763573, -0.01964789256453514, 0.007379627320915461, -0.0036548112984746695, 0.01582098752260208, -0.00981811247766018, 0.05731024220585823, -0.05661020055413246, 0.05338999629020691, -0.0089722266420722, 0.005787027534097433, 0.009333916008472443, 0.002053461503237486, 0.020791297778487206, -0.013055814430117607, -0.03626226261258125, 0.06151050329208374, -0.0013227908639237285, 0.06081046164035797, 0.021164653822779655, 0.0037043977063149214, -0.004646540153771639, 0.009497258812189102, 0.006889596581459045, -0.02360313944518566, 0.04398607835173607, -0.06272391229867935, 0.02380148507654667, -0.01809612847864628, 0.003272704314440489, -0.017582762986421585, 0.030848590657114983, 0.023124776780605316, 0.022611411288380623, -0.046296220272779465, -0.006352896336466074, -0.006597911473363638, -0.023031437769532204, -0.01648602820932865, -0.01208742056041956, -0.006551241967827082, -0.030731918290257454, 0.0008546366589143872, 0.04699626564979553, -0.018119463697075844, 0.004751546308398247, -0.02417484112083912, 0.010763171128928661, -0.026694998145103455, 0.006452069152146578, 0.008348020724952221, 0.010535657405853271, 0.02921515703201294, 0.02755838632583618, 0.012624121271073818, -0.013405836187303066, 0.0015488466015085578, 0.0514298751950264, -0.03217867389321327, 0.02334645763039589, 0.013347499072551727, -0.004766130819916725, -0.013499175198376179, 0.03761567920446396, 0.01333583239465952, 0.026461651548743248, 0.010774838738143444, 0.006154550705105066, -0.028328433632850647, 0.025574930012226105, 0.003345625475049019, -0.025994954630732536, 0.04412608593702316, 0.019204530864953995, -0.041139233857393265, 0.024034833535552025, 0.014700917527079582, 0.0011288204696029425, -0.012075753882527351, 0.043052684515714645, -0.0011660102754831314, -0.023159777745604515, -0.05987706780433655, -0.033765438944101334, -0.023778149858117104, 0.027441712096333504, -0.031735312193632126, 0.031525298953056335, 0.03994916006922722, 0.006761255208402872, -0.028771795332431793, -0.013347499072551727, -0.02634497731924057, 0.02550492435693741, 0.02359147183597088, -0.03294872120022774, 0.03000853955745697, ...]</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n      <td>[-0.0345405712723732, -0.010776856914162636, -0.010913430713117123, 0.01344623975455761, -0.0371975414454937, 0.01843736506998539, 0.022373152896761894, -0.01380629651248455, 0.06128406524658203, -0.0055250017903745174, -0.02246006391942501, 0.03488821163773537, -0.060837097465991974, 0.019294051453471184, -0.005022164434194565, 0.017419274896383286, 0.014824386686086655, -0.016761241480708122, -0.030120572075247765, 0.0056708864867687225, 0.036700911819934845, 0.03622911125421524, -0.006679664831608534, -0.0573606938123703, 0.024992873892188072, 0.01998933218419552, 0.030319223180413246, -0.023142928257584572, 0.029872257262468338, -0.03113866224884987, 0.004680731799453497, -0.020436298102140427, 0.014042195864021778, -0.020846018567681313, -0.02521635591983795, 0.04705563187599182, 0.04226315766572952, 0.006909355986863375, -0.010733402334153652, -0.015283768996596336, -0.006704496685415506, -0.02394995093345642, 0.01163354329764843, -0.01688539795577526, -0.030865514650940895, -0.037445854395627975, -0.023502985015511513, -0.040425632148981094, 0.07345148175954819, 0.03406877443194389, -0.022149669006466866, 0.016016297042369843, 0.0220627598464489, -0.022075176239013672, 0.038935743272304535, -0.040624283254146576, 0.05368563532829285, 0.010013289749622345, -0.003945099655538797, 0.031188324093818665, 0.03250439092516899, 0.03357214480638504, 0.04186585545539856, 0.007896406576037407, 0.0016187013825401664, -0.0722595751285553, 0.01103137992322445, 0.01600388064980507, 0.008777923882007599, 0.043728217482566833, -0.005543625447899103, 0.010950678028166294, 0.005773316603153944, 0.05368563532829285, 0.01149076223373413, 0.024744559079408646, 0.006235802546143532, -0.028754839673638344, -0.00626994576305151, 0.009876716881990433, -0.02686764858663082, 0.006273049861192703, 0.009839469566941261, 0.046385183930397034, 0.0031737720128148794, -0.02080877125263214, -0.047105297446250916, -0.06217799708247185, 0.01106862723827362, -0.05676473677158356, 0.021963434293866158, -0.0022767353802919388, -0.00857306458055973, 0.015159611590206623, 0.005546729080379009, -0.050954174250364304, -0.0011461274698376656, 0.02709113247692585, -0.00894553679972887, 0.04352956265211105, ...]</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n      <td>[-0.017208361998200417, 0.006888406351208687, -0.005633207969367504, 0.04822390526533127, -0.014728333801031113, 0.025873279199004173, -0.03370814397931099, -0.0009527865331619978, 0.03423452004790306, -0.010254159569740295, -0.04486321285367012, -0.008685161359608173, 0.01806878112256527, 0.019941454753279686, 0.028039507567882538, 0.016347944736480713, 0.0295174028724432, -0.05652441084384918, -0.020892975851893425, 0.009252025745809078, 0.053163718432188034, 0.015467280521988869, 0.02342361770570278, -0.0332222618162632, 0.04615890234708786, -0.051422636955976486, 0.01870650239288807, -0.00034986119135282934, -0.023038960993289948, -0.024010727182030678, 0.047697532922029495, -0.0066960775293409824, 0.03565167635679245, -0.026075730100274086, -0.035894621163606644, 0.06778070330619812, 0.03374863415956497, 0.0055269212462008, -0.015720345079898834, -0.02858612686395645, 0.009727786295115948, 0.024597834795713425, 0.019010178744792938, -0.020235009491443634, -0.007941152900457382, 0.025245679542422295, 0.008472587913274765, -0.02548862062394619, 0.02113591879606247, 0.0035783271305263042, 0.0027204395737499, 0.03320201858878136, 0.021115673705935478, -0.01451575942337513, 0.006088723428547382, -0.05980411916971207, -0.02872784249484539, -0.0322909876704216, 0.03806084766983986, 0.025144454091787338, 0.004529848229140043, 0.03957923501729965, 0.06259794533252716, 0.05907529592514038, -0.010821023024618626, -0.07883454114198685, 0.05713176354765892, 0.040915410965681076, 0.044458311051130295, -0.02583278901875019, 0.013078355230391026, 0.02773583121597767, -0.010238975286483765, 0.02148008532822132, 0.07474502921104431, 0.00839666835963726, 0.08215474337339401, -0.026865290477871895, 0.010861513204872608, -0.0009135616128332913, 0.004243885632604361, 0.019081037491559982, 0.005435817874968052, 0.03941727057099342, 0.014819436706602573, 0.02615671046078205, -0.0274321548640728, -0.034760892391204834, 0.02696651592850685, 0.00028643698897212744, 0.001967573771253228, 0.011448622681200504, 0.04247428849339485, -0.0023927215952426195, -0.006756812799721956, -0.03441672399640083, 0.001920756883919239, 0.03672466799616814, -0.031015543267130852, 0.02471930719912052, ...]</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n      <td>[-0.01908160373568535, -0.007425420451909304, 0.017478106543421745, 0.0633997693657875, -0.03739846125245094, 0.0564923994243145, -0.014924848452210426, 0.03949534147977829, -0.022670967504382133, -0.008227168582379818, 0.0023235275875777006, 0.01861288957297802, -0.05338408425450325, 0.021585524082183838, 0.032809995114803314, 0.0043664430268108845, 0.05175592005252838, -0.01282796822488308, -0.01846487447619438, 0.010040352120995522, -0.01032404787838459, -0.01255044061690569, 0.03727511689066887, -0.03327871114015579, -0.01349403616040945, -0.02069743350148201, 0.026494689285755157, -0.05005374550819397, 0.042801011353731155, -0.04746348410844803, 0.04080280661582947, -0.02429913356900215, 0.025137884542346, 0.0548148974776268, -0.005189776886254549, -0.0036479535046964884, 0.0019658245146274567, -0.0015927032800391316, 0.022905325517058372, 0.0035554443020373583, -0.0008025189745239913, -0.028912268579006195, -0.020956460386514664, 0.0659160241484642, -0.03490687534213066, 0.02893693745136261, 0.017613787204027176, -0.03764515370130539, 0.0155539121478796, 0.02130182832479477, -0.019982028752565384, 0.010428891517221928, -0.023115012794733047, 0.019328294321894646, 0.03290867432951927, 0.015183874405920506, 0.03014572709798813, 0.020487746223807335, -0.007838629186153412, 0.031132493168115616, 0.014184772968292236, -0.013975084759294987, 0.022300930693745613, 0.025729944929480553, -0.04578598216176033, -0.02073443867266178, 0.015072863548994064, -0.011446495540440083, 0.03140385448932648, 0.021425174549221992, -0.014949517324566841, -0.030022380873560905, -0.030269071459770203, 0.05358143895864487, -0.0035708623472601175, -0.022892991080880165, -0.005436468403786421, -0.03009638749063015, -0.003157653845846653, 0.055308278650045395, -0.029603004455566406, -0.02204190380871296, -0.009065920487046242, 0.04381244629621506, 0.009756657294929028, -0.06902433931827545, 0.0014246446080505848, 9.824304288486019e-05, -0.005482723005115986, -0.08269105851650238, 0.0053686280734837055, 0.005710912868380547, -0.0006240529473870993, 0.004471287131309509, -0.03041708655655384, 0.003200824838131666, -0.04183891415596008, 0.03251396492123604, -0.0017438019858673215, -0.0027629469987004995, ...]</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n      <td>[-0.010823288932442665, 0.03450469672679901, -0.0003536372387316078, 0.01706509292125702, -0.033481039106845856, 0.030859481543302536, -0.00017135703819803894, 0.05228135362267494, -0.010186624713242054, 0.017614372074604034, 0.003529740497469902, 0.021334487944841385, -0.02444290742278099, 0.054828010499477386, -0.012496092356741428, -0.005037136375904083, 0.008351534605026245, -0.02938641607761383, -0.005436611827462912, 0.02893700636923313, 0.03158353269100189, 0.06366640329360962, 0.05123273283243179, 0.015329872258007526, 0.0488358773291111, 0.01000561285763979, 0.010242801159620285, -0.041695255786180496, 0.03263215348124504, -0.022308209910988808, 0.02629048004746437, -0.00510579627007246, -0.018038814887404442, 0.03467946499586105, -0.005889142397791147, 0.022645266726613045, 0.025504013523459435, -0.004253789782524109, -0.013145240023732185, -0.0078896414488554, 0.016728036105632782, -0.020210962742567062, 0.016815422102808952, 0.01926220953464508, -0.015641963109374046, -0.046139419078826904, 0.02104736492037773, -0.03822481259703636, 0.051582273095846176, 0.006853501312434673, -0.039173565804958344, 0.012858116999268532, 0.02134697139263153, 0.013245109468698502, 0.014643273316323757, -0.010473747737705708, 0.003486047964543104, -0.024005981162190437, 0.06111975014209747, 0.02057298831641674, 0.052980437874794006, -0.003170836716890335, 0.02688969485461712, 0.030260268598794937, -0.03732599318027496, -0.037800367921590805, 0.03233254700899124, -0.04114597663283348, 0.06072027608752251, -0.013956675305962563, -0.019536849111318588, 0.005062103737145662, 0.04409210756421089, 0.004054052289575338, 0.008794702589511871, -0.013170207850635052, 0.05472814291715622, -0.06970847398042679, -0.025416627526283264, 0.05397912487387657, -0.0226327832788229, 0.025591399520635605, 0.008863362483680248, 0.04014728590846062, -0.012508576735854149, -0.05412892997264862, -0.029186679050326347, -0.03198300674557686, -0.015254970639944077, -0.03430495783686638, -0.024230685085058212, 0.012764490209519863, 0.010411330498754978, 0.012957986444234848, -0.016128823161125183, -0.012021715752780437, 0.015854183584451675, 0.00357655412517488, -0.015666930004954338, 0.02527930773794651, ...]</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nSince I will want to compute the cosine distance to the \"target\" (*\"Patient presenting with ongoing chronic condition defined as ongoing for more than one month\"*), I will also need to compute the embedding of the label. \n\n::: {#64fc6f16 .cell execution_count=17}\n``` {.python .cell-code}\ntarget = 'Patient presenting with ongoing chronic condition defined as ongoing for more than one month'\n# Compute embedding of the target\ntarget_embedding = get_embedding(target)\n```\n:::\n\n\n## Computing the cosine distance from the target\n\nNow that I have all of my embeddings, I need to compute the *cosine distance* from each doctor's note's embedding to this target embedding. Below, I compute and save this cosine distance in a new column of `notes_df` called `cosine_dist` (note that a *lower* `cosine_dist` value corresponds to a doctor's note that is more similar to the target: *\"Patient presenting with ongoing chronic condition defined as ongoing for more than one month\"*). \n\n::: {#c472bd7e .cell execution_count=18}\n``` {.python .cell-code}\nnotes_df['cosine_dist'] = notes_df.embedding.apply(lambda x: cosine(x, target_embedding))\n```\n:::\n\n\nYou can see that the final column in `notes_df` is now the cosine distance:\n\n::: {#2824d660 .cell execution_count=19}\n``` {.python .cell-code}\nnotes_df.head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>embedding</th>\n      <th>cosine_dist</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n      <td>[0.007875490933656693, -0.0006737920339219272, -0.048676371574401855, 0.016742711886763573, -0.01964789256453514, 0.007379627320915461, -0.0036548112984746695, 0.01582098752260208, -0.00981811247766018, 0.05731024220585823, -0.05661020055413246, 0.05338999629020691, -0.0089722266420722, 0.005787027534097433, 0.009333916008472443, 0.002053461503237486, 0.020791297778487206, -0.013055814430117607, -0.03626226261258125, 0.06151050329208374, -0.0013227908639237285, 0.06081046164035797, 0.021164653822779655, 0.0037043977063149214, -0.004646540153771639, 0.009497258812189102, 0.006889596581459045, -0.02360313944518566, 0.04398607835173607, -0.06272391229867935, 0.02380148507654667, -0.01809612847864628, 0.003272704314440489, -0.017582762986421585, 0.030848590657114983, 0.023124776780605316, 0.022611411288380623, -0.046296220272779465, -0.006352896336466074, -0.006597911473363638, -0.023031437769532204, -0.01648602820932865, -0.01208742056041956, -0.006551241967827082, -0.030731918290257454, 0.0008546366589143872, 0.04699626564979553, -0.018119463697075844, 0.004751546308398247, -0.02417484112083912, 0.010763171128928661, -0.026694998145103455, 0.006452069152146578, 0.008348020724952221, 0.010535657405853271, 0.02921515703201294, 0.02755838632583618, 0.012624121271073818, -0.013405836187303066, 0.0015488466015085578, 0.0514298751950264, -0.03217867389321327, 0.02334645763039589, 0.013347499072551727, -0.004766130819916725, -0.013499175198376179, 0.03761567920446396, 0.01333583239465952, 0.026461651548743248, 0.010774838738143444, 0.006154550705105066, -0.028328433632850647, 0.025574930012226105, 0.003345625475049019, -0.025994954630732536, 0.04412608593702316, 0.019204530864953995, -0.041139233857393265, 0.024034833535552025, 0.014700917527079582, 0.0011288204696029425, -0.012075753882527351, 0.043052684515714645, -0.0011660102754831314, -0.023159777745604515, -0.05987706780433655, -0.033765438944101334, -0.023778149858117104, 0.027441712096333504, -0.031735312193632126, 0.031525298953056335, 0.03994916006922722, 0.006761255208402872, -0.028771795332431793, -0.013347499072551727, -0.02634497731924057, 0.02550492435693741, 0.02359147183597088, -0.03294872120022774, 0.03000853955745697, ...]</td>\n      <td>0.697187</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n      <td>[-0.0345405712723732, -0.010776856914162636, -0.010913430713117123, 0.01344623975455761, -0.0371975414454937, 0.01843736506998539, 0.022373152896761894, -0.01380629651248455, 0.06128406524658203, -0.0055250017903745174, -0.02246006391942501, 0.03488821163773537, -0.060837097465991974, 0.019294051453471184, -0.005022164434194565, 0.017419274896383286, 0.014824386686086655, -0.016761241480708122, -0.030120572075247765, 0.0056708864867687225, 0.036700911819934845, 0.03622911125421524, -0.006679664831608534, -0.0573606938123703, 0.024992873892188072, 0.01998933218419552, 0.030319223180413246, -0.023142928257584572, 0.029872257262468338, -0.03113866224884987, 0.004680731799453497, -0.020436298102140427, 0.014042195864021778, -0.020846018567681313, -0.02521635591983795, 0.04705563187599182, 0.04226315766572952, 0.006909355986863375, -0.010733402334153652, -0.015283768996596336, -0.006704496685415506, -0.02394995093345642, 0.01163354329764843, -0.01688539795577526, -0.030865514650940895, -0.037445854395627975, -0.023502985015511513, -0.040425632148981094, 0.07345148175954819, 0.03406877443194389, -0.022149669006466866, 0.016016297042369843, 0.0220627598464489, -0.022075176239013672, 0.038935743272304535, -0.040624283254146576, 0.05368563532829285, 0.010013289749622345, -0.003945099655538797, 0.031188324093818665, 0.03250439092516899, 0.03357214480638504, 0.04186585545539856, 0.007896406576037407, 0.0016187013825401664, -0.0722595751285553, 0.01103137992322445, 0.01600388064980507, 0.008777923882007599, 0.043728217482566833, -0.005543625447899103, 0.010950678028166294, 0.005773316603153944, 0.05368563532829285, 0.01149076223373413, 0.024744559079408646, 0.006235802546143532, -0.028754839673638344, -0.00626994576305151, 0.009876716881990433, -0.02686764858663082, 0.006273049861192703, 0.009839469566941261, 0.046385183930397034, 0.0031737720128148794, -0.02080877125263214, -0.047105297446250916, -0.06217799708247185, 0.01106862723827362, -0.05676473677158356, 0.021963434293866158, -0.0022767353802919388, -0.00857306458055973, 0.015159611590206623, 0.005546729080379009, -0.050954174250364304, -0.0011461274698376656, 0.02709113247692585, -0.00894553679972887, 0.04352956265211105, ...]</td>\n      <td>0.583531</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n      <td>[-0.017208361998200417, 0.006888406351208687, -0.005633207969367504, 0.04822390526533127, -0.014728333801031113, 0.025873279199004173, -0.03370814397931099, -0.0009527865331619978, 0.03423452004790306, -0.010254159569740295, -0.04486321285367012, -0.008685161359608173, 0.01806878112256527, 0.019941454753279686, 0.028039507567882538, 0.016347944736480713, 0.0295174028724432, -0.05652441084384918, -0.020892975851893425, 0.009252025745809078, 0.053163718432188034, 0.015467280521988869, 0.02342361770570278, -0.0332222618162632, 0.04615890234708786, -0.051422636955976486, 0.01870650239288807, -0.00034986119135282934, -0.023038960993289948, -0.024010727182030678, 0.047697532922029495, -0.0066960775293409824, 0.03565167635679245, -0.026075730100274086, -0.035894621163606644, 0.06778070330619812, 0.03374863415956497, 0.0055269212462008, -0.015720345079898834, -0.02858612686395645, 0.009727786295115948, 0.024597834795713425, 0.019010178744792938, -0.020235009491443634, -0.007941152900457382, 0.025245679542422295, 0.008472587913274765, -0.02548862062394619, 0.02113591879606247, 0.0035783271305263042, 0.0027204395737499, 0.03320201858878136, 0.021115673705935478, -0.01451575942337513, 0.006088723428547382, -0.05980411916971207, -0.02872784249484539, -0.0322909876704216, 0.03806084766983986, 0.025144454091787338, 0.004529848229140043, 0.03957923501729965, 0.06259794533252716, 0.05907529592514038, -0.010821023024618626, -0.07883454114198685, 0.05713176354765892, 0.040915410965681076, 0.044458311051130295, -0.02583278901875019, 0.013078355230391026, 0.02773583121597767, -0.010238975286483765, 0.02148008532822132, 0.07474502921104431, 0.00839666835963726, 0.08215474337339401, -0.026865290477871895, 0.010861513204872608, -0.0009135616128332913, 0.004243885632604361, 0.019081037491559982, 0.005435817874968052, 0.03941727057099342, 0.014819436706602573, 0.02615671046078205, -0.0274321548640728, -0.034760892391204834, 0.02696651592850685, 0.00028643698897212744, 0.001967573771253228, 0.011448622681200504, 0.04247428849339485, -0.0023927215952426195, -0.006756812799721956, -0.03441672399640083, 0.001920756883919239, 0.03672466799616814, -0.031015543267130852, 0.02471930719912052, ...]</td>\n      <td>0.748090</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n      <td>[-0.01908160373568535, -0.007425420451909304, 0.017478106543421745, 0.0633997693657875, -0.03739846125245094, 0.0564923994243145, -0.014924848452210426, 0.03949534147977829, -0.022670967504382133, -0.008227168582379818, 0.0023235275875777006, 0.01861288957297802, -0.05338408425450325, 0.021585524082183838, 0.032809995114803314, 0.0043664430268108845, 0.05175592005252838, -0.01282796822488308, -0.01846487447619438, 0.010040352120995522, -0.01032404787838459, -0.01255044061690569, 0.03727511689066887, -0.03327871114015579, -0.01349403616040945, -0.02069743350148201, 0.026494689285755157, -0.05005374550819397, 0.042801011353731155, -0.04746348410844803, 0.04080280661582947, -0.02429913356900215, 0.025137884542346, 0.0548148974776268, -0.005189776886254549, -0.0036479535046964884, 0.0019658245146274567, -0.0015927032800391316, 0.022905325517058372, 0.0035554443020373583, -0.0008025189745239913, -0.028912268579006195, -0.020956460386514664, 0.0659160241484642, -0.03490687534213066, 0.02893693745136261, 0.017613787204027176, -0.03764515370130539, 0.0155539121478796, 0.02130182832479477, -0.019982028752565384, 0.010428891517221928, -0.023115012794733047, 0.019328294321894646, 0.03290867432951927, 0.015183874405920506, 0.03014572709798813, 0.020487746223807335, -0.007838629186153412, 0.031132493168115616, 0.014184772968292236, -0.013975084759294987, 0.022300930693745613, 0.025729944929480553, -0.04578598216176033, -0.02073443867266178, 0.015072863548994064, -0.011446495540440083, 0.03140385448932648, 0.021425174549221992, -0.014949517324566841, -0.030022380873560905, -0.030269071459770203, 0.05358143895864487, -0.0035708623472601175, -0.022892991080880165, -0.005436468403786421, -0.03009638749063015, -0.003157653845846653, 0.055308278650045395, -0.029603004455566406, -0.02204190380871296, -0.009065920487046242, 0.04381244629621506, 0.009756657294929028, -0.06902433931827545, 0.0014246446080505848, 9.824304288486019e-05, -0.005482723005115986, -0.08269105851650238, 0.0053686280734837055, 0.005710912868380547, -0.0006240529473870993, 0.004471287131309509, -0.03041708655655384, 0.003200824838131666, -0.04183891415596008, 0.03251396492123604, -0.0017438019858673215, -0.0027629469987004995, ...]</td>\n      <td>0.644881</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n      <td>[-0.010823288932442665, 0.03450469672679901, -0.0003536372387316078, 0.01706509292125702, -0.033481039106845856, 0.030859481543302536, -0.00017135703819803894, 0.05228135362267494, -0.010186624713242054, 0.017614372074604034, 0.003529740497469902, 0.021334487944841385, -0.02444290742278099, 0.054828010499477386, -0.012496092356741428, -0.005037136375904083, 0.008351534605026245, -0.02938641607761383, -0.005436611827462912, 0.02893700636923313, 0.03158353269100189, 0.06366640329360962, 0.05123273283243179, 0.015329872258007526, 0.0488358773291111, 0.01000561285763979, 0.010242801159620285, -0.041695255786180496, 0.03263215348124504, -0.022308209910988808, 0.02629048004746437, -0.00510579627007246, -0.018038814887404442, 0.03467946499586105, -0.005889142397791147, 0.022645266726613045, 0.025504013523459435, -0.004253789782524109, -0.013145240023732185, -0.0078896414488554, 0.016728036105632782, -0.020210962742567062, 0.016815422102808952, 0.01926220953464508, -0.015641963109374046, -0.046139419078826904, 0.02104736492037773, -0.03822481259703636, 0.051582273095846176, 0.006853501312434673, -0.039173565804958344, 0.012858116999268532, 0.02134697139263153, 0.013245109468698502, 0.014643273316323757, -0.010473747737705708, 0.003486047964543104, -0.024005981162190437, 0.06111975014209747, 0.02057298831641674, 0.052980437874794006, -0.003170836716890335, 0.02688969485461712, 0.030260268598794937, -0.03732599318027496, -0.037800367921590805, 0.03233254700899124, -0.04114597663283348, 0.06072027608752251, -0.013956675305962563, -0.019536849111318588, 0.005062103737145662, 0.04409210756421089, 0.004054052289575338, 0.008794702589511871, -0.013170207850635052, 0.05472814291715622, -0.06970847398042679, -0.025416627526283264, 0.05397912487387657, -0.0226327832788229, 0.025591399520635605, 0.008863362483680248, 0.04014728590846062, -0.012508576735854149, -0.05412892997264862, -0.029186679050326347, -0.03198300674557686, -0.015254970639944077, -0.03430495783686638, -0.024230685085058212, 0.012764490209519863, 0.010411330498754978, 0.012957986444234848, -0.016128823161125183, -0.012021715752780437, 0.015854183584451675, 0.00357655412517488, -0.015666930004954338, 0.02527930773794651, ...]</td>\n      <td>0.688291</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nAnd that's it! Let's take a look at the notes in order of smallest to largest `cosine_dist`. \n\nIdeally, I will see that the notes at the top of the rearranged DataFrame correspond to patients with chronic conditions, and the notes at the bottom correspond to patients with acute conditions.\n\nThe top 5 notes are:\n\n::: {#12207d28 .cell execution_count=20}\n``` {.python .cell-code}\npd.set_option('display.max_colwidth', None)\nnotes_df.sort_values('cosine_dist')[['notes', 'cosine_dist']].head(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>cosine_dist</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>43</th>\n      <td>Patient with chronic bronchitis showed increasingly frequent flare-ups. Reinforced importance of smoking cessation and upgraded prescribed inhalers.</td>\n      <td>0.483188</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Patient visited for follow-up on hypertension medication. Blood pressure readings stable. Emphasized continued adherence to treatment.</td>\n      <td>0.547638</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Patient reported persistent cough and difficulty breathing. Referred for radiological imaging to rule out pneumonia or tuberculosis.</td>\n      <td>0.550634</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Patient with a history of heart disease complained of palpitations. Recommended further cardiology work-up and emphasized continued adherence to treatment.</td>\n      <td>0.558663</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Chronic back pain patient showed improvement after physiotherapy. Recommended continuing sessions and daily exercises at home.</td>\n      <td>0.565519</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThose all seem like patients with chronic conditions to me!\n\nAnd the bottom 5 notes are:\n\n::: {#5fc2f589 .cell execution_count=21}\n``` {.python .cell-code}\nnotes_df.sort_values('cosine_dist')[['notes', 'cosine_dist']].tail(5)\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>cosine_dist</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>39</th>\n      <td>Child patient presented with red, itchy eyes. Diagnosed as viral conjunctivitis. Instructed parents about proper eye care and hand hygiene.</td>\n      <td>0.743466</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Patient suffered a minor burn in the kitchen. Prescribed topical ointment and advised on wound care.</td>\n      <td>0.745391</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Patient presented with severe knee pain. Suspected ligament tear. Recommended MRI scan.</td>\n      <td>0.746433</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n      <td>0.748090</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>Patient presented with dislocated shoulder. After successful relocation, advised sling use and gentle mobility exercises for rehabilitation.</td>\n      <td>0.748190</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThese definitely seem like new/acute conditions!\n\nIf you're interested in looking at all of the distances, see the following output (remember that the smaller the distance, the closer the note to the chronic condition target):\n\n::: {#6e83479f .cell execution_count=22}\n``` {.python .cell-code}\nnotes_df.sort_values('cosine_dist')[['notes', 'cosine_dist']]\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>cosine_dist</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>43</th>\n      <td>Patient with chronic bronchitis showed increasingly frequent flare-ups. Reinforced importance of smoking cessation and upgraded prescribed inhalers.</td>\n      <td>0.483188</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Patient visited for follow-up on hypertension medication. Blood pressure readings stable. Emphasized continued adherence to treatment.</td>\n      <td>0.547638</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Patient reported persistent cough and difficulty breathing. Referred for radiological imaging to rule out pneumonia or tuberculosis.</td>\n      <td>0.550634</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Patient with a history of heart disease complained of palpitations. Recommended further cardiology work-up and emphasized continued adherence to treatment.</td>\n      <td>0.558663</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Chronic back pain patient showed improvement after physiotherapy. Recommended continuing sessions and daily exercises at home.</td>\n      <td>0.565519</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Asthmatic patient presented with increased shortness of breath. Stepped-up asthma control medication.</td>\n      <td>0.578419</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Patient admitted for chronic fatigue. Bloodwork ordered to rule out anemia, thyroid disorders, and diabetes. Recommended nutritional counseling.</td>\n      <td>0.580687</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n      <td>0.583531</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Patient came in for annual physical. All markers within normal limits. Encouraged to continue healthy lifestyle for prevention of non-communicable diseases.</td>\n      <td>0.592007</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Patient managing COPD came in for routine check-up. Oxygen levels stable. Expressed importance of avoiding respiratory irritants.</td>\n      <td>0.597322</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>Patient presented with swollen (oedemic) ankles. Adjusted diuretic medication dosage and recommended follow-up visit next week.</td>\n      <td>0.598728</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>Elderly patient presented with signs of Parkinson's disease. Referred to a neurologist for specialized care and management.</td>\n      <td>0.601647</td>\n    </tr>\n    <tr>\n      <th>51</th>\n      <td>Patient complained of periodic blurry vision. Referred to ophthalmology for proper ocular examination and management.</td>\n      <td>0.607228</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Patient managed for rheumatoid arthritis reported increased inflammation in joints. Adjusted medication and recommended physiotherapy for managing symptoms.</td>\n      <td>0.610967</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Patient presented with severe migraine episodes. Prescribed stronger painkillers and referred to a neurologist for a complete neurological work-up.</td>\n      <td>0.613839</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>Patient presented with painful and swollen joints. Diagnosed as gout and recommended dietary adjustment along with pain management.</td>\n      <td>0.618245</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Elderly patient with a history of diabetes complained of numbness in feet. Diagnosed peripheral neuropathy, referred to podiatrist for further management.</td>\n      <td>0.619704</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Elderly patient exhibited signs of Alzheimer's. Informed family and referred to neurology specialist for comprehensive management.</td>\n      <td>0.619889</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Patient presented with chest pain. Preliminary assessment ruled out heart conditions. Recommended gastroenterology consult to check for possible reflux disease.</td>\n      <td>0.625152</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>Patient with anxiety showed improvement with recent medication schedule. Encouraged continued therapy and stress management techniques.</td>\n      <td>0.626963</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Patient reports persistent vertigo. Referred to an Ear, Nose, and Throat (ENT)  specialist for detailed evaluation to rule out Meniere's disease.</td>\n      <td>0.628280</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>Patient reported sleep apnea symptoms. Advised to undergo a sleep study, prescribed initial treatment using CPAP device at night during sleep.</td>\n      <td>0.636255</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>Child patient presented with symptoms of ADHD. Referred to pediatric psychiatrist for cognitive and behavioral evaluation plus treatment.</td>\n      <td>0.636682</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>Patient with history of stroke presented with dizziness. Follow-up brain scan scheduled to rule out recurrence.</td>\n      <td>0.637395</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>Patient came in for weight management consultation. Diet plan adjusted and encouraged increased physical activity.</td>\n      <td>0.639904</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n      <td>0.644881</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Historically anxious patient reported increased panic attacks recently. Referred to psychiatrist for therapeutic support, prescribed low-dose anxiolytic.</td>\n      <td>0.645849</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>Patient reported feeling low, indicating depression. Counseled and referred to mental health services for further treatment and support.</td>\n      <td>0.647704</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Elderly patient with poor vision due to cataracts. Scheduled for ophthalmology consultation.</td>\n      <td>0.648220</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>Patient with history of irritable bowel syndrome showed signs of relief with diet modification. Reinforced importance of hydration and fiber intake.</td>\n      <td>0.657894</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>Teenage patient came in with signs of acne. Prescribed topical retinoid and advised consistent skin care routine.</td>\n      <td>0.658439</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Patient returned for post-operative wound check. Incision healing well with no signs of infection. Advised continued wound care protocol and scheduled follow-up in a week.</td>\n      <td>0.660693</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Arthritic patient reports increased joint pain. Advised gentle physical therapy and adjustment of pain medication.</td>\n      <td>0.661807</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Patient presented with signs of depression. Recommended seeking a psychologist for cognitive behavioral therapy and prescribed low dose antidepressant.</td>\n      <td>0.666589</td>\n    </tr>\n    <tr>\n      <th>52</th>\n      <td>Elderly patient with hearing difficulty. Scheduled an appointment for audiology consultation and potential hearing aids.</td>\n      <td>0.667571</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Routine consultation with patient managing type II diabetes. Blood glucose levels fairly controlled. Advised to keep monitoring sugar levels and follow diet regimen.</td>\n      <td>0.669839</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Patient has concerning mole on the back. Scheduled for dermatology consult to rule out potential skin cancer.</td>\n      <td>0.675400</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>Patient suffering from high fevers and weight loss. Ordered comprehensive bloodwork to assess for possible infectious disease.</td>\n      <td>0.676904</td>\n    </tr>\n    <tr>\n      <th>53</th>\n      <td>Patient presented with signs of Bell's Palsy. Referred to neurologist and prescribed corticosteroid medication to reduce inflammation.</td>\n      <td>0.682327</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n      <td>0.688291</td>\n    </tr>\n    <tr>\n      <th>50</th>\n      <td>Pregnant patient at full term demonstrated normal signs. Advised to prepare for labor and familiarize with signs of onset.</td>\n      <td>0.696364</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n      <td>0.697187</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>Pregnant patient showed normal progression in second trimester. Advised rest, proper nutrition and regular exercise.</td>\n      <td>0.702353</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>Type 1 diabetic patient showed increased blood sugar levels. Insulin doses were adjusted, advised dietary check.</td>\n      <td>0.707895</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>Patient showed symptoms of urinary tract infection. Collected sample for testing and started preliminary antibiotic treatment.</td>\n      <td>0.710449</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Patient presented with symptoms of influenza including fever, cough, and body aches. Prescribed antiviral medication and recommended rest and plenty of fluids.</td>\n      <td>0.715153</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Post-surgical patient reported redness and discomfort around stitches. Diagnosed with a mild post-operative infection. Prescribed antibiotics and wound care guidance.</td>\n      <td>0.726964</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Rash observed on patient's arm. Allergenic contact dermatitis suspected. Prescribed topical steroid and recommended patch test.</td>\n      <td>0.730986</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>Postnatal patient showed healthy recovery from C-section. Wound healing well without signs of infection.</td>\n      <td>0.742733</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>Child patient presented with red, itchy eyes. Diagnosed as viral conjunctivitis. Instructed parents about proper eye care and hand hygiene.</td>\n      <td>0.743466</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Patient suffered a minor burn in the kitchen. Prescribed topical ointment and advised on wound care.</td>\n      <td>0.745391</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Patient presented with severe knee pain. Suspected ligament tear. Recommended MRI scan.</td>\n      <td>0.746433</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n      <td>0.748090</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>Patient presented with dislocated shoulder. After successful relocation, advised sling use and gentle mobility exercises for rehabilitation.</td>\n      <td>0.748190</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nIt definitely seems like it did a pretty good job here (although to be fair, OpenAI did all the hard lifting!)\n\n## Zero-shot Binary classification\n\nThe above approach provides each doctor's note with a score (cosine distance) relative to a target (*\"Patient presenting with ongoing chronic condition defined as ongoing for more than one month\"*). But if I wanted to use this to create a binary label, I would need to come up with a threshold so that everyone whose cosine distance to the target is below, say 0.6, is classified as \"presenting with a chronic condition\", in which case, everyone whose cosine distance to the target is above 0.6 is classified as \"presenting with an acute condition\". \n\nThat approach sounds okay, but it turns out that there's a (hypothetically) better way. \n\nInstead of just computing the distance to a single target, I can compute two distances for each doctor's note: \n\n1. the distance to a positive label (corresponding to the original target: *\"Patient presenting with ongoing chronic condition defined as ongoing for more than one month\"*)\n\n2. the distance to a negative label (*\"Patient presenting with acute or new condition\"*)\n\nThen, each note is classified based on which label text its embedding is closest to.\n\nThe code for doing this is very similar to the code above. \n\nFortunately, I don't need to recompute the embeddings for the notes, but I do need to compute the embedding for the new negative label. \n\n::: {#2e7d35b3 .cell execution_count=23}\n``` {.python .cell-code}\nlabels = [\n  'Patient presenting with ongoing chronic condition defined as ongoing for more than one month',\n  'Patient presenting with acute or new condition'\n]\n# Compute embedding of the labels\nlabel_embeddings = [get_embedding(label) for label in labels]\n```\n:::\n\n\nThen I need to compute the difference between the cosine distance to the first label and the cosine distance to the second label (to determine which label the note is closest to).\n\n::: {#07a57747 .cell execution_count=24}\n``` {.python .cell-code}\n# compute the difference in the cosine distances to the two labels for each note\nnotes_df['cosine_score_binary'] = [cosine(x, label_embeddings[1]) - cosine(x, label_embeddings[0]) for x in notes_df['embedding']]\n```\n:::\n\n\nI have saved this `cosine_score_binary` in a new column in the DataFrame:\n\n::: {#c320562d .cell execution_count=25}\n``` {.python .cell-code}\nnotes_df[['notes', 'cosine_score_binary']].head()\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>cosine_score_binary</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n      <td>-0.097242</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n      <td>0.061629</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n      <td>-0.074738</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n      <td>-0.009268</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n      <td>-0.013830</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nA positive `cosine_score_binary` value means that the note is closer to the first label, *\"Patient presenting with ongoing chronic condition defined as ongoing for more than one month\"* (i.e., the distance to the second label is greater than the distance to the first label), and a negative value means that the note is closer to the second label, *\"Patient presenting with acute or new condition\"*.\n\nI can use this to create a binary classification for each note.\n\n::: {#ec23a536 .cell execution_count=26}\n``` {.python .cell-code}\nnotes_df['chronic_assessment'] = ['chronic' if score > 0 else 'acute' for score in notes_df['cosine_score_binary']]\n```\n:::\n\n\nThen I can view the results in descending order of the `cosine_score_binary` so that the first notes are those that are deemed most *chronic* and least *acute*:\n\n::: {#4a2a2395 .cell execution_count=27}\n``` {.python .cell-code}\nnotes_df[['notes', 'cosine_score_binary', 'chronic_assessment']].sort_values('cosine_score_binary', ascending=False)\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>notes</th>\n      <th>cosine_score_binary</th>\n      <th>chronic_assessment</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>31</th>\n      <td>Chronic back pain patient showed improvement after physiotherapy. Recommended continuing sessions and daily exercises at home.</td>\n      <td>0.110414</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>Patient with chronic bronchitis showed increasingly frequent flare-ups. Reinforced importance of smoking cessation and upgraded prescribed inhalers.</td>\n      <td>0.091766</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>Patient visited for follow-up on hypertension medication. Blood pressure readings stable. Emphasized continued adherence to treatment.</td>\n      <td>0.081715</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Patient reports difficulty sleeping. Exhibiting signs of insomnia characterized by frequent night time awakenings. Recommended a sleep study to find underlying cause.</td>\n      <td>0.061629</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>Routine consultation with patient managing type II diabetes. Blood glucose levels fairly controlled. Advised to keep monitoring sugar levels and follow diet regimen.</td>\n      <td>0.055009</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Patient admitted for chronic fatigue. Bloodwork ordered to rule out anemia, thyroid disorders, and diabetes. Recommended nutritional counseling.</td>\n      <td>0.053559</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>51</th>\n      <td>Patient complained of periodic blurry vision. Referred to ophthalmology for proper ocular examination and management.</td>\n      <td>0.049252</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Patient came in for annual physical. All markers within normal limits. Encouraged to continue healthy lifestyle for prevention of non-communicable diseases.</td>\n      <td>0.045713</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Elderly patient with a history of diabetes complained of numbness in feet. Diagnosed peripheral neuropathy, referred to podiatrist for further management.</td>\n      <td>0.037681</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Patient managing COPD came in for routine check-up. Oxygen levels stable. Expressed importance of avoiding respiratory irritants.</td>\n      <td>0.035781</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>Patient reported persistent cough and difficulty breathing. Referred for radiological imaging to rule out pneumonia or tuberculosis.</td>\n      <td>0.030508</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>Patient reports persistent vertigo. Referred to an Ear, Nose, and Throat (ENT)  specialist for detailed evaluation to rule out Meniere's disease.</td>\n      <td>0.028819</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Patient managed for rheumatoid arthritis reported increased inflammation in joints. Adjusted medication and recommended physiotherapy for managing symptoms.</td>\n      <td>0.026801</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>Elderly patient presented with signs of Parkinson's disease. Referred to a neurologist for specialized care and management.</td>\n      <td>0.019938</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Patient returned for post-operative wound check. Incision healing well with no signs of infection. Advised continued wound care protocol and scheduled follow-up in a week.</td>\n      <td>0.018720</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>Patient reported sleep apnea symptoms. Advised to undergo a sleep study, prescribed initial treatment using CPAP device at night during sleep.</td>\n      <td>0.014099</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Patient with a history of heart disease complained of palpitations. Recommended further cardiology work-up and emphasized continued adherence to treatment.</td>\n      <td>0.009364</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Elderly patient exhibited signs of Alzheimer's. Informed family and referred to neurology specialist for comprehensive management.</td>\n      <td>0.007949</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Asthmatic patient presented with increased shortness of breath. Stepped-up asthma control medication.</td>\n      <td>0.002814</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>Patient came in for weight management consultation. Diet plan adjusted and encouraged increased physical activity.</td>\n      <td>0.001463</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>Pregnant patient showed normal progression in second trimester. Advised rest, proper nutrition and regular exercise.</td>\n      <td>0.000649</td>\n      <td>chronic</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Elderly patient with poor vision due to cataracts. Scheduled for ophthalmology consultation.</td>\n      <td>-0.000179</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>Teenage patient came in with signs of acne. Prescribed topical retinoid and advised consistent skin care routine.</td>\n      <td>-0.000709</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>Patient presented with painful and swollen joints. Diagnosed as gout and recommended dietary adjustment along with pain management.</td>\n      <td>-0.004671</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Patient has concerning mole on the back. Scheduled for dermatology consult to rule out potential skin cancer.</td>\n      <td>-0.007328</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Hypertensive patient presented with higher blood pressure at 160/100. Adjusted medications and emphasized importance of diet and exercise.</td>\n      <td>-0.009268</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>Patient with history of irritable bowel syndrome showed signs of relief with diet modification. Reinforced importance of hydration and fiber intake.</td>\n      <td>-0.011980</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Examined patient for frequent headaches. No alarming neurological signs detected. Recommended reducing caffeine intake and keeping hydrated.</td>\n      <td>-0.013830</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>Patient presented with severe migraine episodes. Prescribed stronger painkillers and referred to a neurologist for a complete neurological work-up.</td>\n      <td>-0.015010</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>52</th>\n      <td>Elderly patient with hearing difficulty. Scheduled an appointment for audiology consultation and potential hearing aids.</td>\n      <td>-0.015633</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>Patient reported feeling low, indicating depression. Counseled and referred to mental health services for further treatment and support.</td>\n      <td>-0.018623</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>Patient presented with swollen (oedemic) ankles. Adjusted diuretic medication dosage and recommended follow-up visit next week.</td>\n      <td>-0.020730</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>Type 1 diabetic patient showed increased blood sugar levels. Insulin doses were adjusted, advised dietary check.</td>\n      <td>-0.020986</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Rash observed on patient's arm. Allergenic contact dermatitis suspected. Prescribed topical steroid and recommended patch test.</td>\n      <td>-0.030286</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>Postnatal patient showed healthy recovery from C-section. Wound healing well without signs of infection.</td>\n      <td>-0.032995</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Arthritic patient reports increased joint pain. Advised gentle physical therapy and adjustment of pain medication.</td>\n      <td>-0.033021</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>Child patient presented with symptoms of ADHD. Referred to pediatric psychiatrist for cognitive and behavioral evaluation plus treatment.</td>\n      <td>-0.038751</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>53</th>\n      <td>Patient presented with signs of Bell's Palsy. Referred to neurologist and prescribed corticosteroid medication to reduce inflammation.</td>\n      <td>-0.042732</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>Patient with anxiety showed improvement with recent medication schedule. Encouraged continued therapy and stress management techniques.</td>\n      <td>-0.048093</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>Patient with history of stroke presented with dizziness. Follow-up brain scan scheduled to rule out recurrence.</td>\n      <td>-0.053002</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Patient presented with signs of depression. Recommended seeking a psychologist for cognitive behavioral therapy and prescribed low dose antidepressant.</td>\n      <td>-0.057786</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>Patient suffering from high fevers and weight loss. Ordered comprehensive bloodwork to assess for possible infectious disease.</td>\n      <td>-0.059315</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Patient suffered a minor burn in the kitchen. Prescribed topical ointment and advised on wound care.</td>\n      <td>-0.062896</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>Post-surgical patient reported redness and discomfort around stitches. Diagnosed with a mild post-operative infection. Prescribed antibiotics and wound care guidance.</td>\n      <td>-0.068201</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Patient came in with complaints of stomachache. Upon examination, no obvious signs of appendicitis or gallstones were found. Recommended patient to undergo an ultrasound to assess internal organs.</td>\n      <td>-0.074738</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>Child patient presented with red, itchy eyes. Diagnosed as viral conjunctivitis. Instructed parents about proper eye care and hand hygiene.</td>\n      <td>-0.077558</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Patient presented with chest pain. Preliminary assessment ruled out heart conditions. Recommended gastroenterology consult to check for possible reflux disease.</td>\n      <td>-0.080826</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Patient presented with severe knee pain. Suspected ligament tear. Recommended MRI scan.</td>\n      <td>-0.081825</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>Historically anxious patient reported increased panic attacks recently. Referred to psychiatrist for therapeutic support, prescribed low-dose anxiolytic.</td>\n      <td>-0.083702</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>Patient presented with dislocated shoulder. After successful relocation, advised sling use and gentle mobility exercises for rehabilitation.</td>\n      <td>-0.091579</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>0</th>\n      <td>Patient presented signs of common cold; symptoms include a runny nose and mild fever. Advised rest, hydration, and over-the-counter medication to manage symptoms.</td>\n      <td>-0.097242</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>Patient presented with symptoms of influenza including fever, cough, and body aches. Prescribed antiviral medication and recommended rest and plenty of fluids.</td>\n      <td>-0.100791</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>Patient showed symptoms of urinary tract infection. Collected sample for testing and started preliminary antibiotic treatment.</td>\n      <td>-0.101196</td>\n      <td>acute</td>\n    </tr>\n    <tr>\n      <th>50</th>\n      <td>Pregnant patient at full term demonstrated normal signs. Advised to prepare for labor and familiarize with signs of onset.</td>\n      <td>-0.101702</td>\n      <td>acute</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWhile the results aren't perfect, they're certainly pretty impressive! Especially given how little code we had to write to achieve it!\n\nHopefully, this tutorial has given you some ideas to try in your own work. But keep in mind that this is a rapidly evolving field, and the specific pieces of code used here may or may not work in the future as things continue to shift. \n\n",
    "supporting": [
      "2024-04-11-labeling_doctors_notes_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}